<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="es" class="no-js">
  <head><script src="/servicios/livereload.js?mindelay=10&amp;v=2&amp;port=44201&amp;path=servicios/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="http://localhost:44201/servicios/es/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="http://localhost:44201/servicios/es/docs/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/servicios/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/servicios/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/servicios/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/servicios/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/servicios/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/servicios/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/servicios/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/servicios/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/servicios/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/servicios/favicons/android-192x192.png" sizes="192x192">

<title>Servicios en Despliegue de Aplicaciones Web | Despliegue de Aplicaciones Web</title>
<meta name="description" content="Exploramos servicios esenciales para el despliegue de aplicaciones web.
">

<meta property="og:title" content="Servicios en Despliegue de Aplicaciones Web" />
<meta property="og:description" content="Exploramos servicios esenciales para el despliegue de aplicaciones web.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://localhost:44201/servicios/es/docs/" />

<meta itemprop="name" content="Servicios en Despliegue de Aplicaciones Web">
<meta itemprop="description" content="Exploramos servicios esenciales para el despliegue de aplicaciones web.
"><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Servicios en Despliegue de Aplicaciones Web"/>
<meta name="twitter:description" content="Exploramos servicios esenciales para el despliegue de aplicaciones web.
"/>


<link href="/servicios/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll "  data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row ">
  <a class="navbar-brand" href="/servicios/es/"><span class="navbar-brand__logo navbar-logo">
    <img src="/servicios/images/logo.png" alt="Logo" width="150" height="auto" />
    </span><span class="navbar-brand__name">Despliegue de Aplicaciones Web</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Español</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/servicios/en/">English</a></li>
    <li><a class="dropdown-item" href="/servicios/fr/">Francés</a></li>
    </ul>
</div></li>
      <li class="td-light-dark-menu nav-item dropdown">
        <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="check2" viewBox="0 0 16 16">
    <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
  </symbol>
  <symbol id="circle-half" viewBox="0 0 16 16">
    <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
  </symbol>
  <symbol id="moon-stars-fill" viewBox="0 0 16 16">
    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
    <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
  </symbol>
  <symbol id="sun-fill" viewBox="0 0 16 16">
    <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
  </symbol>
</svg>

<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center"
        id="bd-theme"
        type="button"
        aria-expanded="false"
        data-bs-toggle="dropdown"
        data-bs-display="static"
        aria-label="Toggle theme (auto)">
  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg>
</button>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#sun-fill"></use></svg>
      Light
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"></use></svg>
      Dark
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
      <svg class="bi me-2 opacity-50"><use href="#circle-half"></use></svg>
      Auto
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
</ul>

      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
Versión imprimible multipagina.
<a href="#" onclick="print();return false;">Haga click aquí para imprimir</a>.
</p><p>
<a href="/servicios/es/docs/">Volver a la vista normal de esta página</a>.
</p>
</div>



<h1 class="title">Servicios en Despliegue de Aplicaciones Web</h1>
<div class="lead">Exploramos servicios esenciales para el despliegue de aplicaciones web.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-91a07a0823ecbf212a6dc8a3162503a2">Sistema base de entorno</a></li>


    
  
    
    
	
<li>2: <a href="#pg-32185a51f23b01d0db852f0c6ead44af">Servicios Web con Apache</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.1: <a href="#pg-1af48ff7b32f6aa5ae768fc9ed45ab29">VirtualHost</a></li>


    
  
    
    
	
<li>2.2: <a href="#pg-9dc78ee6e08d94a9f192f8bd5511ea84">Auth</a></li>


    
  
    
    
	
<li>2.3: <a href="#pg-3bb0c1cf4b5aed9fc2005a19ccb20d57">Https</a></li>


    
  
    
    
	
<li>2.4: <a href="#pg-a7c6ee1e33612d9ceaf6bbdec00c003c">Rewrite</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-3644dc1908878e203d2d4d6dc142c5eb">SSH Secure Shell</a></li>


    
  
    
    
	
<li>4: <a href="#pg-c03644e270700c618778d25f9cdeb686">Servidor DNS con BIND</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-a0beb9f7a15cf85318ae0b811f50cca3">Instalación</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4.2: <a href="#pg-58b7419fde94cadcdd42f0085c515df7">Configuración Avanzada de BIND</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4.3: <a href="#pg-e70f69453789dd4e29465068f3ecc3bd">Comandos para dns</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4.4: <a href="#pg-2f924b91564d17d9e0d461d693c6b856">Práctica</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>
    
  

    </ul>


<div class="content">
      <hr style="border-color: red; border-width: 3px;"/>
<p>




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Servicios esenciales en despliegue de aplicaciones web</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Servidores web</li>
            
            <li>Acceso remoto </li>
            
            <li>Transferencia de ficheros</li>
            
            <li>Resolución de dominios</li>
            
            <li>Instalación y uso</li>
            
            
            
        </ul>
    </div>
    


</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Es base para todo</h4>

    Seguiremos profundizando y utilizándolos a lo largo del curso usándolos en aws

</div>



<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Servicios a Estudiar


</span>
</strong>
</p>
<ul>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Apache


</span>
</strong>
 y 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Nginx


</span>
</strong>
: Servidores web.</li>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    SSH


</span>
</strong>
 y 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Telnet


</span>
</strong>
: Acceso remoto.</li>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    FTP


</span>
</strong>
: Transferencia de archivos.</li>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    DNS


</span>
</strong>
: Resolución de nombres de dominio.</li>
</ul>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Fundamental saber</h4>

    Qué son, cómo funcionan y por qué son importantes.

</div>

<hr style="border-color: red; border-width: 3px;"/>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-cogs" aria-hidden="true"></i>
    
    <strong>¿Qué es un servicio?</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>Un </li>
        
        
        <li>&lt;strong&gt;</li>
        
        <li>&lt;span class=&#34;font-weight-bold text-primary fs-1.5&#34;&gt;</li>
        
        
        <li>    servicio</li>
        
        
        
        <li>&lt;/span&gt;</li>
        
        <li>&lt;/strong&gt;</li>
        
        <li> en el contexto del despliegue web es </li>
        
        
        <li>&lt;strong&gt;</li>
        
        <li>&lt;span class=&#34;font-weight-bold text-primary fs-1.5&#34;&gt;</li>
        
        
        <li>    un programa o conjunto de programas</li>
        
        
        
        <li>&lt;/span&gt;</li>
        
        <li>&lt;/strong&gt;</li>
        
        <li> diseñados para proporcionar funcionalidades específicas a través de una red, facilitando la comunicación y operación de aplicaciones.     </li>
        
        
        
        
      </ul>
  </div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h3 id="servicios-principales">Servicios principales</h3>
<p>Para poder utilizar un servicio, lógicamente necesitamos un programa que lo implemente, que podamos instalar y administrar para poderlo utilizar según nuestras necesidades.</p>
<p>Los servicios que usamos implementan protocolos de la familia TCP/IP.</p>
<p>Vamos a estudiar:</p>
<table>
<thead>
<tr>
<th><strong>Protocolo</strong></th>
<th><strong>Puerto</strong></th>
<th><strong>Programa o implementación</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTP/HTTPS</td>
<td>80/443</td>
<td>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Apache HTTP Server


</span>
</strong>
</td>
<td></td>
</tr>
<tr>
<td>HTTP/HTTPS</td>
<td>80/443</td>
<td>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Nginx


</span>
</strong>
</td>
<td></td>
</tr>
<tr>
<td>DNS</td>
<td>53</td>
<td>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Bind


</span>
</strong>
</td>
<td></td>
</tr>
<tr>
<td>SSH</td>
<td>22</td>
<td>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    OpenSSH


</span>
</strong>
</td>
<td></td>
</tr>
<tr>
<td>FTP</td>
<td>20/21</td>
<td>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    vsftpd, ProFTPD, Pure-FTPd


</span>
</strong>
</td>
<td></td>
</tr>
<tr>
<td>SFTP</td>
<td>22</td>
<td>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    OpenSSH


</span>
</strong>
</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="hahahugoshortcode4s20hbhb-y-hahahugoshortcode4s21hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Apache


</span>
</strong>
 y 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Nginx


</span>
</strong>
</h4>


<div class="alert alert-blue" role="alert">
<h4 class="alert-heading">Servidores Web</h4>

    Apache y Nginx son los servicios más comunes para alojar aplicaciones web. Ambos actúan como intermediarios entre el usuario y la aplicación, gestionando peticiones HTTP/HTTPS.

</div>

<h4 id="hahahugoshortcode4s23hbhb-y-hahahugoshortcode4s24hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    SSH


</span>
</strong>
 y 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Telnet


</span>
</strong>
</h4>


<div class="alert alert-green" role="alert">
<h4 class="alert-heading">Acceso remoto</h4>

    SSH permite conexiones seguras a través de una red para administración remota. Telnet, aunque menos seguro, puede ser útil para pruebas específicas.

</div>

<h4 id="hahahugoshortcode4s26hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    FTP


</span>
</strong>
</h4>


<div class="alert alert-orange" role="alert">
<h4 class="alert-heading">Transferencia de Archivos</h4>

    FTP es un protocolo para transferir archivos entre clientes y servidores. Aunque ha sido en parte reemplazado por SFTP y SCP, sigue siendo relevante en entornos específicos.

</div>

<h4 id="hahahugoshortcode4s28hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    DNS


</span>
</strong>
</h4>


<div class="alert alert-purple" role="alert">
<h4 class="alert-heading">Resolución de nombres</h4>

    El servicio DNS traduce nombres de dominio legibles para humanos (como ejemplo.com) en direcciones IP que las computadoras entienden.

</div>

<hr style="border-color: red; border-width: 3px;"/>
<h3 id="finalidad">Finalidad</h3>




<div style="border: 1px solid royalblue; border-radius: 5px; overflow: hidden;">
  <div style="background-color: royalblue; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
    
    <span style="margin-right: 8px;">
            
                <i class="fas fa-flag-checkered"></i> 
            
        </span>
    
    <span>Finalidad</span>
  </div>

  <h3 style="padding: 5px; font-weight: bold; color: royalblue;">Al terminar el tema deberás...</h3>

  <hr style="border-color: lightsteelblue; border-width: 3px"/>
  
  <div style="background-color: #f0f8ff; color: royalblue; padding: 10px;">
    <ul>
      
      
      <li><ul>
<li>Comprender qué es un servicio y su función en el despliegue de aplicaciones web.</li>
</ul>
</li>
      
      <li><ul>
<li>Instalar, configurar y administrar servicios como Apache, Nginx, SSH, FTP y DNS.</li>
</ul>
</li>
      
      <li><ul>
<li>Identificar las diferencias y casos de uso de cada servicio.</li>
</ul>
</li>
      
      
      
      
    </ul>
  </div>
</div>

<hr style="border-color: red; border-width: 3px;"/>
<h3 id="referencias">Referencias</h3>




<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <img src="documentacion.png" alt="Icono de Referencias" style="width: 24px; height: 24px;">
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de información confiables</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            
            <li><ul>
<li><a href="https://httpd.apache.org/docs/">Documentación oficial de Apache</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://nginx.org/en/docs/">Guía oficial de Nginx</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://www.ssh.com/ssh/">Introducción a SSH</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc959">Protocolo FTP</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://www.cloudflare.com/learning/dns/what-is-dns/">DNS explicado</a></li>
</ul>
</li>
            
            
            
            
        </ul>
    </div>
</div>


</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-91a07a0823ecbf212a6dc8a3162503a2">1 - Sistema base de entorno</h1>
    <div class="lead">Vamos a trabajar bajo  <strong>ubuntu server</strong> que virtualizaremos en <strong>virtual box</strong> usando <strong>vagrant</strong>.</div>
	<p>




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Configuración de Apache</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Usar Vagrant  </li>
            
            <li>Revisar fichero de configuración  </li>
            
            <li>Instalar Ubuntu Server  </li>
            
            <li>Conectar o levantar la máquina de Ubuntu para trabajar  </li>
            
            
            
        </ul>
    </div>
    


</div>





<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><a href="https://web.infenlaces.com/despliegue/contenido/docs/02_linux/">https://web.infenlaces.com/despliegue/contenido/docs/02_linux/</a></li>
            
            
            
            
        </ul>
    </div>
</div>
</p>
<hr style="border-color: red; border-width: 3px;"/>
<h3 id="comandos-básicos-de-vagrant"><strong>Comandos básicos de Vagrant</strong></h3>
<p>Para gestionar las máquinas virtuales con Vagrant utilizaremos los siguientes comandos:</p>
<ol>
<li>
<p><strong>Iniciar la máquina virtual</strong><br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant up</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Conectarse a la máquina virtual</strong><br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant ssh</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Detener la máquina virtual</strong><br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant halt</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Reiniciar la máquina virtual</strong><br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant reload</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Destruir la máquina virtual</strong> (elimina todos los datos asociados):<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant destroy</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
</ol>
<hr style="border-color: red; border-width: 3px;"/>
<h3 id="configuración-del-archivo-vagrantfile"><strong>Configuración del archivo Vagrantfile</strong></h3>
<p>El siguiente ejemplo de configuración en el archivo <code>Vagrantfile</code> instala <strong>Ubuntu Server 24</strong>, mapea puertos para servicios específicos y comparte una carpeta local con la máquina virtual:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#66d9ef">Vagrant</span><span style="color:#f92672">.</span>configure(<span style="color:#e6db74">&#34;2&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>config<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Configuración de la caja base</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>box <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ubuntu/jammy64&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Asignar nombre a la máquina virtual</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>hostname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vagrant-ubuntu24&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Configurar red y mapeo de puertos</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>network <span style="color:#e6db74">&#34;forwarded_port&#34;</span>, <span style="color:#e6db74">guest</span>: <span style="color:#ae81ff">80</span>, <span style="color:#e6db74">host</span>: <span style="color:#ae81ff">8080</span>  <span style="color:#75715e"># Apache/Nginx</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>network <span style="color:#e6db74">&#34;forwarded_port&#34;</span>, <span style="color:#e6db74">guest</span>: <span style="color:#ae81ff">22</span>, <span style="color:#e6db74">host</span>: <span style="color:#ae81ff">2222</span>  <span style="color:#75715e"># SSH</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>network <span style="color:#e6db74">&#34;forwarded_port&#34;</span>, <span style="color:#e6db74">guest</span>: <span style="color:#ae81ff">21</span>, <span style="color:#e6db74">host</span>: <span style="color:#ae81ff">2121</span>  <span style="color:#75715e"># FTP</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>network <span style="color:#e6db74">&#34;forwarded_port&#34;</span>, <span style="color:#e6db74">guest</span>: <span style="color:#ae81ff">53</span>, <span style="color:#e6db74">host</span>: <span style="color:#ae81ff">5353</span>  <span style="color:#75715e"># DNS</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Compartir una carpeta entre anfitrión y máquina virtual</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>synced_folder <span style="color:#e6db74">&#34;./app&#34;</span>, <span style="color:#e6db74">&#34;/var/www/html&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Configuración del proveedor VirtualBox</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>provider <span style="color:#e6db74">&#34;virtualbox&#34;</span> <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>vb<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>vb<span style="color:#f92672">.</span>memory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1024&#34;</span>
</span></span><span style="display:flex;"><span>vb<span style="color:#f92672">.</span>cpus <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h3 id="notas-importantes"><strong>Notas importantes</strong></h3>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Configuración adicional</h4>

    Para que los servicios como Apache o FTP funcionen correctamente en los puertos configurados, asegúrate de instalar y configurar los paquetes necesarios dentro de la máquina virtual.

</div>

<h3 id="conexiones-a-la-red">Conexiones a la red</h3>
<p>Es importante recordad los tipos de conexiónes que establecemos en el fichero Vagrantfile
<img alt="net_vagrant.webp" src="/servicios/es/docs/00_entorno/net_vagrant.webp"></p>
<table>
<thead>
<tr>
<th><strong>Conexiones</strong></th>
<th><strong>Red Host-VirtualHost</strong></th>
<th><strong>Red Local</strong></th>
<th><strong>Internet</strong></th>
<th><strong>Red entre Host y todas las Virtual Host</strong></th>
<th><strong>Parámetro de conexión</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Private Network</strong></td>
<td>Sí</td>
<td>No</td>
<td>No (salvo con NAT)</td>
<td>Sí</td>
<td><code>private_network</code></td>
</tr>
<tr>
<td><strong>Host-Only Network</strong></td>
<td>Sí</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>Automática (Host-Only)</td>
</tr>
<tr>
<td><strong>Bridged Network</strong></td>
<td>Sí</td>
<td>Sí</td>
<td>Sí</td>
<td>No</td>
<td><code>public_network</code></td>
</tr>
<tr>
<td><strong>NAT</strong></td>
<td>No</td>
<td>No</td>
<td>Sí</td>
<td>No</td>
<td>NAT por defecto</td>
</tr>
</tbody>
</table>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Explicación


</span>
</strong>

<ul>
<li><strong>Red Host-VirtualHost</strong>: Conexión directa entre el anfitrión y la máquina virtual.</li>
<li><strong>Red Local</strong>: Acceso desde y hacia otros dispositivos en la red local del anfitrión.</li>
<li><strong>Internet</strong>: Acceso a Internet desde la máquina virtual.</li>
<li><strong>Red</strong> entre Host y todas las Virtual Host: Conexión entre el anfitrión y todas las máquinas virtuales configuradas.</li>
<li><strong>Parámetro de conexión</strong>: Configuración utilizada en el archivo Vagrantfile.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-32185a51f23b01d0db852f0c6ead44af">2 - Servicios Web con Apache</h1>
    <div class="lead">Aprendemos a instalar, configurar y personalizar Apache para implementar servicios web efectivos.</div>
	




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Configuración de Apache</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Instalar, configurar y personalizar Apache.</li>
            
            <li>Hosts Virtuales.</li>
            
            <li>Opciones de Directorio.</li>
            
            <li>Alias.</li>
            
            <li>Autenticación en el servidor.</li>
            
            <li>Páginas dinámicas.</li>
            
            <li>SSL.</li>
            
            <li>Rewrite.</li>
            
            
            
        </ul>
    </div>
    


</div>

<h3 id="1--introducción">1.- Introducción</h3>
<p><strong>Apache HTTP Server</strong>, comúnmente conocido como Apache, es uno de los servidores web más utilizados en el mundo.</p>
<p>Como características, podrímos destacar su flexibilidad, estabilidad y gran cantidad de módulos lo convierten en una opción ideal para gestionar servicios web en entornos variados.</p>
<p>Vemos en la siguiente imagen cómo apache es escalable a través de módulos que podremos ir integrando según vayamos necesitando
<img alt="apache.png" src="/servicios/es/docs/01_apache/apache.png"></p>
<hr style="border-color: red; border-width: 3px;"/>
<p>En este tema, exploraremos cómo instalar Apache, configurarlo y aprovechar sus funcionalidades clave para implementar servicios web efectivos. También aprenderemos a utilizarlo en un entorno virtualizado con Vagrant, facilitando la práctica en un entorno controlado y replicable.</p>
<h3 id="2--instalación">2.- Instalación</h3>
<p>Para instalar Apache en sistemas basados en Debian/Ubuntu.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>sudo apt update<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>sudo apt install apache2</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Después de la instalación, podemos verificar el estado del servicio:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span>sudo systemctl status apache2</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="3--archivos-de-configuración">3.- <strong>Archivos de configuración</strong></h3>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Apache2


</span>
</strong>
 en su configuración presenta un sistema descentralizado donde vemos como  organiza su configuración en varios archivos:</p>
<ul>
<li><strong>/etc/apache2/apache2.conf</strong>: Archivo principal de configuración.</li>
<li><strong>/etc/apache2/ports.conf</strong>: Define los puertos en los que Apache escucha.</li>
<li><strong>/etc/apache2/sites-available/</strong>: Directorios para configuraciones específicas de sitios.</li>
<li><strong>/etc/apache2/sites-enabled/</strong>: Enlaces simbólicos a los sitios habilitados.</li>
</ul>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Editando ficheros</h4>

    <ul>
<li>Para poder acceder a los ficheros desde un editor, podemos compartir una carpeta y crear un enlace simbólico</li>
<li>También podríamos conectar por ssh desde nuestro edi.</li>
</ul>


</div>

<h3 id="4--principales-herramientas">4.- <strong>Principales herramientas</strong></h3>
<ol>
<li><strong>apache2</strong><br>
Binario principal para ejecutar el servidor Apache.</li>
<li><strong>apachectl</strong><br>
Interfaz para administrar Apache, recomendada para tareas como iniciar, detener y reiniciar el servidor.</li>
</ol>
<blockquote>
<blockquote>
<p>Por lo que se comenta posteriormente, usaremos <strong>apachectl</strong> en lugar de <strong>apache2</strong>, ya que ambas herramientas permiten interactuar con Apache, pero <strong>apachectl</strong> simplifica la administración al abstraer configuraciones y proporcionar comandos específicos como <code>configtest</code> o <code>graceful</code>, logrando los mismos objetivos de forma más práctica.
<strong>apachectl</strong> simplifica la administración al abstraer configuraciones y proporcionar comandos específicos como <code>configtest</code> o <code>graceful</code>, logrando los mismos objetivos de forma más práctica.</p>
</blockquote>
</blockquote>
<ol start="3">
<li>
<p><strong>systemctl</strong><br>
Herramienta para gestionar servicios en sistemas basados en <code>systemd</code>.</p>
</li>
<li>
<p><strong>journalctl</strong><br>
Permite ver logs de Apache gestionados por <code>systemd</code>.</p>
</li>
<li>
<p><strong>service apache2</strong><br>
Comando heredado para manejar servicios, útil en sistemas sin <code>systemd</code>.</p>
</li>
</ol>
<hr>
<h3 id="5--comandos-específicos-de-apache">5.- <strong>Comandos específicos de Apache</strong></h3>
<ol>
<li>
<p><strong>a2enmod</strong><br>
Activa módulos de Apache.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2enmod nombre_modulo</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>a2dismod</strong><br>
Desactiva módulos de Apache.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2dismod nombre_modulo</span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>a2ensite</strong><br>
Habilita configuraciones de Virtual Hosts.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2ensite nombre_sitio</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>a2dissite</strong><br>
Deshabilita configuraciones de Virtual Hosts.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2dissite nombre_sitio</span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>a2enconf</strong><br>
Habilita configuraciones adicionales en Apache.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2enconf nombre_configuracion</span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>a2disconf</strong><br>
Deshabilita configuraciones adicionales.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2disconf nombre_configuracion</span></span></code></pre></td></tr></table>
</div>
</div>
</li>
</ol>
<h3 id="6--herramientas-relacionadas-con-seguridad-y-autenticación">6.- <strong>Herramientas relacionadas con seguridad y autenticación</strong></h3>
<ol>
<li>
<p><strong>htpasswd</strong><br>
Gestiona archivos de usuarios y contraseñas para autenticación básica.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>htpasswd -c /ruta/al/archivo usuario</span></span></code></pre></td></tr></table>
</div>
</div>
</li>
<li>
<p><strong>openssl</strong><br>
Genera certificados SSL para configuraciones HTTPS.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>openssl req -new -x509 -days <span style="color:#ae81ff">365</span> -keyout archivo.key -out archivo.crt</span></span></code></pre></td></tr></table>
</div>
</div>
</li>
</ol>
<hr>
<h3 id="7--herramientas-adicionales">7.- <strong>Herramientas adicionales</strong></h3>
<ol>
<li>
<p><strong>logrotate</strong><br>
Gestiona la rotación de logs de Apache para evitar el crecimiento excesivo de archivos.</p>
</li>
<li>
<p><strong>mod_security</strong><br>
Herramienta para implementar reglas de seguridad web (integrada como módulo en Apache).</p>
</li>
<li>
<p><strong>ab (Apache Benchmark)</strong><br>
Realiza pruebas de carga en servidores web.</p>
</li>
</ol>
<blockquote>
<blockquote>
<p>Enviamos 100 solicitudas <strong>(-n 100)</strong> con 10 <strong>(-c 10)</strong> conexiones a un url <strong>(http://localhost/)</strong> y vemos estadísticas que genera.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ab -n <span style="color:#ae81ff">100</span> -c <span style="color:#ae81ff">10</span> http://localhost/</span></span></code></pre></td></tr></table>
</div>
</div></p>
</blockquote>
</blockquote>
<ol start="4">
<li><strong>htcacheclean</strong><br>
Limpia la caché de Apache.</li>
</ol>
<blockquote>
<blockquote>
<p>Establecemos una limplieza de cache cada 30 segundos de ficheros antiguos o innecesarios en el directorio /var/cache/apache2/proxy que es el que utiliza apache por defecto (Configurable en la directiva CacheRoot). Lo hace en modo bloqueante (por defecto), lo que implica que está activo mientras esté el proceso corriendo.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>htcacheclean -d <span style="color:#ae81ff">30</span> -p /var/cache/apache2/proxy</span></span></code></pre></td></tr></table>
</div>
</div>
ejemplo de configuración para la cache
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span>   <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">IfModule</span> <span style="color:#a6e22e">mod_cache_disk</span><span style="color:#f92672">.</span><span style="color:#a6e22e">c</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">CacheRoot</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">cache</span><span style="color:#f92672">/</span><span style="color:#a6e22e">apache2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">proxy</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">CacheEnable</span> <span style="color:#a6e22e">disk</span> <span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">CacheDirLevels</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">CacheDirLength</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">IfModule</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;</span> 
</span></span></code></pre></td></tr></table>
</div>
</div></p>
</blockquote>
</blockquote>
<h4 id="1-apache2-binario-directo"><strong>1. apache2 (binario directo)</strong></h4>
<p>El binario <strong>apache2</strong> permite interactuar directamente con el servidor Apache. Este método es menos común ya que requiere configuraciones específicas.


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">apache2 VS apachectl systemctl</h4>

    <p>Usar apache2 directamente,implica que  variables, directorios y configuraciones estén correctamente definidas, y esto no siempre es así
Concretamente:</p>
<ul>
<li><strong>APACHE_RUN_USER</strong> y <strong>APACHE_RUN_GROUP</strong>: Determinan el usuario y grupo bajo los cuales Apache se ejecuta.</li>
<li><strong>APACHE_RUN_DIR</strong>: Define el directorio de ejecución donde Apache almacena su PID (por ejemplo, /var/run/apache2).</li>
<li><strong>APACHE_LOG_DIR</strong>: Especifica el directorio donde se guardan los logs.</li>
<li><strong>APACHE_PID_FILE</strong>: Indica la ubicación del archivo que contiene el ID de proceso (PID) de Apache.</li>
</ul>

</div>
</p>
<p><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  export APACHE_RUN_USER<span style="color:#f92672">=</span>www-data
</span></span><span style="display:flex;"><span>  export APACHE_RUN_GROUP<span style="color:#f92672">=</span>www-data
</span></span><span style="display:flex;"><span>  export APACHE_RUN_DIR<span style="color:#f92672">=</span>/var/run/apache2
</span></span><span style="display:flex;"><span>  export APACHE_LOG_DIR<span style="color:#f92672">=</span>/var/log/apache2
</span></span><span style="display:flex;"><span>  export APACHE_PID_FILE<span style="color:#f92672">=</span>/var/run/apache2/apache2.pid
</span></span><span style="display:flex;"><span>  </span></span></code></pre></td></tr></table>
</div>
</div>
Sin embargo, para simplificar la administración, se recomienda utilizar herramientas como:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#3c3d38"><span>apachectl.
</span></span><span style="display:flex; background-color:#3c3d38"><span>systemctl.</span></span></code></pre></td></tr></table>
</div>
</div></p>
<blockquote>
<p>Estas abstraen estas configuraciones y hacen que la experiencia sea más segura y sencilla, <strong>consiguiendo los mismos propósitos</strong>.</p>
</blockquote>
<p><strong>Uso común:</strong></p>
<ul>
<li><strong>Mostrar ayuda:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apache2 --help</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>Ver versión:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apache2 -v</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>Ver detalles de la configuración:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apache2 -V</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>Verificar sintaxis de configuración:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apache2 -t</span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h4 id="2-apachectl-interfaz-recomendada-para-administrar-apache"><strong>2. apachectl (interfaz recomendada para administrar Apache)</strong></h4>
<p><strong>apachectl</strong> es una interfaz de control que facilita la gestión de Apache.Como ya se ha comentado, su uso es más seguro y práctico que usar directamente el binario.</p>
<p><strong>Comandos principales:</strong></p>
<ul>
<li><strong>Ayuda general:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apachectl -h</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>Iniciar, detener, reiniciar, reiniciar sin interrumpir conexiones activas, ver estado  Apache:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apachectl start|stop|resetart|graceful|status</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>Verificar configuración:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apachectl configtest</span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h4 id="3-systemctl-administración-del-servicio-en-sistemas-modernos"><strong>3. systemctl (administración del servicio en sistemas modernos)</strong></h4>
<p><code>systemctl</code> es el comando estándar en sistemas que utilizan <code>systemd</code>. Es la forma recomendada para gestionar servicios como Apache.</p>
<p><strong>Comandos principales:</strong></p>
<ul>
<li><strong>Iniciar, parar, reiniciar o ver estado del servicio  Apache:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl start|stop|restart|status apache2</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>Habilitar Apache para que se inicie al arrancar el sistema:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl enable apache2</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>Deshabilitar Apache del inicio automático:</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl disable apache2</span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h4 id="4-otros-métodos-relevantes"><strong>4. Otros métodos relevantes</strong></h4>
<ul>
<li><strong><code>service</code> (alternativa más antigua a <code>systemctl</code>):</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo service apache2 start
</span></span><span style="display:flex;"><span>sudo service apache2 stop
</span></span><span style="display:flex;"><span>sudo service apache2 restart</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong><code>journalctl</code> (para logs de Apache gestionados por <code>systemd</code>):</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo journalctl -u apache2</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="comparación-entre-apachectl-y-systemctl"><strong>Comparación entre apachectl y systemctl</strong></h3>
<table>
<thead>
<tr>
<th>Característica</th>
<th><code>apachectl</code></th>
<th><code>systemctl</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Propósito</strong></td>
<td>Administra específicamente Apache.</td>
<td>Administra servicios en general, incluyendo Apache.</td>
</tr>
<tr>
<td><strong>Nivel de enfoque</strong></td>
<td>Solo para Apache.</td>
<td>Para cualquier servicio del sistema.</td>
</tr>
<tr>
<td><strong>Comandos básicos</strong></td>
<td>start, stop, restart, graceful, configtest.</td>
<td>start, stop, restart, status, enable.</td>
</tr>
<tr>
<td><strong>Dependencia de systemd</strong></td>
<td>No depende de <code>systemd</code>.</td>
<td>Necesita <code>systemd</code> para funcionar.</td>
</tr>
<tr>
<td><strong>Verificación de configuración</strong></td>
<td>Incluye opción <code>configtest</code>.</td>
<td>No verifica configuración.</td>
</tr>
<tr>
<td><strong>Simplicidad</strong></td>
<td>Directo y específico para Apache.</td>
<td>Requiere más comandos para detalles específicos.</td>
</tr>
</tbody>
</table>
<h3 id="conclusión"><strong>Conclusión</strong></h3>
<ul>
<li>Ambos comandos logran <strong>los mismos objetivos</strong> en cuanto a iniciar, detener y reiniciar Apache.</li>
<li><strong><code>apachectl</code></strong> es más específico y práctico para tareas relacionadas únicamente con Apache.</li>
<li><strong><code>systemctl</code></strong> es más general y se usa para administrar múltiples servicios en sistemas modernos.</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1af48ff7b32f6aa5ae768fc9ed45ab29">2.1 - VirtualHost</h1>
    
	




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Configuración de Apache</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Hosts Virtuales.</li>
            
            
            
        </ul>
    </div>
    


</div>

<h2 id="hosts-virtuales">Hosts Virtuales</h2>
<p>Para entender qué son los hosts virtuales vamos a establecer una analogía.
Imaginemos que tenemos una persona llamada <strong>Manuel</strong>. En el trabajo, le llaman <strong><em>Manuel</em></strong> y adopta una actitud profesional y
seria. En casa o con amigos, le llaman <strong><em>Manolo</em></strong> y su actitud es más relajada y cercana. Aunque es la misma persona,
<em>responde de manera diferente según cómo le llamen.</em></p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 410px">
<img class="card-img-top" src="/servicios/es/docs/01_apache/01_virtualhost/manuel-manolo_hu6f20535f519bb318fa3f2b990b61a956_45386_400x400_fill_q75_h2_box_smart1_2.webp" width="400" height="400">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

<p>De forma similar, en Apache, 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    un Virtual Host permite que el mismo servidor web responda de manera distinta
según el nombre de dominio o dirección con la que se le acceda


</span>
</strong>
, en función de la configuración que tenga
establecdida para cada uno de los Host Virtuales.</p>
<p>Siguiendo con la metáfora, es como si fuera <strong>Manuel</strong> en un contexto y <strong>Manolo</strong> en otro.</p>
<p>Con 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Virtual Hosts


</span>
</strong>
, Apache puede manejar varios sitios web en un solo servidor, mostrando
diferentes contenidos o configuraciones según el dominio que se utilice.
Lógicamente primero tendremos que establecer que varios nombres de dominio cada uno de los cuales va a corresponder a un
host virtual, apunten a la misma ip.
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 683px">
<img class="card-img-top" src="/servicios/es/docs/01_apache/01_virtualhost/virtual_host_hua8b914b33f5ddd74141fa466e9bcddb4_148923_673x295_fill_box_smart1_3.png" width="673" height="295">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


https://medium.com/@jhordydelaguila/creando-y-configurando-virtual-host-con-apache-para-xampp-windows-f90c2b0527ac

</p>
</figcaption>
</figure>
</p>
<p>Apache permite alojar múltiples sitios web mediante Hosts Virtuales, que son configuraciones específicas para cada sitio
en el servidor. Los Virtual Hosts pueden clasificarse según cómo Apache distingue entre ellos:</p>
<ol>
<li>
<p><strong>Basados en IP:</strong><br>
El servidor responde a diferentes direcciones IP configuradas en la máquina. Este método es útil cuando se dispone de
múltiples IPs.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#3c3d38"><span>   &lt;VirtualHost 192.168.56.100:80&gt;
</span></span><span style="display:flex;"><span>       DocumentRoot /var/www/misitio1
</span></span><span style="display:flex;"><span>   &lt;/VirtualHost&gt;
</span></span><span style="display:flex;"><span>   &lt;VirtualHost 192.168.56.200:80&gt;
</span></span><span style="display:flex;"><span>         DocumentRoot /var/www/misitio2
</span></span><span style="display:flex;"><span>   &lt;/VirtualHost&gt;</span></span></code></pre></td></tr></table>
</div>
</div></p>
<ol start="2">
<li><strong>Basados en puerto de escucha:</strong><br>
El servidor distingue entre solicitudes que llegan a puertos diferentes, como 80 para HTTP y 443 para HTTPS,u otros
que estableciéramos.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#3c3d38"><span>   &lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>      DocumentRoot /var/www/misitio1
</span></span><span style="display:flex;"><span>   &lt;/VirtualHost&gt;
</span></span><span style="display:flex;"><span>   &lt;VirtualHost *:443&gt;
</span></span><span style="display:flex;"><span>       DocumentRoot /var/www/misitio2
</span></span><span style="display:flex;"><span>   &lt;/VirtualHost&gt;
</span></span><span style="display:flex;"><span>   &lt;VirtualHost *:8080&gt;
</span></span><span style="display:flex;"><span>        DocumentRoot /var/www/misitio3
</span></span><span style="display:flex;"><span>   &lt;/VirtualHost&gt;</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
</li>
<li>
<p><strong>Basados en nombre de servidor (el más común):</strong><br>
El servidor utiliza el encabezado HTTP <code>Host</code> enviado por el cliente para identificar el sitio solicitado. Este
método permite alojar múltiples sitios en una misma IP y puerto.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#3c3d38"><span>&lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>   DocumentRoot /var/www/misitio1
</span></span><span style="display:flex;"><span>   ServerName www.sitio1 
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;
</span></span><span style="display:flex;"><span>&lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>   DocumentRoot /var/www/misitio2
</span></span><span style="display:flex;"><span>   ServerName www.sitio2
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;
</span></span><span style="display:flex;"><span>&lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>   DocumentRoot /var/www/misitio3
</span></span><span style="display:flex;"><span>   ServerName www.sitio3 
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
</ol>
<p>Para gestionar los hosts, edita el archivo /etc/hosts o configura un DNS local.</p>
<hr style="border-color: red; border-width: 3px;"/>
<p><strong>Nota:</strong> Si hemos configurado nuestro sitio con opciones específicas, estas deben establecerse en la zona del VirtualHost que use SSL (puerto 443). Esto se debe a que las peticiones redirigidas desde HTTP (puerto 80) a HTTPS (puerto 443) solo aplicarán configuraciones realizadas en este último. Por ejemplo:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span>&lt;VirtualHost *:443&gt;<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>DocumentRoot /var/www/seguro<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>SSLEngine On<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>SSLCertificateFile /etc/ssl/certs/ssl-cert-snakeoil.pem<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>&lt;/VirtualHost&gt;</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h3 id="practicando">Practicando:</h3>
<p>Vamos a crear tres sitios web con Virtual Hosts en Apache, cada uno con un DocumentRoot diferente, y configurarlos para que sean accesibles desde los siguientes nombres de dominio:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#3c3d38"><span>www.musica.com
</span></span><span style="display:flex; background-color:#3c3d38"><span>www.informatica.com
</span></span><span style="display:flex; background-color:#3c3d38"><span>www.nombre_alumno.com</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Cada sitio tendrá su propio archivo HTML en su directorio correspondiente.</p>
<h4 id="hahahugoshortcode7s12hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Pasos a realizar


</span>
</strong>
</h4>
<ol>
<li><strong>Crear los directorios para los sitios web</strong>.<br>
Primero, crea los directorios donde estarán los archivos de cada sitio web:</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> mkdir -p /var/www/musica 
</span></span><span style="display:flex;"><span> mkdir -p /var/www/informatica 
</span></span><span style="display:flex;"><span> mkdir -p /var/www/nombre_alumno </span></span></code></pre></td></tr></table>
</div>
</div>
<ol start="2">
<li><strong>Crear archivos HTML básicos</strong> <br>
Agrega un archivo index.html en cada directorio con contenido personalizado para cada sitio:</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> echo <span style="color:#e6db74">&#34;&lt;h1&gt;Bienvenidos a Música&lt;/h1&gt;&#34;</span> &gt;&gt; /var/www/musica/index.html  
</span></span><span style="display:flex;"><span> echo <span style="color:#e6db74">&#34;&lt;h1&gt;Bienvenidos a Informática&lt;/h1&gt;&#34;</span>&gt;&gt;  /var/www/informatica/index.html
</span></span><span style="display:flex;"><span> echo <span style="color:#e6db74">&#34;&lt;h1&gt;Bienvenidos a Mi Sitio&lt;/h1&gt;&#34;</span> &gt;&gt; /var/www/nombre_alumno/index.html</span></span></code></pre></td></tr></table>
</div>
</div>
<ol start="3">
<li><strong>Configurar Virtual Hosts en Apache</strong><br>
Edita o crea los archivos de configuración de Virtual Hosts en /etc/apache2/sites-available/.</li>
</ol>
<p>Primero, crea el archivo para musica:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>sudo nano /etc/apache2/sites-available/musica.conf </span></span></code></pre></td></tr></table>
</div>
</div>
<p>Contenido del archivo <strong>musica.conf</strong>:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>   <span style="color:#f92672">&lt;VirtualHost</span> <span style="color:#e6db74">*:80</span><span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>      ServerName www.musica.com 
</span></span><span style="display:flex;"><span>      DocumentRoot <span style="color:#e6db74">/var/www/musica</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/VirtualHost&gt;</span> </span></span></code></pre></td></tr></table>
</div>
</div>
<p>Repetimos  para los otros sitios:</p>
<p>Contenido del archivo informatica.conf:</p>
<p><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>   sudo nano /etc/apache2/sites-available/informatica.conf </span></span></code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>   <span style="color:#f92672">&lt;VirtualHost</span> <span style="color:#e6db74">*:80</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      ServerName www.informatica.com
</span></span><span style="display:flex;"><span>      DocumentRoot <span style="color:#e6db74">/var/www/informatica</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/VirtualHost&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>Y para nombre_alumno:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>   sudo nano /etc/apache2/sites-available/nombre_alumno.conf</span></span></code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>   <span style="color:#f92672">&lt;VirtualHost</span> <span style="color:#e6db74">*:80</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      ServerName www.nombre_alumno.com
</span></span><span style="display:flex;"><span>      DocumentRoot <span style="color:#e6db74">/var/www/nombre_alumno</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/VirtualHost&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<ol start="4">
<li><strong>Habilitar los Virtual Hosts</strong>
Habilita los sitios usando 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    a2ensite


</span>
</strong>
 y reinicia Apache:</li>
</ol>
<p><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>   sudo a2ensite musica.conf 
</span></span><span style="display:flex;"><span>   sudo a2ensite informatica.conf 
</span></span><span style="display:flex;"><span>   sudo a2ensite nombre_alumno.conf
</span></span><span style="display:flex;"><span>   sudo systemctl reload apache2 </span></span></code></pre></td></tr></table>
</div>
</div>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Observa</h4>

    Ahora puedes observar cómo en la carpeta <strong>site_enabled</strong>, están los ficheros como enlaces simbólicos

</div>
</p>
<ol start="5">
<li><strong>Editar el archivo /etc/hosts</strong><br>
Debemos de acceder al servidor con una sola ip usando los diferentes nombres establecidos en los server name.  <br>
Para ello editamos el archivo /etc/hosts en tu máquina para probar los sitios localmente:</li>
</ol>
<p><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nano /etc/hosts </span></span></code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span> <span style="color:#a6e22e">www</span><span style="color:#f92672">.</span><span style="color:#a6e22e">musica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span> <span style="color:#a6e22e">www</span><span style="color:#f92672">.</span><span style="color:#a6e22e">informatica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span> <span style="color:#a6e22e">www</span><span style="color:#f92672">.</span><span style="color:#a6e22e">nombre_alumno</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span></span></span></code></pre></td></tr></table>
</div>
</div>
6. <strong>Probar los sitios</strong>
Ahora es el momento de probar el funcionamiento de los dominios establecidos</p>
<blockquote>
<blockquote>
<p><a href="http://www.musica.com">http://www.musica.com</a><br>
<a href="http://www.informatica.com">http://www.informatica.com</a> <br>
<a href="http://www.nombre_alumno.com">http://www.nombre_alumno.com</a></p>
</blockquote>
</blockquote>
<h4 id="serveralias">ServerAlias</h4>
<p>La directiva 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    ServerAlias


</span>
</strong>
 en Apache permite añadir nombres de dominio alternativos que serán gestionados por el mismo Virtual Host. <br>
Esto puede ser útil cuando queremos que un sitio web responda a diferentes nombres de dominio, como versiones con o sin &ldquo;www&rdquo; o dominios adicionales.</p>
<p>La configuración del Virtual Host sería:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>   <span style="color:#f92672">&lt;VirtualHost</span> <span style="color:#e6db74">*:80</span><span style="color:#f92672">&gt;</span> 
</span></span><span style="display:flex;"><span>      ServerName www.musica.com 
</span></span><span style="display:flex;"><span>      ServerAlias musica.com www.musica.es musica.es 
</span></span><span style="display:flex;"><span>      DocumentRoot <span style="color:#e6db74">/var/www/musica</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;/VirtualHost&gt;</span> </span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    ServerName


</span>
</strong>
: Define el dominio principal del sitio (<a href="https://www.musica.com">www.musica.com</a> en este caso).</li>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    ServerAlias


</span>
</strong>
: Añade dominios adicionales que apuntan al mismo sitio, permitiendo que Apache gestione las solicitudes correctamente.</li>
</ul>
<p>Supongamos que queremos que el sitio <a href="https://www.musica.com">www.musica.com</a> también responda a los siguientes nombres:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">http</span><span style="color:#f92672">://</span><span style="color:#a6e22e">www</span><span style="color:#f92672">.</span><span style="color:#a6e22e">musica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">http</span><span style="color:#f92672">://</span><span style="color:#a6e22e">musica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">http</span><span style="color:#f92672">://</span><span style="color:#a6e22e">musica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">es</span><span style="color:#f92672">:</span><span style="color:#ae81ff">8080</span></span></span></code></pre></td></tr></table>
</div>
</div>
Y vemos las imágenes:</p>
<hr style="border-color: red; border-width: 3px;"/>
<p><figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 470px">
<img class="card-img-top" src="/servicios/es/docs/01_apache/01_virtualhost/1_musica_hucc49d5f82678c23dcbb191a3fc39e33c_8722_460x89_fill_box_smart1_3.png" width="460" height="89">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 470px">
<img class="card-img-top" src="/servicios/es/docs/01_apache/01_virtualhost/2_musica_hufbe3537923e754ea531daf3191b14aa1_7370_460x89_fill_box_smart1_3.png" width="460" height="89">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 470px">
<img class="card-img-top" src="/servicios/es/docs/01_apache/01_virtualhost/3_musica_hu00d4a358146cbc95276018960a167170_7342_460x89_fill_box_smart1_3.png" width="460" height="89">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Importante</h4>

    <p>Es necesario  modificar también el fichero /etc/hosts para conseguir alcanzar con esos nombres de dominio <strong><em>al equipo</em></strong> donde está instalado el servicio <strong>apache</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>  <span style="color:#a6e22e">www</span><span style="color:#f92672">.</span><span style="color:#a6e22e">informatica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span>  <span style="color:#a6e22e">informatica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span> <span style="color:#a6e22e">informatica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">es</span>
</span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>  <span style="color:#a6e22e">www</span><span style="color:#f92672">.</span><span style="color:#a6e22e">musica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span> <span style="color:#a6e22e">musica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span> <span style="color:#a6e22e">musica</span><span style="color:#f92672">.</span><span style="color:#a6e22e">es</span>
</span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#ae81ff">127.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.1</span>  <span style="color:#a6e22e">www</span><span style="color:#f92672">.</span><span style="color:#a6e22e">manuel</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span> <span style="color:#a6e22e">manuel</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span> <span style="color:#a6e22e">manuel</span><span style="color:#f92672">.</span><span style="color:#a6e22e">es</span></span></span></code></pre></td></tr></table>
</div>
</div>

</div>

<h3 id="usuarios-y-grupos">usuarios y grupos</h3>
<p>Podemos personalizar a qué usuarios queremos dejar acceso, es decir, no tiene por qué tener acceso todos los usuarios al mismo sitio indistintamente que estén incluídos en el fichero de password establecido</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-9dc78ee6e08d94a9f192f8bd5511ea84">2.2 - Auth</h1>
    
	



<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><a href="https://httpd.apache.org/docs/2.4/es/howto/auth.html">https://httpd.apache.org/docs/2.4/es/howto/auth.html</a></li>
            
            
            
        </ul>
    </div>
</div>

<hr style="border-color: red; border-width: 3px;"/>





<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Qué veremos aquí</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Fichero .htaccess</li>
            
            <li>Autenticación basic</li>
            
            <li>Autenticación digest</li>
            
            <li>Autenticación de usuarios</li>
            
            <li>Autenticación de grupo de usuarios</li>
            
            
            
        </ul>
    </div>
    


</div>

<hr style="border-color: red; border-width: 3px;"/>
<h2 id="1--el-fichero-htacces">1.- El fichero .htacces</h2>
<p>Antes de empezar con la autneticación, vamos a ver un fichero de configuración especial en apache: 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    .htaccess


</span>
</strong>
</p>
<p>En apache podemos configurar a nivel global (afectará a todos los proyectos), o bien podemos establecer una configuracion particular a un directorio y todos sus subdirectorios.</p>
<p>La sigueinte imagen trata de ilustrar este concepto:
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 823px">
<img class="card-img-top" src="/servicios/es/docs/01_apache/02_auth/apache_conf_hu4a0e455f421e5f16619552ba6e3f53ec_194324_813x849_fill_box_smart1_3.png" width="813" height="849">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</p>
<p>El archivo 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    .htaccess


</span>
</strong>
 es un archivo de configuración utilizado en servidores web Apache para aplicar configuraciones específicas a un directorio.</p>
<p>Este archivo permite modificar ciertos comportamientos del servidor sin necesidad de acceder al archivo principal de configuración 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    httpd.conf


</span>
</strong>
, o el fichero correspondiente 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    apache2.conf


</span>
</strong>
.</p>
<h3 id="funciones-de-htaccess">Funciones de <code>.htaccess</code></h3>
<ol>
<li>
<p><strong>Control de acceso</strong>:</p>
<ul>
<li>Implementar autenticación (<strong>Basic</strong> y <strong>Digest</strong>).</li>
<li>Restringir acceso a usuarios según IP o nombre de usuario.</li>
<li>Este tema es objeto de estudio en esta sección</li>
</ul>
</li>
<li>
<p><strong>Redirecciones</strong>:</p>
<ul>
<li>Configurar redirecciones 301 (permanentes) y 302 (temporales).</li>
<li>Ejemplo:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>Redirect <span style="color:#ae81ff">301</span> <span style="color:#e6db74">/antigua-pagina.html</span> <span style="color:#e6db74">/nueva-pagina.html</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>Sencillo de utilizar y a veces práctico</li>
</ul>
</li>
<li>
<p><strong>Reescritura de URLs</strong>:</p>
<ul>
<li>Utilizar el módulo <code>mod_rewrite</code> para crear URLs amigables.</li>
<li>Ejemplo:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>RewriteEngine <span style="color:#66d9ef">On</span>
</span></span><span style="display:flex;"><span>RewriteRule ^pagina-amigable$ pagina-real.php [L]</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>Este apartado se aborda en otra sección</li>
</ul>
</li>
<li>
<p><strong>Seguridad</strong>:</p>
<ul>
<li>Proteger directorios con contraseñas.</li>
<li>Restringir el acceso según IP:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>Order Deny,Allow
</span></span><span style="display:flex;"><span>Deny from <span style="color:#66d9ef">all</span>
</span></span><span style="display:flex;"><span>Allow from <span style="color:#ae81ff">192.168.1.0/24</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><strong>Configuraciones específicas</strong>:</p>
<ul>
<li>Establecer una página de error personalizada.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>ErrorDocument <span style="color:#ae81ff">404</span> <span style="color:#e6db74">/error-404.html</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>Especificar el archivo predeterminado al acceder a un directorio.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>DirectoryIndex index.php index.html</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ol>
<h3 id="ventajas-de-htaccess">Ventajas de <code>.htaccess</code></h3>
<ul>
<li><strong>Flexibilidad</strong>: Permite configuraciones personalizadas para cada directorio.</li>
<li><strong>Rapidez</strong>: No requiere reiniciar el servidor para aplicar cambios.</li>
</ul>
<h3 id="desventajas-de-htaccess">Desventajas de <code>.htaccess</code></h3>
<ul>
<li><strong>Rendimiento</strong>: Apache revisa este archivo en cada solicitud, lo que puede impactar en el rendimiento si se usa excesivamente. Si no es necesario, es importante que no esté.</li>
<li><strong>Seguridad</strong>: Es un fichero de configuración que puede exponer información sensible, por lo que hay que saber bien lo que se está haciendo.</li>
</ul>
<h3 id="activar-htaccess">Activar <code>.htaccess</code></h3>
<p>Para que el archivo <code>.htaccess</code> funcione, el archivo principal de configuración de Apache (<code>httpd.conf</code>) debe permitirlo mediante la directiva <code>AllowOverride</code></p>
<p>Para nuestro ejemplo vamos a establecer un directorio a partir del cual (ese directorio o cualquier otro subdirectorio), si tiene un fichero <strong><em>.htaccess</em></strong>, se tenga en cuenta y sea leído. <br>
Si en cualquier otro directorio estuviera ese fichero de configuración <strong>.htaccess</strong>, no se tendrá en cuenta</p>
<p><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span><span style="color:#f92672">&lt;Directory</span> <span style="color:#e6db74">/var/www/html/seguridad</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	AllowOverride <span style="color:#66d9ef">All</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Directory&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Importante</h4>

    <p>No olvides rebotar el servicio para que la configuracion tenga efecto</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">sudo</span> <span style="color:#a6e22e">apachectl</span> <span style="color:#a6e22e">restart</span></span></span></code></pre></td></tr></table>
</div>
</div>

</div>
</p>
<h2 id="2--autenticación-en-apache">2.- Autenticación en Apache</h2>
<p>Apache ofrece diferentes métodos de autenticación para proteger recursos en un servidor web. Los más comunes son:</p>
<ul>
<li>Basic</li>
<li>Digest</li>
</ul>
<h3 id="1--autenticación-basic">1.- <strong>Autenticación Basic</strong></h3>
<p>La autenticación <strong>Basic</strong> es un método sencillo que solicita al usuario un nombre de usuario y una contraseña. Esta información se transmite codificada en base64 (no cifrada), lo que hace que si queremos  garantizar seguridad,deberíamos de usar HTTPS.</p>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Configuración de Basic Authentication


</span>
</strong>

<ol>
<li><strong>Crear un archivo de contraseñas</strong>:
Usa el comando <code>htpasswd</code> para generar el archivo que almacenará las credenciales:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>htpasswd -c /home/vagrant .pass manuel</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<blockquote>
<blockquote>
<ul>
<li>Este comando creará el fichero llamado <strong>.pass</strong> (establece el nombre que consideres)</li>
</ul>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<ul>
<li>El parámetro <code>-c</code> crea el archivo; Si ya existe (para añadir nuevos usuarios), se dede de omitir, ya que si no lo creará de nuevo y se perderán los anteriores.</li>
</ul>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<ul>
<li>El último parámetro es el nombre de usuario, entonces se nos solicatará la password</li>
</ul>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><img alt="img.png" src="/servicios/es/docs/01_apache/02_auth/img.png"></p>
</blockquote>
</blockquote>
<ol start="3">
<li><strong>Configurar el archivo <code>.htaccess</code></strong>:
En el directorio que deseas proteger, crea un archivo <code>.htaccess</code> con el siguiente contenido:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>AuthType Basic
</span></span><span style="display:flex;"><span>AuthName <span style="color:#e6db74">&#34;Área Restringida&#34;</span>
</span></span><span style="display:flex;"><span>AuthUserFile <span style="color:#e6db74">/ruta/a/.htpasswd</span>
</span></span><span style="display:flex;"><span>Require valid-user</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>AuthType Basic</code>: Especifica el tipo de autenticación.</li>
<li><code>AuthName</code>: Mensaje mostrado en el cuadro de diálogo de autenticación.</li>
<li><code>AuthUserFile</code>: Ruta al archivo <code>.htpasswd</code>.</li>
<li><code>Require valid-user</code>: Permite el acceso solo a usuarios válidos.</li>
</ul>
</li>
</ol>
<p><img alt="img_1.png" src="/servicios/es/docs/01_apache/02_auth/img_1.png"></p>
<hr>
<h3 id="2-autenticación-digest">2. <strong>Autenticación Digest</strong></h3>
<p>La autenticación <strong>Digest</strong> es más segura que Basic, ya que cifra las credenciales del usuario usando un hash antes de enviarlas. A pesar de ser más seguro por el hecho de que se cifran las credneciales, también se recomienda usar  HTTPS para mayor seguridad.</p>
<p>El proceso es muy similar al visto anteriormente</p>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Configuración de Digest Authentication


</span>
</strong>

<ol>
<li><strong>Crear un archivo de contraseñas para Digest</strong>:
Usa el comando <code>htdigest</code> para crear un archivo de contraseñas:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>htdigest -c /ruta/a/.htdigest <span style="color:#e6db74">&#34;Área Restringida&#34;</span> usuario</span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>&quot;Área Restringida&quot;</code>: corresponde al ambito (realm), y su valor, que es obligatorio, debe coincidir con el valor de <code>AuthName</code> del fichero de configuración  <code>.htaccess</code>.
<img alt="img_2.png" src="/servicios/es/docs/01_apache/02_auth/img_2.png"></li>
</ul>
</li>
<li><strong>Configurar el archivo <code>.htaccess</code></strong>:
En el directorio que deseas proteger, crea un archivo <code>.htaccess</code> con el siguiente contenido:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>AuthType Digest
</span></span><span style="display:flex;"><span>AuthName <span style="color:#e6db74">&#34;Área Restringida&#34;</span>
</span></span><span style="display:flex;"><span>AuthDigestProvider file
</span></span><span style="display:flex;"><span>AuthUserFile <span style="color:#e6db74">/ruta/a/.htdigest</span>
</span></span><span style="display:flex;"><span>Require valid-user</span></span></code></pre></td></tr></table>
</div>
</div>
- <code>AuthType Digest</code>: Especifica el tipo de autenticación.
- <code>AuthDigestProvider file</code>: Define el proveedor de autenticación (archivo).
- <code>AuthUserFile</code>: Ruta al archivo <code>.htdigest</code>.
- <code>Require valid-user</code>: Permite el acceso solo a usuarios válidos (<strong>valid-user</strong>), o podríamos especificar un solo usuario, en tal caso, solo ese usuario, si se identifica correctamente, tendrá acceso.</li>
</ol>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Importante <Directory></h4>

    <p>En ambos casos, <strong>basic</strong> o <strong>digest</strong>,, hay que asegúrarse de que el archivo principal de configuración de Apache permite el uso de <code>.htaccess</code>.   <br>
Previamente hemos establecido el valor <strong>all</strong>, pero en realidad sería suficiente con establecer <strong>AuthConfig</strong>, ya que es la única configuración que vamos a establecer en el fichero
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"></p>
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>	<span style="color:#f92672">&lt;Directory</span> <span style="color:#e6db74">&#34;/var/www/html/seguridad&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>		AllowOverride AuthConfig
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;/Directory&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div>

</div>

<h2 id="3--configuración-de-usuarios">3.- Configuración de usuarios</h2>
<p>Ahora queremos utilizar el servidor apache para autenticar recursos a determinados usuarios y/o grupo de usuarios.
Para ello vamos a crear un entorno con una serie de restricciones, según se muestran en la imagen.</p>
<ul>
<li>Tenemos 3 grupos de usuarios (contabilidad, informatica y resto)</li>
<li>Tenemos 4 páginas web (publico.html, contabilidad.html, administracion.html y desarrollo.html)</li>
<li>Los accesos permitidos son los que se muestran</li>
<li>Debemos hacerlo tanto con <strong>basic</strong> como con <strong>digest</strong>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 406px">
<img class="card-img-top" src="/servicios/es/docs/01_apache/02_auth/auth_group_hu8b0bf761f61ca92f748a95f646b38857_14624_396x682_fill_q75_h2_box_smart1_2.webp" width="396" height="682">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</li>
</ul>
<h4 id="configuración-de-usuarios-y-grupos">Configuración de usuarios y grupos</h4>
<p>Lo primero que tenemos que hacer es crear los usuarios y grupo en el fichero corresondiente.
Para este comentido, revisamos las directivas importantes del fichero de configuración .htaccess
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#f92672">-</span> <span style="color:#a6e22e">AuthUserFile</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Ruta</span> <span style="color:#a6e22e">al</span> <span style="color:#a6e22e">archivo</span> <span style="color:#a6e22e">de</span> <span style="color:#a6e22e">usuarios</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span> <span style="color:#a6e22e">AuthGroupFile</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Ruta</span> <span style="color:#a6e22e">al</span> <span style="color:#a6e22e">archivo</span> <span style="color:#a6e22e">de</span> <span style="color:#a6e22e">grupos</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span> <span style="color:#66d9ef">Require</span> <span style="color:#a6e22e">group</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Especifica</span> <span style="color:#a6e22e">qué</span> <span style="color:#a6e22e">grupo</span> <span style="color:#a6e22e">tiene</span> <span style="color:#a6e22e">acceso</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span> <span style="color:#66d9ef">Require</span> <span style="color:#a6e22e">user</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Especifica</span> <span style="color:#a6e22e">qué</span> <span style="color:#a6e22e">usuario</span> <span style="color:#a6e22e">tiene</span> <span style="color:#a6e22e">acceso</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span> <span style="color:#66d9ef">Require</span> <span style="color:#a6e22e">valid</span><span style="color:#f92672">-</span><span style="color:#a6e22e">user</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Especifica</span> <span style="color:#a6e22e">qué</span> <span style="color:#a6e22e">cualquier</span> <span style="color:#a6e22e">usuario</span> <span style="color:#a6e22e">registrado</span> <span style="color:#a6e22e">tiene</span> <span style="color:#a6e22e">acceso</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>También es importante revisar los módulos instalados. Para la autenticación de usuarios y grupos necesitamos tener instalados estos módulos:</p>
<p><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span>	<span style="color:#a6e22e">mod_authz_groupfile</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">mod_authz_user</span></span></span></code></pre></td></tr></table>
</div>
</div>
Se puede revisar con el comando para ver los módulos instalados
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">apachectl</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">M</span> 
</span></span></code></pre></td></tr></table>
</div>
</div>
En caso de no tenerlo (es posible que el de grupo no lo esté por defecto)
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span>	<span style="color:#a6e22e">sudo</span> <span style="color:#a6e22e">a2enmod</span> <span style="color:#a6e22e">authz_groupfile</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr style="border-color: red; border-width: 3px;"/>
<h3 id="acciones-a-realizar">Acciones a realizar</h3>
<ol>
<li><strong>Crear un archivo de contraseñas (<code>.htpasswd</code>)</strong>, con los usuarios:
Utiliza el comando <code>htpasswd</code> para crear usuarios:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>     htpasswd -c /home/vagrant/ .htpasswd luis
</span></span><span style="display:flex;"><span>     htpasswd  /home/vagrant/ .htpasswd lourdes
</span></span><span style="display:flex;"><span>     htpasswd  /home/vagrant/ .htpasswd teresa
</span></span><span style="display:flex;"><span>     htpasswd  /home/vagrant/ .htpasswd sonia
</span></span><span style="display:flex;"><span>     htpasswd  /home/vagrant/ .htpasswd pedro
</span></span><span style="display:flex;"><span>     htpasswd  /home/vagrant/ .htpasswd mario</span></span></code></pre></td></tr></table>
</div>
</div>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Observa</h4>

    Observa cómo solo en el primer usuario especificamos <strong>-c</strong> para crear el fichero

</div>

2. <strong>Crear un archivo de grupos (<code>.htgroup</code>)</strong>:
Define grupos y asigna usuarios:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  informatica: sonia teresa lourdes
</span></span><span style="display:flex;"><span>  contabilidad: luis pedro mario</span></span></code></pre></td></tr></table>
</div>
</div>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Nota</h4>

    Vemos que el fichero de grupos es un fichero de texto que editaremos con nuestro editor (vim, o nano o gedit, &hellip;) y escribimos simplemente las líneas especificadas

</div>
</li>
<li><strong>Entorno web</strong></li>
</ol>
<ul>
<li>
<p>Debemos crear las carpetas con los ficheros html</p>
</li>
<li>
<p>Deben de ser directorios para poder establecer configuración por directorio con el fichero de configuración 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    .htaccess


</span>
</strong>
</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 260px">
<img class="card-img-top" src="/servicios/es/docs/01_apache/02_auth/carpetas_web_hu8c18d5b2a6c194f6afb61a029f6a2336_11463_250x300_fill_box_smart1_3.png" width="250" height="300">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">



    
</p>
</figcaption>
</figure>

</li>
</ul>
<ol start="3">
<li><strong>Configurar el archivo <code>.htaccess</code></strong>:
Configura la autenticación en el directorio deseado, en cada directios establecemos:
<ul>
<li>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    administrador


</span>
</strong>
  <br>
En este caso sólo el usuario <strong>luis</strong> puede acceder
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>	     AuthType Basic
</span></span><span style="display:flex;"><span>	     AuthName <span style="color:#e6db74">&#34;Área Restringida Dirección&#34;</span>
</span></span><span style="display:flex;"><span>	     AuthUserFile <span style="color:#e6db74">/home/vagrant/.htpasswd</span>
</span></span><span style="display:flex;"><span>	     Require <span style="color:#66d9ef">user</span> luis</span></span></code></pre></td></tr></table>
</div>
</div></p>
<ul>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    contabilidad


</span>
</strong>
   <br>
En este caso puede acceder cualquier usuario del grupo de <strong>contabilidad</strong> y la usuaria <strong>lourdes</strong></li>
</ul>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>  AuthType Basic
</span></span><span style="display:flex;"><span>  AuthName <span style="color:#e6db74">&#34;Área Restringida de contabilidad&#34;</span>
</span></span><span style="display:flex;"><span>  AuthUserFile <span style="color:#e6db74">/home/vagrant/.htpasswd</span>
</span></span><span style="display:flex;"><span>  AuthGroupFile <span style="color:#e6db74">/home/vagrant/.htgroup</span>
</span></span><span style="display:flex;"><span>  Require <span style="color:#66d9ef">group</span> contabilidad
</span></span><span style="display:flex;"><span>  Require <span style="color:#66d9ef">user</span> lourdes
</span></span><span style="display:flex;"><span>    </span></span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    informatica


</span>
</strong>
   <br>
En este caso puede acceder cualquier usuario del grupo de <strong>informática</strong> y solo ellos
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>   AuthType Basic
</span></span><span style="display:flex;"><span>   AuthName <span style="color:#e6db74">&#34;Área Restringida de contabilidad&#34;</span>
</span></span><span style="display:flex;"><span>   AuthUserFile <span style="color:#e6db74">/home/vagrant/.htpasswd</span>
</span></span><span style="display:flex;"><span>   AuthGroupFile <span style="color:#e6db74">/home/vagrant/.htgroup</span>
</span></span><span style="display:flex;"><span>   Require <span style="color:#66d9ef">group</span> informatica</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h3 id="notas-adicionales">Notas adicionales</h3>
<ul>
<li><strong>Grupos</strong>: Puedes asignar un usuario a múltiples grupos simplemente listándolo en varios grupos dentro del archivo <code>.htgroup</code>.</li>
<li><strong>Permisos de archivo</strong>: Asegúrate de que los archivos <code>.htpasswd</code>, <code>.htdigest</code> y <code>.htgroup</code> sean accesibles por Apache, pero no por usuarios externos. El usuario apache tiene que tener permiso de ejecución en las carpetas con contengan los ficheros, si no, no podrá acceder a ellos, Si los ficheros están en /var/vagrant: Este comando con <strong>o+x</strong> aplica un permiso de ejecución (+x) al directorio /home/vagrant para el grupo de otros (o), con lo que cualquier puede acceder al directorio, también <strong>www-data</strong>.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">sudo</span> <span style="color:#a6e22e">chown</span> <span style="color:#a6e22e">o</span><span style="color:#f92672">+</span><span style="color:#a6e22e">x</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">home</span><span style="color:#f92672">/</span><span style="color:#a6e22e">vagrant</span> 
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<ul>
<li><strong>Visualiza errores</strong>: si hubiera errores visualiza el fichero de errores de apache2
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span>   <span style="color:#a6e22e">tail</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">log</span><span style="color:#f92672">/</span><span style="color:#a6e22e">apache2</span><span style="color:#f92672">/</span><span style="color:#a6e22e">error</span><span style="color:#f92672">.</span><span style="color:#a6e22e">log</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3bb0c1cf4b5aed9fc2005a19ccb20d57">2.3 - Https</h1>
    
	



<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><a href="https://aws.amazon.com/es/what-is/ssl-certificate/">https://aws.amazon.com/es/what-is/ssl-certificate/</a></li>
            
            <li><a href="https://letsencrypt.org/es/getting-started/">https://letsencrypt.org/es/getting-started/</a></li>
            
            <li><a href="https://www.ssllabs.com/index.html">https://www.ssllabs.com/index.html</a></li>
            
            
            
        </ul>
    </div>
</div>

<h2 id="http-https-y-certificados-ssl-en-apache">HTTP, HTTPS y Certificados SSL en Apache</h2>
<p><strong>Apache</strong> permite configurar servidores web para admitir  <strong>conexiones HTTP y HTTPS</strong>.
Sus siglas se corresponden con <strong>Hypertext Transfer Protocol Secure</strong> lo que ya indica que añade seguridad a HTTP.</p>
<p>En realidad, no es un protocolo propio, sino que se basa en introducir una capa con el protocolo SSL/TLS entre la capa de transporte y la capa de aplicación en el conjunto de protocolos TCP/IP. Mediante el uso de SSL/TLS, HTTPS consigue que la comunicación en la web sea segura.</p>
<p>La configuración de <strong>HTTPS</strong> requiere el uso de <strong>certificados SSL/TLS <em>protocolo (Secure Socket Layers/ Transport Layer Aecurity)</em></strong>, que garantizan una comunicación segura mediante cifrado.</p>
<hr>
<h3 id="1-diferencia-entre-http-y-https">1. <strong>Diferencia entre HTTP y HTTPS</strong></h3>
<ul>
<li>
<p><strong>HTTP (HyperText Transfer Protocol)</strong>:</p>
<ul>
<li>Es un protocolo no cifrado.</li>
<li>Las comunicaciones entre el cliente y el servidor viajan con el texto tal cual se envía y se podrían capturar y ver por un tercero.</li>
<li>Se utiliza para sitios web que no manejan información sensible.</li>
</ul>
</li>
<li>
<p><strong>HTTPS (HyperText Transfer Protocol Secure)</strong>:</p>
<ul>
<li>
<p>Es una versión segura de HTTP que utiliza los protocolos SSL/TLS para cifrar las comunicaciones.</p>
</li>
<li>
<p>SSL/TLS son protocolos que garantizan la confidencialidad, integridad y autenticación de las comunicaciones.</p>
</li>
<li>
<p>SSL/TLS, se utiliza para asegurar <strong>confidencialidad, autenticidad, integridad y no repudio</strong> entre el cliente y el servidor:</p>
<ul>
<li><strong>Confidencialidad</strong>: La confidencialidad se entiende en el ámbito de la seguridad informática, como la protección de datos y de información intercambiada entre un emisor y uno o más destinatarios frente a terceros.</li>
<li><strong>Integridad</strong>: Es la propiedad que busca mantener los datos libres de modificaciones no autorizadas.</li>
<li><strong>Autenticación o autentificación</strong>: Propiedad que permite identificar el generador de la información.</li>
<li><strong>No repudio</strong>: Propiedad que prueba que el autor envió la comunicación (no repudio en origen) y que el destinatario la recibió (no repudio en destino)</li>
</ul>
</li>
<li>
<p>Para establecer una conexión HTTPS, se necesita un certificado digital válido (emitido por una autoridad certificadora, CA), también llamado <strong>certificado SSL/TLS</strong> que permita la autenticación del servidor y la negociación de claves seguras.</p>
</li>
</ul>
</li>
</ul>
<h3 id="las-características">Las características</h3>
<p>Las características de una página web protegida por SSL/TLS son las siguientes:</p>
<ul>
<li><strong>Un ícono de candado</strong> y una barra de direcciones verde en el navegador web</li>
<li><strong>Un prefijo https</strong> en la dirección del sitio web del navegador</li>
<li><strong>Un certificado SSL/TLS válido</strong>. Puede comprobar si el certificado SSL/TLS es válido haciendo clic y expandiendo el ícono del candado en la barra de direcciones URL</li>
<li>Una vez establecida la conexión cifrada, <strong>solo el cliente y el servidor web</strong> pueden ver los datos que se envían.</li>
</ul>
<p>Una transacción segura SSL de manera simplificada sigue el siguiente modelo:</p>
<ol>
<li>Primero, el cliente se conecta al servidor comercial protegido por SSL y pide la autenticación. El cliente también envía la lista de los criptosistemas que soporta, clasificada en orden descendente por la longitud de la clave.</li>
<li>El servidor que recibe la solicitud envía un certificado al cliente que contiene la clave pública del servidor firmado por una entidad de certificación (CA), y también el nombre del criptosistema que está más alto en la lista de compatibilidades</li>
<li>El cliente verifica la validez del certificado, luego crea una clave secreta al azar, cifra esta clave con la clave pública del servidor y envía el resultado al servidor (clave de sesión).</li>
<li>El servidor es capaz de descifrar la clave de sesión con su clave privada. De esta manera, hay dos entidades que comparten una clave que sólo ellos conocen. Las transacciones restantes pueden realizarse utilizando la clave de sesión, garantizando la integridad y la confidencialidad de los datos que se intercambian.</li>
</ol>
<hr>
<h3 id="2-pasos-para-configurar-https-en-apache">2. <strong>Pasos para configurar HTTPS en Apache</strong></h3>
<h4 id="paso-1-activar-el-módulo-ssl">Paso 1: Activar el módulo SSL</h4>
<p>Habilita el módulo SSL en Apache:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2enmod ssl
</span></span><span style="display:flex;"><span>sudo systemctl restart apache2</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h4 id="paso-2-crear-o-instalar-un-certificado-ssl">Paso 2: Crear o instalar un certificado SSL</h4>
<ol>
<li>
<p><strong>Crear un certificado autofirmado (solo para pruebas):</strong>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo openssl req -x509 -nodes -days <span style="color:#ae81ff">365</span> -newkey rsa:2048 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-keyout /etc/ssl/private/apache-selfsigned.key <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-out /etc/ssl/certs/apache-selfsigned.crt</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Usar un certificado emitido por una CA (recomendado):</strong></p>
<ul>
<li>Solicita un certificado SSL/TLS de una autoridad certificadora como Let&rsquo;s Encrypt, DigiCert, o Comodo.</li>
<li>Puedes usar herramientas como <code>certbot</code> para automatizar este proceso:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install certbot python3-certbot-apache
</span></span><span style="display:flex;"><span>sudo certbot --apache</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ol>
<h4 id="paso-3-configurar-apache-para-https">Paso 3: Configurar Apache para HTTPS</h4>
<p>Edita el archivo de configuración del sitio web en <code>/etc/apache2/sites-available/mi-sitio.conf</code>:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span><span style="color:#f92672">&lt;VirtualHost</span> <span style="color:#e6db74">*:80</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>ServerName example.com
</span></span><span style="display:flex;"><span>Redirect permanent / https://example.com/
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/VirtualHost&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;VirtualHost</span> <span style="color:#e6db74">*:443</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>ServerName example.com
</span></span><span style="display:flex;"><span>DocumentRoot <span style="color:#e6db74">/var/www/html</span>
</span></span><span style="display:flex;"><span>    SSLEngine <span style="color:#66d9ef">On</span>
</span></span><span style="display:flex;"><span>    SSLCertificateFile <span style="color:#e6db74">/etc/ssl/certs/apache-selfsigned.crt</span>
</span></span><span style="display:flex;"><span>    SSLCertificateKeyFile <span style="color:#e6db74">/etc/ssl/private/apache-selfsigned.key</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Directory</span> <span style="color:#e6db74">/var/www/html</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        AllowOverride <span style="color:#66d9ef">All</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Directory&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/VirtualHost&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<ul>
<li><strong><code>Redirect permanent</code></strong>: Redirige todo el tráfico HTTP al puerto HTTPS.</li>
<li><strong><code>SSLEngine On</code></strong>: Habilita SSL/TLS.</li>
<li><strong><code>SSLCertificateFile</code> y <code>SSLCertificateKeyFile</code></strong>: Especifican las rutas a los archivos del certificado y la clave privada.</li>
</ul>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Certificados usados</h4>

    Dichos certificados “de aceite de serpiente” (Wikipedia: Snake oil (cryptography)) los genera el script de postinstalación del paquete ssl-cert de Ubuntu asociados al hostname del sistema.

</div>

<h4 id="paso-4-reiniciar-apache">Paso 4: Reiniciar Apache</h4>
<p>Reinicia el servidor para aplicar los cambios:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart apache2</span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr>
<h3 id="3-redirigir-http-a-https-automáticamente">3. <strong>Redirigir HTTP a HTTPS automáticamente</strong></h3>
<p>Configura una redirección en el archivo <code>.htaccess</code>:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>RewriteEngine <span style="color:#66d9ef">On</span>
</span></span><span style="display:flex;"><span>RewriteCond %{HTTPS} <span style="color:#66d9ef">off</span>
</span></span><span style="display:flex;"><span>RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [L,R=301]</span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr>
<h3 id="4-verificar-la-configuración">4. <strong>Verificar la configuración</strong></h3>
<ol>
<li>Accede a tu dominio usando <code>https://</code> y asegúrate de que la conexión es segura.</li>
<li>Utiliza herramientas como <a href="https://www.ssllabs.com/">SSL Labs</a> para analizar la configuración SSL/TLS.</li>
</ol>
<hr>
<h3 id="notas-adicionales">Notas adicionales</h3>
<ul>
<li>
<p><strong>Renovación automática de certificados</strong>: Si usas Let&rsquo;s Encrypt, configura un cron job para renovar los certificados automáticamente:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo certbot renew --quiet</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Seguridad adicional</strong>: Configura encabezados HTTP como <code>Strict-Transport-Security</code> para reforzar HTTPS:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>Header always set Strict-Transport-Security <span style="color:#e6db74">&#34;max-age=31536000; includeSubDomains&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a7c6ee1e33612d9ceaf6bbdec00c003c">2.4 - Rewrite</h1>
    
	<h2 id="reescritura-de-urls-en-apache-mod_rewrite">Reescritura de URLs en Apache (mod_rewrite)</h2>
<p>El módulo <code>mod_rewrite</code> de Apache permite reescribir URLs de forma dinámica, haciendo que las direcciones sean más amigables para los usuarios y motores de búsqueda. Este módulo es muy potente y flexible, ya que permite redirigir o transformar URLs en función de reglas definidas.</p>
<h3 id="por-qué-usar-mod_rewrite">¿Por qué usar mod_rewrite?</h3>
<ol>
<li>
<p><strong>URLs amigables</strong>: Transformar URLs complejas en direcciones más fáciles de leer.</p>
<ul>
<li>Ejemplo: Cambiar <code>https://example.com/product.php?id=123</code> a <code>https://example.com/product/123</code>.</li>
</ul>
</li>
<li>
<p><strong>Redirecciones permanentes o temporales</strong>: Mover páginas sin perder tráfico o SEO.</p>
<ul>
<li>Ejemplo: Redirigir de <code>http://example.com</code> a <code>https://example.com</code>.</li>
</ul>
</li>
<li>
<p><strong>Reescritura interna</strong>: Mapear una URL visible a una ruta interna en el servidor.</p>
<ul>
<li>Ejemplo: Redirigir <code>https://example.com/blog/post</code> a <code>https://example.com/blog.php?post=post</code>.</li>
</ul>
</li>
</ol>
<hr>
<h3 id="ejemplo-básico-de-reescritura-con-htaccess">Ejemplo básico de reescritura con .htaccess</h3>
<ol>
<li>
<p><strong>Activar el módulo <code>mod_rewrite</code></strong>:
Si no está activado, habilítalo en Apache:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2enmod rewrite
</span></span><span style="display:flex;"><span>sudo systemctl restart apache2</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Permitir el uso de .htaccess</strong>:
Asegúrate de que el archivo de configuración de Apache (<code>apache2.conf</code>) permite la directiva <code>AllowOverride</code>:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span><span style="color:#f92672">&lt;Directory</span> <span style="color:#e6db74">&#34;/var/www/html&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>AllowOverride <span style="color:#66d9ef">All</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/Directory&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Crear las reglas de reescritura en .htaccess</strong>:
Un ejemplo típico de reescritura para URLs amigables:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>RewriteEngine <span style="color:#66d9ef">On</span>
</span></span><span style="display:flex;"><span>RewriteRule ^producto/([0-9]+)$ producto.php?id=$1 [L]</span></span></code></pre></td></tr></table>
</div>
</div></p>
<ul>
<li><strong><code>RewriteEngine On</code></strong>: Activa el motor de reescritura.</li>
<li><strong><code>RewriteRule</code></strong>:
<ul>
<li><code>^producto/([0-9]+)$</code>: Coincide con URLs que empiecen por <code>producto/</code> seguido de un número.</li>
<li><code>producto.php?id=$1</code>: Reescribe la URL para redirigir al archivo <code>producto.php</code> pasando el número como parámetro.</li>
<li><code>[L]</code>: Indica que esta es la última regla si coincide.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h3 id="prueba-del-ejemplo">Prueba del ejemplo</h3>
<ul>
<li>URL solicitada: <code>https://example.com/producto/123</code></li>
<li>URL interna a la que se redirige: <code>https://example.com/producto.php?id=123</code></li>
</ul>
<hr>
<h3 id="notas-adicionales">Notas adicionales</h3>
<ul>
<li>
<p><strong>Depuración</strong>: Habilita el registro de errores para verificar las reglas:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-apache" data-lang="apache"><span style="display:flex;"><span>RewriteLog <span style="color:#e6db74">&#34;/var/log/apache2/rewrite.log&#34;</span>
</span></span><span style="display:flex;"><span>RewriteLogLevel <span style="color:#ae81ff">3</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Reglas avanzadas</strong>: Se pueden usar condiciones (<code>RewriteCond</code>) para añadir lógica condicional a las reglas de reescritura, como verificar el dominio o parámetros específicos.</p>
</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3644dc1908878e203d2d4d6dc142c5eb">3 - SSH Secure Shell</h1>
    <div class="lead">Aprendemos a instalar, configurar y personalizar Apache para implementar servicios web efectivos.</div>
	<p>




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Qué veremos aquí</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>ssh</li>
            
            <li>ficheros de configuración</li>
            
            <li>clave pública y privada</li>
            
            <li>rsync</li>
            
            
            
        </ul>
    </div>
    


</div>





<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><a href="https://www.openssh.com/manual.html">https://www.openssh.com/manual.html</a></li>
            
            
            
            
        </ul>
    </div>
</div>
</p>
<h2 id="ssh-secure-shell">SSH (Secure Shell)</h2>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    SSH


</span>
</strong>
 es un protocolo que permite iniciar sesiones seguras en máquinas remotas. Utiliza el puerto 22 y su objetivo es establecer conexiones remotas que permitan la transmisión segura de todo tipo de datos. Es parecido a Telnet, con la diferencia de que la información en el caso de SSH se intercambia de forma cifrada.</p>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fa-shield-alt" aria-hidden="true"></i>
    
    <strong>Conexión remota segura</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>SSH permite conectarte a una máquina remota de manera segura y evitar que la información sensible sea capturada por sniffers.</li>
        
        
        
      </ul>
  </div>
</div>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    SSH


</span>
</strong>
 utiliza técnicas de criptografía para autenticar a los usuarios y garantizar la confidencialidad al cifrar las conexiones entre dispositivos.</p>
<p>Una técnica muy interesante que podemos lograr con SSH es la 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    tunelización


</span>
</strong>
. Crear un túnel una comunicación  consiste en redirigir puertos con el objetivo de que los paquetes enviados en una comunicación puedan atravesar redes que, de otro modo, podrían estarían bloqueadas.</p>
<p>Gracias a SSH, podemos conectarnos a servidores remotos para gestionar infraestructuras y transferir archivos de forma segura.</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 648px">
<img class="card-img-top" src="/servicios/es/docs/03_ssh/tunel_hu3ec0c5d396215fd2c06027bb5a37960e_15417_638x241_fill_box_smart1_3.png" width="638" height="241">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


https://geekland.eu/que-es-y-para-que-sirve-un-tunel-ssh/


</p>
</figcaption>
</figure>

<h2 id="instalación-de-ssh">Instalación de SSH</h2>
<p>Para instalar un servidor SSH en Ubuntu 24, ejecuta el siguiente comando:
En nuestro caso vamos a utilizar un virtual box configurado con el siguiente fichero de configuración.
Obligatoriamente necesitamos conocer la ip del equipo al que tenemos que conectarnos o bien su nombre, por lo que le vamos a asigar una ip
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">Vagrant</span><span style="color:#f92672">.</span><span style="color:#a6e22e">configure</span>(<span style="color:#e6db74">&#34;2&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span><span style="color:#a6e22e">config</span><span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">vm</span><span style="color:#f92672">.</span><span style="color:#a6e22e">box</span> <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bento/ubuntu-24.04&#34;</span>
</span></span><span style="display:flex; background-color:#3c3d38"><span>  <span style="color:#a6e22e">config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">vm</span><span style="color:#f92672">.</span><span style="color:#a6e22e">network</span> <span style="color:#e6db74">&#34;private_network&#34;</span>, <span style="color:#a6e22e">ip</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;192.168.56.101&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">end</span></span></span></code></pre></td></tr></table>
</div>
</div>
Una vez dentro de nuestra máquina procedemos a instalar el <strong>servidor ssh</strong>: 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    openssh-server


</span>
</strong>
, que es un programa que implementa los protocolos 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    ssh


</span>
</strong>
</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>sudo apt-get install openssh-server</span></span></code></pre></td></tr></table>
</div>
</div>
<p>A continuación, y una vez instalado, vamos a probar a conectarnos desde nuestra máquina.</p>
<h2 id="conexión-remota-con-ssh">Conexión remota con SSH.</h2>
<p>Tenemos diferentes forma de conectar con una máquina usando ssh, vamos a estudiar dos métodos:</p>
<hr style="border-color: red; border-width: 3px;"/>
<ol>
<li>Usar usuario/password, como en telnet, pero con comunicaciones cifradas.</li>
<li>Usar clave publica/privada para la autenticación.</li>
</ol>
<h3 id="conexión-usuario--password">Conexión usuario / password</h3>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Conexión por usuario y password


</span>
</strong>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>    ssh usuario@ip_maquina</span></span></code></pre></td></tr></table>
</div>
</div>
En nuestro caso concreto, solicito conexión y me pedirá el password
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span>    <span style="color:#a6e22e">ssh</span> <span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.101</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.101</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">password</span><span style="color:#f92672">:</span></span></span></code></pre></td></tr></table>
</div>
</div>
<strong>Nos pide la pass del usuario con el que estamos actualmente</strong></p>
<blockquote>
<p>Si este usuario no existe en la máquina, no nos permitirá conectarnos


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Windows</h4>

    <p>Si trabajas en windows, tenemos varios programa para ejecutar un cliente ssh, uno de los más conocidos es putty:</p>
<blockquote>
<p><a href="https://www.putty.org/">https://www.putty.org/</a></p>
</blockquote>
<p>La mejor opción es abrir un termina de <strong>powershell</strong>, que trae el cliente de <strong>ssh</strong> en línea de comandos y podrás especificar estas mismas acciones.</p>


</div>

Una vez conectado nos dará un mensaje de bienvenida:
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 880px">
<img class="card-img-top" src="/servicios/es/docs/03_ssh/2_conexion_hud85e93ab69ae6957790fe330cb8a4ef3_22484_870x110_fill_box_smart1_3.png" width="870" height="110">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</p>
</blockquote>
<h3 id="clave-pública-y-privada">Clave pública y privada</h3>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Conectando con clave pública y clave privada


</span>
</strong>

<p>Este tipo de conexión no requiere que el usuario introduzca una contraseña.</p>
<p>En su lugar, se utiliza <strong>una pareja de claves</strong>: 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    la clave pública y su clave  privada


</span>
</strong>
.</p>
<p>La clave pública se copia previamente al servidor, y durante la conexión, el servidor valida que la clave privada utilizada corresponda a su pareja la clave pública registrada en el servidor, otorgando o denegando el acceso en función de esta verificación.</p>
<p><strong>Concepto básico de clave pública y clave privada</strong></p>
<p>Supongamos que tenemos un candado que podemos abrir y cerrar:
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 310px">
<img class="card-img-top" src="/servicios/es/docs/03_ssh/candado_hu4cb4f861f3e874d49b9586cf381e2530_19533_300x300_fit_box_3.png" width="300" height="167">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</p>
<p>Igualmente tenemos dos llaves mágicas que van en pareja</p>
<table>
<thead>
<tr>
<th>Privada</th>
<th>Pública</th>
</tr>
</thead>
<tbody>
<tr>
<td><figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 210px">
<img class="card-img-top" src="/servicios/es/docs/03_ssh/llave_privada_hu81471db79c553db7e047d8f7a239feaf_32940_200x250_fit_box_3.png" width="200" height="94">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">

 
</p>
</figcaption>
</figure>
</td>
<td><figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 210px">
<img class="card-img-top" src="/servicios/es/docs/03_ssh/llave_publica_hua794917a7211d3f84f2b5c336775715a_28665_200x250_fit_box_3.png" width="200" height="96">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">

     
</p>
</figcaption>
</figure>
</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Entonces el concepto de clave pública y privada funciona del siguiente modo.</p>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Cuando ciframos un mensaje con una clave privada <strong>solo la clave pública pareja de ella puede abrirlo</strong>


</span>
</strong>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 642px">
<img class="card-img-top" src="/servicios/es/docs/03_ssh/claves_publica_hu16e5cd5004ae680387cd874834b1a932_24578_632x312_fill_q75_h2_box_smart1_2.webp" width="632" height="312">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</p>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Por otro lado si ciframos un mensaje con una clave pública <strong>solo la clave privada  pareja de ella puede abrirlo</strong>


</span>
</strong>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 696px">
<img class="card-img-top" src="/servicios/es/docs/03_ssh/claves_privada_hu5b1c1d8b176fe31b49034f2ec78c7382_31110_686x422_fill_q75_h2_box_smart1_2.webp" width="686" height="422">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">





</p>
</figcaption>
</figure>
</p>
<p><strong>Este concepto parte de operaciones matemáticas complejas y, en el caso de claves asimétricas, puede involucrar números primos muy grandes y operaciones de una sola dirección</strong>.</p>
<p>Vamos a exponer, de forma muy básica, la diferencia entre 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    claves simétricas y asimétricas.


</span>
</strong>
</p>
<hr style="border-color: red; border-width: 3px;"/>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Claves simétricas


</span>
</strong>

<hr style="border-color: red; border-width: 3px;"/>
<p>Con la misma clave que ciframos, desciframos.</p>
<p>Para comprender el concepto a nivel muy básico, supongamos que tenemos un mensaje: <strong>8</strong>, y lo ciframos con la clave <strong>3</strong> mediante una operación de multiplicar. El mensaje cifrado será <strong>24</strong> <em><strong>(8x3).</strong></em></p>
<p>Si alguien tiene el mensaje cifrado y la clave, puede fácilmente realizar la operación inversa para obtener el mensaje original <strong>(24 ÷ 3 = 8)</strong>. Estas <strong>son operaciones reversibles</strong>.</p>
<p>Este tipo de <strong>cifrados son simétricos</strong> y están basados en operaciones reversibles.</p>
<blockquote>
<p>Es fundamental que <strong>la clave no se comparta públicamente</strong>, ya que hacerlo comprometería la confidencialidad y la autenticidad del mensaje original.</p>
</blockquote>
<hr style="border-color: red; border-width: 3px;"/>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Claves asimétricas


</span>
</strong>

<hr style="border-color: red; border-width: 3px;"/>
<p>En este caso, se utilizan dos claves diferentes: <strong>una clave pública y una clave privada</strong>.</p>
<p>Este tipo de cifrado está basado en operaciones matemáticas no reversibles o de una sola dirección. Aunque tengamos el mensaje cifrado y la clave pública utilizada para cifrarlo, no podremos obtener el mensaje original, ya que el descifrado requiere una clave privada diferente.</p>
<p>Supongamos, de forma muy simplificada, que el mensaje original es <strong>8</strong>, la clave es <strong>3</strong>, y la operación es el módulo (una operación no reversible). Aplicando esta operación, el mensaje cifrado será <strong>2 <em>(8 modulo 3)</em></strong>.</p>
<p>Si tengo la clave pública 3 y el mensaje cifrado 2, hay infinitos posibles mensajes originales que podrían haber generado ese resultado: 11, 15, 18, 20, 23, &hellip;.</p>
<blockquote>
<p>Por esta razón, la clave pública puede compartirse sin comprometer la confidencialidad o autenticidad del mensaje original, ya que solo la clave privada asociada puede descifrarlo.</p>
</blockquote>
<h3 id="hahahugoshortcode12s33hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Conectando SSH por clave pública/privada


</span>
</strong>
</h3>
<ol>
<li><strong>Generamos en nuestro cliente una pareja de clave pública/privada</strong><br>
Para ello, utilizamos el comando <strong>ssh-keygen</strong>. Este comando genera las claves necesarias para autenticar una conexión SSH.</li>
</ol>
<blockquote>
<p>Durante el proceso de generación, se nos preguntará si queremos proteger la clave privada con una contraseña (

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    passphrase


</span>
</strong>
):</p>
<ul>
<li>Si decidimos no usar una 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    passphrase


</span>
</strong>
, el sistema <em>no pedirá contraseña al utilizar la clave privada</em>.</li>
<li>Si usamos una 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    passphrase


</span>
</strong>
 , el sistema <em>nos pedirá la password, cada vez que queramos usar la clave pública/privada</em>. Podemos evitar que nos la pida repetidamente durante una sesión con el comando <strong>ssh-agent</strong>, que almacena las claves en memoria.</li>
</ul>
</blockquote>
<hr>
<details>
    <summary>Ejemplos de uso</summary>
    <div class="solution-content">
<p><strong>Uso básico (sin parámetros):</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>ssh-keygen</span></span></code></pre></td></tr></table>
</div>
</div>
<p><strong>Uso con opciones personalizadas:</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>ssh-keygen -t rsa -b <span style="color:#ae81ff">4096</span> -f $HOME/.ssh/key_vagrant -C <span style="color:#e6db74">&#34;vagrant&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
</details>
<style>
    .solution-content {
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-top: 5px;
        background-color: #f9f9f9;
    }
    summary {
        cursor: pointer;
        font-weight: bold;
        color: #0073e6;
    }
</style>
<hr>


<strong>
<span class="font-weight-bold text-primary fs-4">

    Descripción de los parámetros utilizados


</span>
</strong>

<ul>
<li><strong><code>-t rsa</code></strong>: Especifica el algoritmo de cifrado (valor por defecto: <strong>RSA</strong>).</li>
<li><strong><code>-b 4096</code></strong>: Define el tamaño de la clave en bits (por defecto: <strong>2048</strong>, recomendado: <strong>4096</strong> para mayor seguridad).</li>
<li><strong><code>-f ubicación/nombre_fichero</code></strong>: Indica la ubicación y el nombre del archivo generado.
<ul>
<li>Se crearán dos archivos:
<ul>
<li>Uno sin extensión: clave privada.</li>
<li>Uno con extensión <strong><code>.pub</code></strong>: clave pública.</li>
</ul>
</li>
</ul>
</li>
<li><strong><code>-C &quot;vagrant&quot;</code></strong>: Añade un comentario a la clave pública para identificarla mejor (por ejemplo, el nombre del usuario o el propósito de la clave).</li>
</ul>
<hr>
<hr style="border-color: red; border-width: 3px;"/>




<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Fuentes</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            
            
        </ul>
    </div>
</div>



<strong>
<span class="font-weight-bold text-primary fs-4">

    Paso a realizar detallados


</span>
</strong>

<p><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#75715e"># /etc/ssh [15:55:30]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##### nos movemos a nuestro directorio home/.ssh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">→</span> <span style="color:#a6e22e">cd</span> $HOME<span style="color:#f92672">/.</span><span style="color:#a6e22e">ssh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ~/.ssh [15:55:40]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##### verificamos directorio
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">→</span> <span style="color:#a6e22e">pwd</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">/</span><span style="color:#a6e22e">home</span><span style="color:#f92672">/</span><span style="color:#a6e22e">manuel</span><span style="color:#f92672">/.</span><span style="color:#a6e22e">ssh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ~/.ssh [15:56:08]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">##### generamos las claves
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">→</span> <span style="color:#a6e22e">ssh</span><span style="color:#f92672">-</span><span style="color:#a6e22e">keygen</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">t</span> <span style="color:#a6e22e">rsa</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">b</span> <span style="color:#ae81ff">4096</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">f</span> $HOME<span style="color:#f92672">/.</span><span style="color:#a6e22e">ssh</span><span style="color:#f92672">/</span><span style="color:#a6e22e">key_vagrant</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">C</span> <span style="color:#e6db74">&#34;vagrant&#34;</span>             
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Generating</span> <span style="color:#66d9ef">public</span><span style="color:#f92672">/</span><span style="color:#66d9ef">private</span> <span style="color:#a6e22e">rsa</span> <span style="color:#a6e22e">key</span> <span style="color:#a6e22e">pair</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Enter</span> <span style="color:#a6e22e">passphrase</span> (<span style="color:#66d9ef">empty</span> <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">no</span> <span style="color:#a6e22e">passphrase</span>)<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Enter</span> <span style="color:#a6e22e">same</span> <span style="color:#a6e22e">passphrase</span> <span style="color:#a6e22e">again</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Your</span> <span style="color:#a6e22e">identification</span> <span style="color:#a6e22e">has</span> <span style="color:#a6e22e">been</span> <span style="color:#a6e22e">saved</span> <span style="color:#a6e22e">in</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">home</span><span style="color:#f92672">/</span><span style="color:#a6e22e">manuel</span><span style="color:#f92672">/.</span><span style="color:#a6e22e">ssh</span><span style="color:#f92672">/</span><span style="color:#a6e22e">key_vagrant</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Your</span> <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">key</span> <span style="color:#a6e22e">has</span> <span style="color:#a6e22e">been</span> <span style="color:#a6e22e">saved</span> <span style="color:#a6e22e">in</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">home</span><span style="color:#f92672">/</span><span style="color:#a6e22e">manuel</span><span style="color:#f92672">/.</span><span style="color:#a6e22e">ssh</span><span style="color:#f92672">/</span><span style="color:#a6e22e">key_vagrant</span><span style="color:#f92672">.</span><span style="color:#a6e22e">pub</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">The</span> <span style="color:#a6e22e">key</span> <span style="color:#a6e22e">fingerprint</span> <span style="color:#a6e22e">is</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SHA256</span><span style="color:#f92672">:</span><span style="color:#a6e22e">haU9D5</span><span style="color:#f92672">+</span><span style="color:#a6e22e">VgfjmmGlwLrG</span><span style="color:#f92672">/</span><span style="color:#a6e22e">XCx9achIy2y6nbbvP</span><span style="color:#f92672">+</span><span style="color:#a6e22e">dyWfU</span> <span style="color:#a6e22e">vagrant</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">The</span> <span style="color:#a6e22e">key</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">randomart</span> <span style="color:#a6e22e">image</span> <span style="color:#a6e22e">is</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+---</span>[<span style="color:#a6e22e">RSA</span> <span style="color:#ae81ff">4096</span>]<span style="color:#f92672">----+</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>          <span style="color:#f92672">..</span> <span style="color:#f92672">..</span>  <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>         <span style="color:#f92672">=.</span> <span style="color:#f92672">.</span>  <span style="color:#a6e22e">o</span> <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>        <span style="color:#a6e22e">o</span> <span style="color:#f92672">=.</span>  <span style="color:#a6e22e">o</span>  <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>        <span style="color:#a6e22e">o</span><span style="color:#f92672">..=</span><span style="color:#a6e22e">oo</span>  <span style="color:#f92672">.|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>        <span style="color:#a6e22e">S</span><span style="color:#f92672">*.*+</span>   <span style="color:#a6e22e">o</span><span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>        <span style="color:#a6e22e">o</span><span style="color:#f92672">+**..</span> <span style="color:#f92672">.</span><span style="color:#a6e22e">E</span><span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>         <span style="color:#f92672">+</span><span style="color:#a6e22e">B</span> <span style="color:#f92672">*</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">o</span><span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>         <span style="color:#f92672">=</span><span style="color:#a6e22e">o</span><span style="color:#f92672">+</span> <span style="color:#a6e22e">oo</span><span style="color:#f92672">.</span><span style="color:#a6e22e">o</span><span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>        <span style="color:#a6e22e">oo</span><span style="color:#f92672">*=</span><span style="color:#a6e22e">o</span><span style="color:#f92672">..*.|</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+----</span>[<span style="color:#a6e22e">SHA256</span>]<span style="color:#f92672">-----+</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># manuel at pitufin in ~/.ssh [15:57:38]
</span></span></span></code></pre></td></tr></table>
</div>
</div>
2. <strong>Copiar la clave pública en el servidor</strong></p>
<p>Ahora debemos copiar el fichero que contiene la clave pública al servidor
Para ello podemos usar el comando <code>scp</code> que corresponde al copy de ssh
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">scp</span> $HOME<span style="color:#f92672">/.</span><span style="color:#a6e22e">ssh</span><span style="color:#f92672">/</span><span style="color:#a6e22e">id_rsa</span><span style="color:#f92672">.</span><span style="color:#a6e22e">pub</span> <span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.101</span><span style="color:#f92672">:/</span><span style="color:#a6e22e">home</span><span style="color:#f92672">/</span><span style="color:#a6e22e">vagrant</span><span style="color:#f92672">/..</span><span style="color:#a6e22e">ssh</span><span style="color:#f92672">/</span><span style="color:#a6e22e">nombre_pub</span><span style="color:#f92672">.</span><span style="color:#a6e22e">pub</span></span></span></code></pre></td></tr></table>
</div>
</div>
3. <strong>Creer el fichero authorized_keys</strong></p>
<p>Ahora debemos, en el servidor donde hemos copiado el fichero añadir su contenido al fichero <code>authorized_keys</code>.
Si no existiese lo crearemos
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">ssh</span> <span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.101</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Una vez dentro copiamos el contenido
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#a6e22e">vagrant</span><span style="color:#f92672">:~/.</span><span style="color:#a6e22e">ssh</span><span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">nombre_pub</span><span style="color:#f92672">.</span><span style="color:#a6e22e">pub</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#a6e22e">authorized_keys</span>  
</span></span></code></pre></td></tr></table>
</div>
</div>
3. <strong>Usar el comando ssh-copy-id</strong></p>
<ul>
<li>
<p>Simplifica la configuración de claves públicas SSH al automatizar la copia y configuración.</p>
</li>
<li>
<p>Asegura que los permisos en el servidor remoto sean correctos, evitando problemas con la autenticación.</p>
</li>
<li>
<p>Si tienes varios archivos con extensión .pub en tu directorio ~/.ssh, el comando ssh-copy-id seleccionará por defecto el archivo ~/.ssh/id_rsa.pub, siempre y cuando exista.</p>
</li>
<li>
<p>No necesitas ejecutar ssh-copy-id desde el directorio $HOME. Puedes ejecutarlo desde cualquier ubicación en tu terminal. ssh-copy-id buscará automáticamente las claves públicas en el directorio ~/.ssh de tu usuario.
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span>  <span style="color:#a6e22e">ssh</span><span style="color:#f92672">-</span><span style="color:#a6e22e">copy</span><span style="color:#f92672">-</span><span style="color:#a6e22e">id</span> <span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.101</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.101</span><span style="color:#e6db74">&#39;s password:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   Number of key(s) added: 3
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Now try logging into the machine, with:   &#34;ssh &#39;</span><span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.101</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   and check to make sure that only the key(s) you wanted were added.
</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p>Después de estas acciones, podremos entrar en el servidor sin necesidad de autenticarnos
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span>  <span style="color:#a6e22e">→</span> <span style="color:#a6e22e">ssh</span> <span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">56.101</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Welcome</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">Ubuntu</span> <span style="color:#ae81ff">24.04</span> <span style="color:#a6e22e">LTS</span> (<span style="color:#a6e22e">GNU</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Linux</span> <span style="color:#ae81ff">6.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span><span style="color:#f92672">-</span><span style="color:#a6e22e">generic</span> <span style="color:#a6e22e">x86_64</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">......</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
</ul>
<h2 id="archivos-de-configuración-de-ssh">Archivos de configuración de SSH</h2>
<p>Los archivos principales de configuración de SSH están en el directorio 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    /etc/ssh


</span>
</strong>
. Algunos de los más importantes son:</p>
<ul>
<li><strong>sshd_config</strong>: Configuración del servidor SSH.</li>
<li><strong>ssh_config</strong>: Configuración del cliente SSH.</li>
<li><strong>ssh_host_rsa_key</strong>: Clave RSA privada de la máquina.</li>
<li><strong>ssh_host_rsa_key.pub</strong>: Clave RSA pública.</li>
<li><strong>~/.ssh/authorized_keys</strong>: Claves públicas autorizadas del usuario.</li>
</ul>
<h3 id="parámetros-importantes-de-configuración">Parámetros importantes de configuración</h3>
<p>Algunos parámetros relevantes del archivo 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    sshd_config


</span>
</strong>
 son:</p>
<ul>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Port


</span>
</strong>
: Puerto de escucha (por defecto, 22).</li>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    PermitRootLogin


</span>
</strong>
: Permitir o no conexiones como root.</li>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    AllowUsers


</span>
</strong>
: Usuarios autorizados para conectarse.</li>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    X11Forwarding


</span>
</strong>
: Permitir ejecución de aplicaciones gráficas.</li>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    PasswordAuthentication


</span>
</strong>
: Permitir o no authenticación con password.</li>
<li></li>
</ul>
<h3 id="permitir-o-denegar-el-acceso-con-password">Permitir o denegar el acceso con password</h3>
<p>El parámetro 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    PasswordAuthentication


</span>
</strong>
 es crítico para definir si los usuarios pueden autenticarse mediante contraseñas.</p>
<ul>
<li><strong>Ejemplo para deshabilitar autenticación por contraseña</strong>:
En el archivo 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    /etc/ssh/sshd_config


</span>
</strong>
 o en un archivo modular (como 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    /etc/ssh/sshd_config.d/50-cloud-init.conf


</span>
</strong>
), añade o modifica la línea:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">PasswordAuthentication</span> <span style="color:#a6e22e">no</span><span style="color:#f92672">|</span><span style="color:#a6e22e">yes</span>  
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Fichero Modular</h4>

    Si usas un archivo modular como <strong>50-cloud-init.conf</strong> los valores definidos allí tendrán prioridad sobre el archivo principal <strong>sshd_config</strong>.

</div>

<h3 id="especificando-un-puerto-diferente">Especificando un puerto diferente</h3>
<p>Para configurar un puerto distinto por el que el servidor ssh esté escuchando, podificamos esta directiva en el fichero de configuración:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">Port</span> <span style="color:#ae81ff">2222</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>Si el servidor usa un puerto diferente al predeterminado, añade el parámetro

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    -p


</span>
</strong>
.<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>ssh -p puerto usuario@host</span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>En nuestro caso tenemos dos circunstancias posibles, ya que accedemos desde el anfitrión</p>
<ul>
<li>Que hagamos un forward del puerto del anfitrión al puerto 22 de la máquina virtual.</li>
</ul>
<blockquote>
<p>Establecemos forward en el VagrantFile de nuestra configuración de virtualización
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">Vagrant</span><span style="color:#f92672">.</span><span style="color:#a6e22e">configure</span>(<span style="color:#e6db74">&#34;2&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span><span style="color:#a6e22e">config</span><span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">vm</span><span style="color:#f92672">.</span><span style="color:#a6e22e">box</span> <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bento/ubuntu-24.04&#34;</span>
</span></span><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">vm</span><span style="color:#f92672">.</span><span style="color:#a6e22e">network</span> <span style="color:#e6db74">&#34;forwarded_port&#34;</span>, <span style="color:#a6e22e">guest</span><span style="color:#f92672">:</span><span style="color:#ae81ff">22</span>,  <span style="color:#a6e22e">host</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2222</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">vm</span><span style="color:#f92672">.</span><span style="color:#a6e22e">network</span> <span style="color:#e6db74">&#34;private_network&#34;</span>, <span style="color:#a6e22e">ip</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;192.168.56.101&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> 
</span></span></code></pre></td></tr></table>
</div>
</div>
Ahora recargamos la máquina
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">vagrant</span> <span style="color:#a6e22e">reload</span></span></span></code></pre></td></tr></table>
</div>
</div>
Y para conectarnos especificamos el puerto a través de localhost
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">vagrant</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">p</span> <span style="color:#ae81ff">2222</span> <span style="color:#a6e22e">vagrant</span><span style="color:#f92672">@</span><span style="color:#a6e22e">localhost</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</blockquote>
<ul>
<li>Que el servidor ssh esté configurado para escuchar por otro puerto</li>
</ul>
<blockquote>
<p>En este caso tenemos que modificar parámetros de configuración en el servidor</p>
</blockquote>
<h2 id="conexión-gráfica-con-x11forwarding">Conexión gráfica con X11Forwarding</h2>
<p>Habilita la opción 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    X11Forwarding yes


</span>
</strong>
 en los archivos de configuración del cliente y servidor. Luego, conéctate utilizando:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>ssh -X usuario@máquina</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Ejecuta una aplicación gráfica como xclock para verificar.</p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="transferencia-de-archivos-con-scp">Transferencia de archivos con SCP</h2>
<p>Para copiar archivos de cliente a servidor o viceversa:</p>
<ul>
<li>
<p>Copiar un archivo al servidor:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>scp archivo_local usuario@máquina:archivo_remoto</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p>Copiar un archivo desde el servidor:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>scp usuario@máquina:archivo_remoto archivo_local</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
</ul>


<div class="alert alert-red" role="alert">
<h4 class="alert-heading">Seguridad</h4>

    <p>Nunca permitas conexiones como root directamente desde SSH</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">PermitRootLogin</span> <span style="color:#a6e22e">no</span></span></span></code></pre></td></tr></table>
</div>
</div>

</div>

<h3 id="rsync-y-ssh">rsync y ssh</h3>
<p>

<div class="alert alert-blue" role="alert">
<h4 class="alert-heading">Importante</h4>

    <p><code>rsync</code> y <code>ssh</code> trabajan juntos para realizar transferencias seguras de archivos.
<strong>rsync</strong> es una herramienta <em>para copiar archivos</em>, pero su funcionalidad principal radica en <strong>sincronizar directorios y archivos</strong>.
Esto incluye la capacidad de copiar solo los archivos modificados o de sincronizar datos de manera eficiente entre ubicaciones.</p>
<p><strong>rsync</strong> Usa el parámetro <code>-e</code> para especificar <code>ssh</code> como transporte:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>rsync -avz -e ssh /ruta/origen usuario@host:/ruta/destino</span></span></code></pre></td></tr></table>
</div>
</div>


</div>

Se puede usar para realizar despliegues. Por ejemplo estos apuntes los genero en local y voy realizando subidas cada vez que hago cambios, subiendo solo los ficheros modificados
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">rsync</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">avz</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">e</span> <span style="color:#e6db74">&#34;ssh -p 22123&#34;</span> <span style="color:#f92672">./</span><span style="color:#66d9ef">public</span><span style="color:#f92672">/</span> <span style="color:#a6e22e">admin</span><span style="color:#f92672">@</span><span style="color:#a6e22e">web</span><span style="color:#f92672">.</span><span style="color:#a6e22e">infenlaces</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">:</span><span style="color:#a6e22e">web</span><span style="color:#f92672">/</span><span style="color:#a6e22e">web</span><span style="color:#f92672">.</span><span style="color:#a6e22e">infenlaces</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">public_html</span><span style="color:#f92672">/</span><span style="color:#a6e22e">servicios</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>Aquí una tabla con opciones para su uso (sacada de <a href="https://www.linuxtotal.com.mx/index.php?cont=rsync-manual-de-uso">https://www.linuxtotal.com.mx/index.php?cont=rsync-manual-de-uso</a>)</p>
<table>
<thead>
<tr>
<th><strong>Opción Corta</strong></th>
<th><strong>Opción Larga</strong></th>
<th><strong>Descripción</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>&ndash;archive</td>
<td>Modo archive, es igual a indicar las opciones r, l, p, t, g, o y D.</td>
</tr>
<tr>
<td>-r</td>
<td>&ndash;recursive</td>
<td>Recursivo, copia recursivamente los directorios.</td>
</tr>
<tr>
<td>-l</td>
<td>&ndash;links</td>
<td>Cuando encuentra symlinks (enlaces simbólicos), estos son recreados en el destino.</td>
</tr>
<tr>
<td>-p</td>
<td>&ndash;perms</td>
<td>Opción que causa en el destino establecer los permisos igual que en el origen.</td>
</tr>
<tr>
<td>-t</td>
<td>&ndash;times</td>
<td>Transfiere los tiempos de los archivos (atime, ctime, mtime) al destino.</td>
</tr>
<tr>
<td>-g</td>
<td>&ndash;group</td>
<td>Establece en el destino que el grupo del archivo copiado sea igual que el origen.</td>
</tr>
<tr>
<td>-o</td>
<td>&ndash;owner</td>
<td>Establece en el destino que el propietario del archivo copiado sea igual que el origen.</td>
</tr>
<tr>
<td>-D</td>
<td></td>
<td>Esto es igual que indicar las opciones &ndash;devices y &ndash;specials.</td>
</tr>
<tr>
<td></td>
<td>&ndash;exclude PATTERN</td>
<td>Excluye archivos que igualan el patrón o pattern indicado.</td>
</tr>
<tr>
<td></td>
<td>&ndash;include PATTERN</td>
<td>Incluye archivos que igualan el patrón o pattern indicado.</td>
</tr>
<tr>
<td></td>
<td>&ndash;devices</td>
<td>Transfiere archivos de dispositivos de bloque y caracter al destino donde son recreados. Esto solo puede suceder si en el destino se tienen permisos de root.</td>
</tr>
<tr>
<td></td>
<td>&ndash;specials</td>
<td>Transfiere archivos especiales como fifos y named sockets.</td>
</tr>
<tr>
<td></td>
<td>&ndash;version</td>
<td>Indica el número de versión de rsync.</td>
</tr>
<tr>
<td>-v</td>
<td>&ndash;verbose</td>
<td>Incrementa la cantidad de información que se informa durante la transferencia o copia de archivos. Es la opción contraria a &ndash;quiet.</td>
</tr>
<tr>
<td>-q</td>
<td>&ndash;quiet</td>
<td>Decrementa la cantidad de información que se informa durante la transferencia o copia de archivos. Generalmente se utiliza cuando rsync se utiliza en una tarea cron.</td>
</tr>
<tr>
<td>-I</td>
<td>&ndash;ignore-times</td>
<td>Ignora los tiempos de los archivos y copia todos los archivos, incluso si son iguales en términos de tiempo y tamaño.</td>
</tr>
<tr>
<td></td>
<td>&ndash;size-only</td>
<td>Ignora los tiempos de los archivos y transfiere cualquiera con un tamaño distinto en el destino.</td>
</tr>
<tr>
<td>-n</td>
<td>&ndash;dry-run</td>
<td>Realiza una prueba de lo que ocurrirá sin realizar cambios. Generalmente se usa junto con &ndash;verbose y &ndash;itemize-changes.</td>
</tr>
<tr>
<td>-i</td>
<td>&ndash;itemize-changes</td>
<td>Reporta una lista de los cambios realizados en cada archivo, incluidos cambios en sus atributos.</td>
</tr>
<tr>
<td></td>
<td>&ndash;remove-source-files</td>
<td>Remueve los archivos en el origen (no directorios) si en el destino fueron exitosamente duplicados o copiados.</td>
</tr>
<tr>
<td></td>
<td>&ndash;timeout=TIEMPO</td>
<td>Especifica un timeout en segundos. Si no hay datos transferidos en ese tiempo, rsync terminará.</td>
</tr>
<tr>
<td></td>
<td>&ndash;log-file=ARCHIVO</td>
<td>Guarda en un archivo lo que se ha realizado.</td>
</tr>
<tr>
<td></td>
<td>&ndash;stats</td>
<td>Imprime un conjunto informativo de datos estadísticos sobre la transferencia realizada.</td>
</tr>
<tr>
<td></td>
<td>&ndash;progress</td>
<td>Muestra el avance o progreso de los archivos que están siendo transferidos.</td>
</tr>
<tr>
<td></td>
<td>&ndash;bwlimit=KBPS</td>
<td>Establece un límite de transferencia en kilobytes por segundo. Por defecto es 0 (sin límite).</td>
</tr>
<tr>
<td></td>
<td>&ndash;max-size=TAMAÑO</td>
<td>No transfiere archivos más grandes que el tamaño indicado.</td>
</tr>
<tr>
<td></td>
<td>&ndash;min-size=TAMAÑO</td>
<td>No transfiere archivos más pequeños que el tamaño indicado.</td>
</tr>
<tr>
<td>-z</td>
<td>&ndash;compress</td>
<td>Comprime datos durante la transferencia.</td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo de uso</strong>:</p>
<ul>
<li>Sincronizar archivos locales con un servidor remoto.</li>
<li>Configurar claves SSH para evitar ingresar la contraseña en cada transferencia.</li>
</ul>
<hr>
<h3 id="conexiones-desde-un-edi">Conexiones desde un EDI</h3>
<p><div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="icono-edi.png" aria-hidden="true"></i>
    
    <strong>EDI y conexiones SSH</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>Un EDI (Entorno de Desarrollo Integrado) como Visual Studio Code, PHPStorm o IntelliJ, permite conexiones directas a servidores mediante SSH.</li>
        
        
        
      </ul>
  </div>
</div>
Ejemplo con phpstorm tenemos la opción en <em><strong>Tools=&gt;Deployment=&gt;Browse Remote Host</strong></em></p>
<p><img alt="img.png" src="/servicios/es/docs/03_ssh/img.png"></p>
<p>Entonces nos saldrá el menú de conexión:</p>
<p><img alt="img_1.png" src="/servicios/es/docs/03_ssh/img_1.png"></p>
<p>Ahora podemos poner un nombre a nuestra conexión, y estableceremos la conexión por ssh (spft)
<img alt="img_2.png" src="/servicios/es/docs/03_ssh/img_2.png"></p>
<p>En el menú siguiente podremos establecer los parámetros de conexión , el servidor, usuario, credenciales, que podremos establecer por password o por pareja de claves</p>
<hr>
<h3 id="hahahugoshortcode12s74hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Creación de un túnel


</span>
</strong>
</h3>
<p>Para crear un túnel SSH y redirigir puertos locales o remotos:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>ssh -L puerto_local:host_remoto:puerto_remoto usuario@servidor</span></span></code></pre></td></tr></table>
</div>
</div></p>
<p><strong>Ejemplo práctico</strong>:</p>
<ul>
<li>Redirigir el puerto de una base de datos remota a un puerto local:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>ssh -L 5432:localhost:5432 usuario@servidor</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr style="border-color: red; border-width: 3px;"/>
<hr>
<h3 id="hahahugoshortcode12s78hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Practicando con Hestia


</span>
</strong>
</h3>
<hr>
<h3 id="hahahugoshortcode12s79hbhb">

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    SFTP


</span>
</strong>
</h3>


<div class="alert alert-yellow" role="alert">
<h4 class="alert-heading">Nota</h4>

    SFTP (SSH File Transfer Protocol) permite transferir archivos de forma segura mediante SSH.

</div>

<p><strong>Cómo usar SFTP</strong>:</p>
<ol>
<li>Conéctate usando:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#3c3d38"><span>sftp usuario@servidor</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>Comandos básicos:
<ul>
<li><code>put</code>: Subir archivos.</li>
<li><code>get</code>: Descargar archivos.</li>
<li><code>ls</code>: Listar contenido del directorio remoto.</li>
</ul>
</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c03644e270700c618778d25f9cdeb686">4 - Servidor DNS con BIND</h1>
    <div class="lead">Instalación y configuración de un servidor DNS utilizando BIND9 para la resolución de nombres en red local.</div>
	




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Qué veremos aquí</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Concepto de DNS</li>
            
            <li>Instalación de servicio o aplicación Bind</li>
            
            <li>Configuración</li>
            
            <li>Puesta en marcha y uso </li>
            
            
            
        </ul>
    </div>
    


</div>

<hr style="border-color: red; border-width: 3px;"/>




<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias DNS</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Documentación Oficial y Recursos</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><ul>
<li><a href="https://www.isc.org/bind/">Documentación oficial de BIND9</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc1034">RFC 1034 - Domain Names - Concepts and Facilities</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc1035">RFC 1035 - Domain Names - Implementation and Specification</a></li>
</ul>
</li>
            
            <li></li>
            
            
        </ul>
    </div>
</div>

<hr style="border-color: red; border-width: 3px;"/>
<h1 id="introducción-al-servicio-dns">Introducción al Servicio DNS</h1>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-book" aria-hidden="true"></i>
    
    <strong>DNS</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>El Sistema de Nombres de Dominio (DNS) es un servicio fundamental en Internet.   </li>
        
        <li>Corresponde a la capa de aplicación y tiene asociado el puerto  52.</li>
        
        <li>Traduce nombres de dominio legibles por humanos en direcciones IP que las máquinas pueden entender y procesar.</li>
        
        
        
      </ul>
  </div>
</div>
<h2 id="conceptos-básicos-de-dns">Conceptos Básicos de DNS</h2>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Componentes principales</h4>

    <ul>
<li><strong>Servidor DNS</strong>: Software que responde a las consultas de resolución de nombres</li>
<li><strong>Registros DNS</strong>: Entradas que asocian nombres con direcciones IP u otros datos</li>
<li><strong>Zonas DNS</strong>: Porciones del espacio de nombres de dominio</li>
<li><strong>Cache DNS</strong>: Almacenamiento temporal de resoluciones previas</li>
</ul>


</div>

<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Protocolos de capa inferior


</span>
</strong>

DNS utiliza de capas inferiores principalmente UDP, pero también puede usar TCP:</p>
<ul>
<li><strong>Puerto 53 (UDP y TCP)</strong> → Se usa para resolver nombres de dominio en direcciones IP.</li>
<li><strong>UDP 53</strong> → Se utiliza principalmente para consultas normales de DNS porque es más rápido y eficiente.</li>
<li><strong>TCP 53</strong> → Se usa cuando la respuesta es demasiado grande para caber en un paquete UDP o para operaciones más seguras como transferencias de zona (AXFR/IXFR).</li>
</ul>
<h2 id="bind-berkeley-internet-name-domain">BIND (Berkeley Internet Name Domain)</h2>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    BIND


</span>
</strong>
 es el servidor (aplicación que instalaremos) DNS más utilizado en Internet, especialmente en sistemas Unix/Linux. Proporciona una implementación completa del protocolo DNS.
Bind9, implementa el protocolo DNS.</p>
<p>Basa su funcionamiento en 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    un  sistema de nombres jerárquico


</span>
</strong>
 (vs espacio de nombre planos, que tenemos en el fichero hosts, inmanejable dado el tamaño de internet), que  

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    tiene estructura de árbol


</span>
</strong>
 de forma que cada nodo del árbol tiene un significado.</p>
<table>
<thead>
<tr>
<th>Objetivo</th>
<th>Sistema jerarquizado</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="img_1.png" src="/servicios/es/docs/04_dns/img_1.png"></td>
<td><img alt="img.png" src="/servicios/es/docs/04_dns/img.png"></td>
</tr>
</tbody>
</table>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    El sistema de nombres de dominio


</span>
</strong>
es un sistema de nombres jerárquico y distribuido.</p>
<p>La estructura del sistema de nombres de dominio en una estructura en forma de árbol. Cada nodo del árbol se llama 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    nombre de dominio


</span>
</strong>
 y consiste en una etiqueta de hastac    63 caracteres.


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">estructura del árbol</h4>

    <ul>
<li>La raíz del árbol siempre es un <strong>PUNTO</strong>.</li>
<li>A la etiqueta de segundo nivel se le llama dominio de nivel superior o <strong>Top Level Domain (TLD)</strong>.</li>
<li><strong>El extremo de la bifurcación se denomina host</strong> y corresponde a un equipo en la red.</li>
</ul>


</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">FQDN</h4>

    <p><strong>FQDN (Nombre de Dominio totalmente calificado)</strong>  es la dirección que corresponde con todas las etiquetas de nodo de una estructura arbórea, separadas por puntos y que termina con un punto final.</p>
<p>La profundidad máxima de una estructura arbórea es 127 niveles y la longitud máxima para un nombre FQDN es 255 caracteres.</p>


</div>

<img alt="img_3.png" src="/servicios/es/docs/04_dns/img_3.png"></p>
<hr style="border-color: red; border-width: 3px;"/>
<p><img alt="img_4.png" src="/servicios/es/docs/04_dns/img_4.png"></p>
<p>Por ejemplo el espacio de nombres de los ficheros en disco (se pueden crear ficheros con el mismo nombre siempre que estén en otra carpeta)
A continuación vamos a proceder a instalarlo y configurarlo</p>
<p><strong>El Centro de Información de la Red Internet (Internet Network Information Center)</strong> 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    administra


</span>
</strong>
 la raíz de la base de datos DNS en Internet.</p>
<p>Los dominios superiores se han asignado a organizaciones y países. Estos nombres de dominio siguen un estándar internacional. Para los países se usan abreviaturas de dos y de tres letras (es, it, de…), y se han reservado varias abreviaturas para que las usen las organizaciones, como se muestra en los siguientes ejemplos:</p>
<p><img alt="img_5.png" src="/servicios/es/docs/04_dns/img_5.png"></p>
<h2 id="resolución-de-nombres-de-dominio">Resolución de nombres de dominio</h2>
<p>La estructura del árbol, ya comentada anteriormente,está fomrada por nodos interconectos</p>
<p><div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-network-wired" aria-hidden="true"></i>
    
    <strong>Dominio</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>Cada nodo del árbol de una base de datos DNS, junto con todos los nodos por debajo del mismo</li>
        
        
        <li>Los dominios pueden contener host (equipos) y otros dominios (subdominios).</li>
        
        
        
      </ul>
  </div>
</div>
Por ejemplo, el dominio Midominio (midominio.com), podría contener a la vez equipos, como host.midominio.com, y subdominios, como subdom.midominio.com, que a su vez podría contener host, como por ejemplo host.subdom.midominio.com.</p>
<hr style="border-color: red; border-width: 3px;"/>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-server" aria-hidden="true"></i>
    
    <strong>Servidores de nombres de dominio</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>Equipos  que permiten establecer la relación entre los nombres de dominio y las direcciones IP de los equipos de una red.</li>
        
        
        
      </ul>
  </div>
</div>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    El sistema de servidores de nombres de dominio


</span>
</strong>
 es una <strong>arquitectura jeráquica y distribuida</strong>, y permite su administración descentralizada mediante la delegación de dominios. Es decir como no habría un ordenador tan potente como para traducir todos los nombres de todos los ordenadores de Internet, lo que se hizo es que existen <strong>varios servidores DNS</strong> que trabajan de forma <em>jerárquica y delegándose tareas unos en otros</em>.  Cada  servidor DNS almacena información acerca de algunas partes del espacio de nombres del dominio. Cada una de esas partes se llama zona. <strong>Se dice el servidor DNS tiene autoridad sobre una o varias zonas</strong>.
<img alt="img_6.png" src="/servicios/es/docs/04_dns/img_6.png"></p>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-exchange-alt" aria-hidden="true"></i>
    
    <strong>Delegacion de dominios</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>La delegación de dominios es el proceso mediante el cual un servidor de nombres de dominio (DNS) transfiere la autoridad de resolución de una parte de un dominio (una zona DNS) a otro servidor.</li>
        
        
        <li>Esto permite dividir un dominio en subdominios y asignar su gestión a servidores diferentes, manteniendo una estructura jerárquica y distribuida.</li>
        
        
        
      </ul>
  </div>
</div>
<p><img alt="img_7.png" src="/servicios/es/docs/04_dns/img_7.png"></p>
<hr style="border-color: red; border-width: 3px;"/>
<p><img alt="img_8.png" src="/servicios/es/docs/04_dns/img_8.png"></p>
<hr style="border-color: red; border-width: 3px;"/>
<p><img alt="img_9.png" src="/servicios/es/docs/04_dns/img_9.png"></p>
<hr style="border-color: red; border-width: 3px;"/>
<p>Los servidores relacionados con <strong>los dominios de nivel superior (TLD)</strong> se llaman 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    servidores de dominio de nivel superior


</span>
</strong>
.
Son <strong>13</strong>, están distribuidos por todo el mundo y sus nombres van desde 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    a.root-servers.net


</span>
</strong>
 hasta 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    m.root-servers.net


</span>
</strong>
.</p>
<p><img alt="img_10.png" src="/servicios/es/docs/04_dns/img_10.png"></p>
<h3 id="clasificación-de-tipos-de-serividores-dns">Clasificación de tipos de serividores DNS</h3>
<p>Hay 3 tipos de servidores DNS.</p>
<ul>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Servidores primarios (maestros)


</span>
</strong>
</li>
</ul>
<blockquote>
<p>La información de una zona la obtienen de sus archivos locales. Todas las modificaciones sobre una zona (añadir dominios, modificarlos, etc) se llevan a cabo en el servidor primario.</p>
</blockquote>
<ul>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Servidores secundarios (esclavos)


</span>
</strong>
</li>
</ul>
<blockquote>
<p>Contiene una copia de sólo lectura de los archivos de zona de los servidores maestros con autoridad sobre esas zonas.</p>
</blockquote>
<blockquote>
<p>Cuando la información del servidor primario cambia, el esclavo la copia para actualizarse. Al proceso mediante el cual se obtiene información actualizada de la zona a través de internet se le llama “transferencia de zona”.</p>
</blockquote>
<ul>
<li>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Servidores caché


</span>
</strong>
</li>
</ul>
<blockquote>
<p>Cuando se les hace una consulta, si no tiene la respuesta, la reenvían a los servidores que puedan responder. Al recibir la respuesta la almacenan en caché para poder usarla en sucesivas peticiones.</p>
</blockquote>
<blockquote>
<p>Si se almacena la información en el servidor caché por mucho tiempo, la info puede estar desactualizada, pero si se almacena muy poco tiempo, mayor carga para el sevidor de nombres. Hay que mirar lo que sea mejor para cada caso. Esto es el TTL o Time To Live (Tiempo de vida).</p>
</blockquote>
<h3 id="proceso-de-resolución-de-un-nombre-de-dominio">Proceso de resolución de un nombre de dominio</h3>
<p>El proceso de resolución de un nombre de dominio sigue una serie de pasos estructurados que permiten encontrar la dirección IP asociada a un dominio.</p>
<h4 id="1-consulta-al-archivo-de-hosts-local">1. Consulta al archivo de hosts local</h4>
<p>El sistema operativo primero busca el nombre de dominio en el archivo de configuración local:</p>
<ul>
<li>En <strong>Linux/macOS</strong>: <code>/etc/hosts</code></li>
<li>En <strong>Windows</strong>: <code>C:\Windows\System32\drivers\etc\hosts</code></li>
</ul>
<blockquote>
<p>Si el dominio se encuentra en este archivo, se usa la dirección IP correspondiente y el proceso termina aquí.</p>
</blockquote>
<h4 id="2-consulta-a-la-caché-del-sistema-y-del-navegador">2. Consulta a la caché del sistema y del navegador</h4>
<p>Si el dominio no está en el archivo <code>hosts</code>, el sistema verifica su <strong>caché DNS local</strong>, en el caso de que  la dirección se haya resuelto recientemente, estará aquí.</p>
<ul>
<li>El navegador suele tener  su propia caché DNS, que puede evitar consultas adicionales al sistema operativo.</li>
<li>El sistema operativo también mantiene una caché DNS local (ejemplo: systemd-resolved en Linux, dnscache en .</li>
</ul>
<blockquote>
<p>Si alguna caché contiene la respuesta, el proceso finaliza aquí.</p>
</blockquote>
<h4 id="3-consulta-al-servidor-dns-configurado">3. Consulta al servidor DNS configurado</h4>
<p>Si el dominio no está en la caché, el sistema consulta el <strong>servidor DNS configurado</strong> (normalmente el del proveedor de Internet o un DNS público como Google <code>8.8.8.8</code> o Cloudflare <code>1.1.1.1</code>), pero también podría ser un servidor interno.</p>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    El servidor DNS puede actuar de tres maneras:


</span>
</strong>

<ol>
<li><strong>Responder con la dirección IP</strong> si la tiene almacenada en su caché.</li>
<li><strong>Delegar la consulta</strong> a otro servidor DNS si no tiene la información.</li>
<li><strong>Realizar una consulta recursiva</strong> para encontrar la respuesta.</li>
</ol>
<h4 id="4-resolución-jerárquica-en-los-servidores-dns">4. Resolución jerárquica en los servidores DNS</h4>
<p>Si el servidor DNS consultado no conoce la dirección, sigue el <strong>modelo jerárquico de DNS</strong>:</p>
<ol>
<li><strong>Servidor raíz (Root DNS)</strong> → Responde con la dirección de los servidores de dominio de nivel superior (TLD, como <code>.com</code>, <code>.org</code>, <code>.es</code>).</li>
<li><strong>Servidor TLD</strong> → Responde con la dirección del servidor autoritativo del dominio solicitado.</li>
<li><strong>Servidor autoritativo</strong> → Contiene la información definitiva sobre el dominio y devuelve la dirección IP.</li>
</ol>
<p><strong>Una vez encontrada la dirección, se envía al usuario y se almacena en caché para futuras consultas.</strong></p>
<h3 id="ejecución-iterativa-o-jerarquica-vs-recursiva">Ejecución iterativa o jerarquica Vs recursiva</h3>
<p>Existen <strong>dos tipos de resolución DNS principales</strong>: <strong>iterativa (jerárquica)</strong> y <strong>recursiva</strong>, que quedan establecidas en los puntos 3 y 4 anteriores.</p>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Resolución iterativa (jerarquizada)


</span>
</strong>

<blockquote>
<p>Este proceso se basa en que el servidor DNS <strong>no realiza la resolución completa</strong>, sino que va consultando diferentes servidores DNS en la jerarquía hasta obtener una respuesta.</p>
</blockquote>
<blockquote>
<p><img alt="img_11.png" src="/servicios/es/docs/04_dns/img_11.png"></p>
</blockquote>
<blockquote>
<ul>
<li>Flujo del proceso iterativo:</li>
</ul>
<blockquote>
<ol>
<li><strong>El servidor DNS local consulta un servidor raíz (root DNS).</strong></li>
<li><strong>El servidor raíz responde con el servidor DNS del dominio de nivel superior (TLD, como .es, .com, .org, etc.).</strong></li>
<li><strong>El servidor DNS local consulta al servidor del TLD (por ejemplo, el DNS de <code>.es</code>).</strong></li>
<li><strong>El servidor TLD responde con la dirección del servidor DNS del dominio (por ejemplo, <code>upc.es</code>).</strong></li>
<li><strong>El servidor DNS local consulta al servidor DNS autoritativo del dominio (<code>upc.es</code>).</strong></li>
<li><strong>El servidor autoritativo devuelve la dirección IP solicitada.</strong></li>
<li><strong>El servidor inicial informa al cliente con la dirección IP encontrada.</strong></li>
</ol>
</blockquote>
</blockquote>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Importante</h4>

    En este caso, <strong>el servidor inicial (DNS local) no resuelve directamente el dominio, sino que recibe referencias hasta llegar al servidor autoritativo</strong>.

</div>



<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Resolución recursiva


</span>
</strong>

<blockquote>
<p>En este caso, el servidor DNS <strong>se encarga de resolver completamente la consulta por el cliente</strong> y solo le devuelve la dirección IP final.</p>
</blockquote>
<blockquote>
<p><img alt="img_12.png" src="/servicios/es/docs/04_dns/img_12.png"></p>
</blockquote>
<blockquote>
<ul>
<li>Flujo del proceso recursivo:</li>
</ul>
</blockquote>
<blockquote>
<blockquote>
<ol>
<li><strong>El cliente (host) consulta su servidor DNS configurado.</strong></li>
<li><strong>Este servidor DNS consulta a un servidor raíz para obtener la información.</strong></li>
<li><strong>El servidor raíz responde con la dirección del servidor TLD (<code>.es</code>).</strong></li>
<li><strong>El servidor DNS consulta al TLD y obtiene la dirección del servidor DNS del dominio (<code>upc.es</code>).</strong></li>
<li><strong>El servidor DNS consulta al servidor autoritativo (<code>ftp.upc.es</code>) y obtiene la IP.</strong></li>
<li><strong>El servidor DNS devuelve la IP al cliente.</strong></li>
</ol>
</blockquote>
</blockquote>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Importante</h4>

    En este caso, <strong>el cliente solo pregunta una vez y el servidor DNS hace todo el trabajo de resolución hasta obtener la IP</strong>.

</div>

<hr>
<h2 id="-comparación-rápida">📊 Comparación rápida</h2>
<table>
<thead>
<tr>
<th><strong>Tipo de Resolución</strong></th>
<th><strong>Quién resuelve la consulta</strong></th>
<th><strong>Proceso</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Iterativa (jerárquica)</strong></td>
<td>El cliente DNS sigue referencias hasta obtener la respuesta.</td>
<td>El cliente pregunta a varios servidores DNS hasta llegar al autoritativo.</td>
</tr>
<tr>
<td><strong>Recursiva</strong></td>
<td>El servidor DNS configurado resuelve completamente y responde al cliente.</td>
<td>El cliente solo hace una consulta y el servidor se encarga de todo.</td>
</tr>
</tbody>
</table>
<hr>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a0beb9f7a15cf85318ae0b811f50cca3">4.1 - Instalación</h1>
    <div class="lead">Instalación y configuración de un servidor DNS utilizando BIND9 para la resolución de nombres en red local.
Fichero involucrados</div>
	




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Qué veremos aquí</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Concepto de DNS</li>
            
            <li>Instalación de servicio o aplicación Bind</li>
            
            <li>Configuración</li>
            
            <li>Puesta en marcha y uso </li>
            
            
            
        </ul>
    </div>
    


</div>

<h1 id="introducción-al-servicio-dns">Introducción al Servicio DNS</h1>
<h1 id="instalación-y-configuración">Instalación y Configuración</h1>


<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Virtualización para pruebas


</span>
</strong>

<p>Creamos un entorno para realizar pruebas y prácticas de nuestro entorno de ejecución.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-ruby" data-lang="ruby"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#66d9ef">Vagrant</span><span style="color:#f92672">.</span>configure(<span style="color:#e6db74">&#34;2&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>config<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>  config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>box <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ubuntu/focal64&#34;</span>
</span></span><span style="display:flex;"><span>  config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>hostname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dns-server&#34;</span>
</span></span><span style="display:flex;"><span>  config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>network <span style="color:#e6db74">&#34;private_network&#34;</span>, <span style="color:#e6db74">ip</span>: <span style="color:#e6db74">&#34;192.168.33.10&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span></span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="instalación-de-bind9">Instalación de BIND9</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install bind9 bind9utils bind9-doc</span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="configuración-básica">Configuración Básica</h2>
<p>Los archivos principales de configuración se encuentran en 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    /etc/bind/


</span>
</strong>
:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>/etc/bind/
</span></span><span style="display:flex;"><span>├── named.conf          # Configuración principal
</span></span><span style="display:flex;"><span>├── named.conf.local    # Zonas locales
</span></span><span style="display:flex;"><span>├── named.conf.options  # Opciones globales
</span></span><span style="display:flex;"><span>└── zones/             # Directorio para archivos de zona</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Ahora vamos comprendiendo cada uno de esos ficheros, entendiendo su funcionalidad y contenido.</p>
<h3 id="namedconf">named.conf</h3>
<p>El archivo <strong><code>named.conf</code></strong> se encuentra en <code>/etc/bind/</code> y su función principal es 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    cargar el resto de archivos de configuración


</span>
</strong>
:</p>
<ul>
<li><strong>named.conf.options</strong></li>
<li><strong>named.conf.local</strong>.</li>
</ul>
<hr style="border-color: red; border-width: 3px;"/>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Ejemplo de named.conf


</span>
</strong>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>include &#34;/etc/bind/named.conf.options&#34;;  # Configuración global
</span></span><span style="display:flex;"><span>include &#34;/etc/bind/named.conf.local&#34;;    # Configuración de zonas</span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="2-configuración-de-opciones-globales-namedconfoptions"><strong>2. Configuración de Opciones Globales (<code>named.conf.options</code>)</strong></h2>
<p>El archivo <strong><code>named.conf.options</code></strong> define las opciones globales del servidor DNS, como el comportamiento de recursión, los permisos de consulta y los mecanismos de seguridad.</p>
<p>La principales directivas de  <strong>named.conf.options</strong></p>
<blockquote>
<ul>
<li><strong><code>directory</code></strong></li>
</ul>
<blockquote>
<p>Define el directorio donde se almacenan los archivos del servidor DNS.
Importante para saber dónde se ubican los ficheros de zonas</p>
</blockquote>
<ul>
<li><strong><code>listen-on</code></strong></li>
</ul>
<blockquote>
<p>Especifica en qué interfaces IP el servidor DNS escucha peticiones.
Esta directiva es fundamental y muy importante</p>
</blockquote>
<ul>
<li><strong><code>allow-query</code></strong></li>
</ul>
<blockquote>
<p>Controla qué clientes pueden realizar consultas DNS.</p>
</blockquote>
<ul>
<li><strong><code>allow-recursion</code></strong></li>
</ul>
<blockquote>
<p>Permite definir qué clientes pueden hacer consultas recursivas.</p>
</blockquote>
<ul>
<li><strong><code>recursion</code></strong></li>
</ul>
<blockquote>
<p>Habilita o deshabilita la recursión en el servidor DNS.</p>
</blockquote>
<ul>
<li><strong><code>forwarders</code></strong></li>
</ul>
<blockquote>
<p>Especifica servidores DNS externos a los que se reenviarán las consultas.</p>
</blockquote>
<ul>
<li><strong><code>allow-transfer</code></strong></li>
</ul>
<blockquote>
<p>Determina qué servidores pueden solicitar transferencias de zona.</p>
</blockquote>
<ul>
<li><strong><code>dnssec-validation</code></strong></li>
</ul>
<blockquote>
<p>Controla la validación de DNSSEC para la seguridad de las respuestas.</p>
</blockquote>
<ul>
<li><strong><code>max-cache-size</code></strong></li>
</ul>
<blockquote>
<p>Establece un límite en el tamaño de la caché de consultas DNS.</p>
</blockquote>
<ul>
<li><strong><code>max-clients-per-query</code></strong></li>
</ul>
<blockquote>
<p>Define el número máximo de clientes que pueden realizar una consulta simultáneamente.</p>
</blockquote>
<ul>
<li><strong><code>rate-limit</code></strong></li>
</ul>
<blockquote>
<p>Configura restricciones en la frecuencia de respuestas a consultas para mitigar ataques.</p>
</blockquote>
</blockquote>
<details>
    <summary>Directivas importantes</summary>
    <div class="solution-content">
<ul>
<li>
<p><strong>listen-on</strong> → Para que el DNS escuche en la IP de la VM.</ol></p>
</li>
<li>
<p><strong>allow-query</strong> → Para permitir consultas desde la red privada de Vagrant.</p>
</li>
<li>
<p><strong>allow-recursion</strong> → Para permitir que la VM haga consultas recursivas.</p>
</li>
<li>
<p><strong>recursion</strong> → Si queremos que el servidor resuelva nombres fuera de su zona.</p>
</li>
<li>
<p><strong>forwarders</strong> → Para reenviar consultas a servidores externos si es necesario.</p>
</li>
<li>
<p><strong>directory</strong> → Para definir la ubicación de los archivos de zona.</p>
</li>
</ul>
</details>
<style>
    .solution-content {
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-top: 5px;
        background-color: #f9f9f9;
    }
    summary {
        cursor: pointer;
        font-weight: bold;
        color: #0073e6;
    }
</style>
<hr style="border-color: red; border-width: 3px;"/>
<hr style="border-color: red; border-width: 3px;"/>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Ejemplo de configuración en <code>named.conf.options</code>


</span>
</strong>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>options {
</span></span><span style="display:flex;"><span>    directory &#34;/var/cache/bind&#34;;
</span></span><span style="display:flex;"><span>    recursion yes;
</span></span><span style="display:flex;"><span>    allow-recursion { localhost; 192.168.33.0/24; };
</span></span><span style="display:flex;"><span>    listen-on { 192.168.33.10; };
</span></span><span style="display:flex;"><span>    allow-transfer { none; };
</span></span><span style="display:flex;"><span>    dnssec-validation auto;
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="3-configuración-de-zonas-locales-namedconflocal"><strong>3. Configuración de Zonas Locales (<code>named.conf.local</code>)</strong></h2>
<p>El archivo <strong><code>named.conf.local</code></strong> se utiliza para definir las zonas locales del servidor DNS. Aquí es donde se configuran los dominios específicos que el servidor gestionará.</p>
<h3 id="directivas-principales-en-namedconflocal"><strong>Directivas principales en <code>named.conf.local</code></strong></h3>
<blockquote>
<ul>
<li><strong><code>zone</code></strong></li>
</ul>
<blockquote>
<p>Define una zona DNS y su configuración.</p>
</blockquote>
<ul>
<li><strong><code>type</code></strong></li>
</ul>
<blockquote>
<p>Especifica si la zona es <strong>maestra</strong>, <strong>esclava</strong> o <strong>reenviadora</strong>.</p>
</blockquote>
<ul>
<li><strong><code>file</code></strong></li>
</ul>
<blockquote>
<p>Indica el archivo donde se almacena la configuración de la zona.</p>
</blockquote>
<ul>
<li><strong><code>allow-update</code></strong></li>
</ul>
<blockquote>
<p>Controla qué servidores pueden actualizar dinámicamente la zona.</p>
</blockquote>
<ul>
<li><strong><code>allow-transfer</code></strong></li>
</ul>
<blockquote>
<p>Especifica qué servidores pueden recibir transferencias de zona.</p>
</blockquote>
<ul>
<li><strong><code>masters</code></strong></li>
</ul>
<blockquote>
<p>En zonas esclavas, indica los servidores maestros autorizados.</p>
</blockquote>
<ul>
<li><strong><code>forwarders</code></strong></li>
</ul>
<blockquote>
<p>Define servidores a los que se reenviarán consultas de esta zona específica.</p>
</blockquote>
<ul>
<li><strong><code>check-names</code></strong></li>
</ul>
<blockquote>
<p>Determina si los nombres de la zona deben cumplir con los estándares DNS.</p>
</blockquote>
<ul>
<li><strong><code>notify</code></strong></li>
</ul>
<blockquote>
<p>Indica si el servidor debe notificar cambios a los secundarios.</p>
</blockquote>
</blockquote>
<hr style="border-color: red; border-width: 3px;"/>
<p>

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    Ejemplo de configuración en <code>named.conf.local</code>


</span>
</strong>

<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>    zone &#34;inf.com&#34; {
</span></span><span style="display:flex;"><span>    type master;
</span></span><span style="display:flex;"><span>    file &#34;/etc/bind/zones/db.inf.com&#34;;
</span></span><span style="display:flex;"><span>    allow-update { none; };
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zone &#34;33.168.192.in-addr.arpa&#34; {
</span></span><span style="display:flex;"><span>    type master;
</span></span><span style="display:flex;"><span>    file &#34;/etc/bind/zones/db.192.168.33&#34;;
</span></span><span style="display:flex;"><span>    allow-update { none; };
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr style="border-color: red; border-width: 3px;"/>
<p>Este archivo especifica qué dominios gestiona el servidor DNS y dónde se encuentran los archivos de zona asociados. Se puede definir el tipo de zona (maestra, esclava o reenviadora) y sus restricciones de actualización.</p>
<h3 id="archivo-de-zona-directa">Archivo de Zona Directa</h3>
<p>Un archivo de base de datos DNS es un <strong>archivo de zona</strong> que contiene los registros para los dominios que gestiona un servidor de nombres.</p>
<p>El archivo de zona directa debe ubicarse dentro del directorio /etc/bind/zones/ o el directorio definido en la directiva directory en named.conf.options.
Para que BIND9 utilice este archivo de zona, debe estar referenciado en named.conf.local dentro de la configuración de la zona:
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">zone</span> <span style="color:#e6db74">&#34;midominio.com&#34;</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">type</span> <span style="color:#a6e22e">master</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">file</span> <span style="color:#e6db74">&#34;/etc/bind/zones/db.midominio.com&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">update</span> { <span style="color:#a6e22e">none</span>; }; 
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h2 id="parámetros-de-configuración-y-registros-del-servidor-de-nombres"><strong>Parámetros de configuración y registros del servidor de nombres</strong></h2>
<h3 id="principales-tipos-de-registros-dns"><strong>Principales tipos de registros DNS</strong></h3>
<ul>
<li>
<p><strong>Registro SOA (Start of Authority)</strong><br>
Indica el servidor primario de la zona y parámetros de sincronización con servidores secundarios.<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#f92672">@</span>   <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">SOA</span>     <span style="color:#a6e22e">ns1</span><span style="color:#f92672">.</span><span style="color:#a6e22e">midominio</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">.</span> <span style="color:#a6e22e">admin</span><span style="color:#f92672">.</span><span style="color:#a6e22e">midominio</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">.</span> (
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2024021901</span> ; <span style="color:#a6e22e">Serial</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3600</span>       ; <span style="color:#a6e22e">Refresh</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">600</span>        ; <span style="color:#a6e22e">Retry</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">86400</span>      ; <span style="color:#a6e22e">Expire</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3600</span> )     ; <span style="color:#a6e22e">TTL</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Registro NS (Name Server)</strong><br>
Define los servidores DNS responsables de una zona.<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">midom</span><span style="color:#f92672">.</span><span style="color:#a6e22e">es</span><span style="color:#f92672">.</span>       <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">NS</span>  <span style="color:#a6e22e">ns1</span><span style="color:#f92672">.</span><span style="color:#a6e22e">midom</span><span style="color:#f92672">.</span><span style="color:#a6e22e">es</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">subdom</span><span style="color:#f92672">.</span><span style="color:#a6e22e">midom</span><span style="color:#f92672">.</span><span style="color:#a6e22e">es</span><span style="color:#f92672">.</span> <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">NS</span>  <span style="color:#a6e22e">ns</span><span style="color:#f92672">.</span><span style="color:#a6e22e">subdom</span><span style="color:#f92672">.</span><span style="color:#a6e22e">midom</span><span style="color:#f92672">.</span><span style="color:#a6e22e">es</span><span style="color:#f92672">.</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Registro A (Address Record)</strong><br>
Asocia un nombre de host con una dirección IP.<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">servidor1</span>   <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">A</span>   <span style="color:#ae81ff">192.168</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1.10</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Registro CNAME (Canonical Name)</strong><br>
Permite asignar alias a un dominio principal.<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">ftp</span>     <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">CNAME</span>  <span style="color:#a6e22e">servidorarchivos</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">www</span>     <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">CNAME</span>  <span style="color:#a6e22e">servidorarchivos</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Registro PTR (Pointer Record)</strong><br>
Se usa para la resolución inversa (de IP a nombre de dominio).<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#ae81ff">10.1</span><span style="color:#f92672">.</span><span style="color:#ae81ff">168.192</span><span style="color:#f92672">.</span><span style="color:#a6e22e">in</span><span style="color:#f92672">-</span><span style="color:#a6e22e">addr</span><span style="color:#f92672">.</span><span style="color:#a6e22e">arpa</span><span style="color:#f92672">.</span> <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">PTR</span>  <span style="color:#a6e22e">servidor1</span><span style="color:#f92672">.</span><span style="color:#a6e22e">midominio</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">.</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Registro MX (Mail Exchange)</strong><br>
Define los servidores encargados de gestionar el correo del dominio.<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">midominio</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">.</span>  <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">MX</span>  <span style="color:#ae81ff">10</span> <span style="color:#a6e22e">mail</span><span style="color:#f92672">.</span><span style="color:#a6e22e">midominio</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">midominio</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">.</span>  <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">MX</span>  <span style="color:#ae81ff">20</span> <span style="color:#a6e22e">backup</span><span style="color:#f92672">-</span><span style="color:#a6e22e">mail</span><span style="color:#f92672">.</span><span style="color:#a6e22e">midominio</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">.</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><strong>Registro SPF (Sender Policy Framework)</strong><br>
Ayuda a prevenir el spoofing de correos electrónicos indicando qué servidores están autorizados para enviar emails en nombre del dominio.<br>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#a6e22e">midominio</span><span style="color:#f92672">.</span><span style="color:#a6e22e">com</span><span style="color:#f92672">.</span>  <span style="color:#a6e22e">IN</span>  <span style="color:#a6e22e">TXT</span>  <span style="color:#e6db74">&#34;v=spf1 mx ~all&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
</ul>
<p><strong>Cada tipo de registro tiene una función específica y es fundamental en la configuración y resolución de dominios en una red.</strong></p>
<hr style="border-color: red; border-width: 3px;"/>
<h1 id="verificación-y-pruebas">Verificación y Pruebas</h1>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Comandos de Verificación</h4>

    <ul>
<li>Verificar sintaxis: <code>named-checkconf</code></li>
<li>Verificar zona: <code>named-checkzone ejemplo.local /etc/bind/zones/db.ejemplo.local</code></li>
<li>Consultar registros: <code>dig @192.168.33.10 www.ejemplo.local</code></li>
</ul>


</div>

<details>
    <summary>Ejemplo de consulta DNS exitosa</summary>
    <div class="solution-content">
        
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; @192.168.33.10 www.ejemplo.local
</span></span><span style="display:flex;"><span>; (1 server found)
</span></span><span style="display:flex;"><span>;; global options: +cmd
</span></span><span style="display:flex;"><span>;; Got answer:
</span></span><span style="display:flex;"><span>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 12345
</span></span><span style="display:flex;"><span>;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; ANSWER SECTION:
</span></span><span style="display:flex;"><span>www.ejemplo.local.    604800  IN      A       192.168.33.20</span></span></code></pre></div>


</details>

<style>
    .solution-content {
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-top: 5px;
        background-color: #f9f9f9;
    }
    summary {
        cursor: pointer;
        font-weight: bold;
        color: #0073e6;
    }
</style>

<h1 id="consideraciones-de-seguridad">Consideraciones de Seguridad</h1>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Medidas de Seguridad Importantes</h4>

    <ol>
<li>Limitar la recursión solo a redes confiables</li>
<li>Implementar DNSSEC para proteger la integridad de las respuestas</li>
<li>Mantener BIND actualizado con los últimos parches de seguridad</li>
<li>Configurar correctamente los permisos de archivos</li>
</ol>


</div>





<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias DNS</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Documentación Oficial y Recursos</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><ul>
<li><a href="https://www.isc.org/bind/">Documentación oficial de BIND9</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc1034">RFC 1034 - Domain Names - Concepts and Facilities</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc1035">RFC 1035 - Domain Names - Implementation and Specification</a></li>
</ul>
</li>
            
            
            
        </ul>
    </div>
</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-58b7419fde94cadcdd42f0085c515df7">4.2 - Configuración Avanzada de BIND</h1>
    <div class="lead">Configuraciones avanzadas de BIND9 incluyendo vistas, ACLs y DNSSEC.</div>
	<h1 id="configuración-avanzada-de-bind9">Configuración Avanzada de BIND9</h1>
<h2 id="vistas-dns-split-dns">Vistas DNS (Split DNS)</h2>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-code-branch" aria-hidden="true"></i>
    
    <strong>Split DNS</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>Split DNS permite servir diferentes respuestas DNS según el origen de la consulta, útil para separar resolución interna y externa.</li>
        
        
        
      </ul>
  </div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>view &#34;internal&#34; {
</span></span><span style="display:flex;"><span>    match-clients { 192.168.33.0/24; localhost; };
</span></span><span style="display:flex;"><span>    zone &#34;ejemplo.local&#34; {
</span></span><span style="display:flex;"><span>        type master;
</span></span><span style="display:flex;"><span>        file &#34;/etc/bind/zones/internal/db.ejemplo.local&#34;;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>view &#34;external&#34; {
</span></span><span style="display:flex;"><span>    match-clients { any; };
</span></span><span style="display:flex;"><span>    zone &#34;ejemplo.local&#34; {
</span></span><span style="display:flex;"><span>        type master;
</span></span><span style="display:flex;"><span>        file &#34;/etc/bind/zones/external/db.ejemplo.local&#34;;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="configuración-de-acls">Configuración de ACLs</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>acl &#34;trusted&#34; {
</span></span><span style="display:flex;"><span>    192.168.33.0/24;    # Red local
</span></span><span style="display:flex;"><span>    localhost;          # Servidor local
</span></span><span style="display:flex;"><span>    localnets;         # Redes locales
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>options {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    allow-query { trusted; };
</span></span><span style="display:flex;"><span>    allow-recursion { trusted; };
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="implementación-de-dnssec">Implementación de DNSSEC</h2>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Importante</h4>

    DNSSEC añade firmas digitales a los registros DNS para garantizar su autenticidad.

</div>

<h3 id="generación-de-claves">Generación de Claves</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Generar clave ZSK (Zone Signing Key)</span>
</span></span><span style="display:flex;"><span>dnssec-keygen -a NSEC3RSASHA1 -b <span style="color:#ae81ff">2048</span> -n ZONE ejemplo.local
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generar clave KSK (Key Signing Key)</span>
</span></span><span style="display:flex;"><span>dnssec-keygen -f KSK -a NSEC3RSASHA1 -b <span style="color:#ae81ff">4096</span> -n ZONE ejemplo.local</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="firma-de-zona">Firma de Zona</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Firmar la zona</span>
</span></span><span style="display:flex;"><span>dnssec-signzone -A -3 <span style="color:#66d9ef">$(</span>head -c <span style="color:#ae81ff">1000</span> /dev/random | sha1sum | cut -b 1-16<span style="color:#66d9ef">)</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -N INCREMENT -o ejemplo.local -t db.ejemplo.local</span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="replicación-de-zonas">Replicación de Zonas</h2>
<h3 id="configuración-del-servidor-maestro">Configuración del Servidor Maestro</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>zone &#34;ejemplo.local&#34; {
</span></span><span style="display:flex;"><span>    type master;
</span></span><span style="display:flex;"><span>    file &#34;/etc/bind/zones/db.ejemplo.local&#34;;
</span></span><span style="display:flex;"><span>    allow-transfer { 192.168.33.11; };
</span></span><span style="display:flex;"><span>    notify yes;
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="configuración-del-servidor-esclavo">Configuración del Servidor Esclavo</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>zone &#34;ejemplo.local&#34; {
</span></span><span style="display:flex;"><span>    type slave;
</span></span><span style="display:flex;"><span>    file &#34;/var/cache/bind/db.ejemplo.local&#34;;
</span></span><span style="display:flex;"><span>    masters { 192.168.33.10; };
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="copyinsert">



<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><ul>
<li><a href="https://bind9.readthedocs.io/">BIND 9 Administrator Reference Manual</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://dnssec-guide.readthedocs.io/">DNSSEC Guide</a></li>
</ul>
</li>
            
            
            
        </ul>
    </div>
</div>

troubleshooting.md:
markdown
CopyInsert</h2>
<h2 id="guía-de-resolución-de-problemas-comunes-en-servidores-dns-con-bind9">title: &ldquo;Resolución de Problemas DNS&rdquo;
linkTitle: &ldquo;Troubleshooting&rdquo;
weight: 32
description: &gt;
Guía de resolución de problemas comunes en servidores DNS con BIND9.</h2>
<h1 id="resolución-de-problemas-dns">Resolución de Problemas DNS</h1>
<h2 id="herramientas-de-diagnóstico">Herramientas de Diagnóstico</h2>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-tools" aria-hidden="true"></i>
    
    <strong>Herramientas DNS</strong>
  </div>
  <div class="definicion-contenido ">
      <ul>
        
        <li>Conjunto de utilidades para diagnosticar y resolver problemas en servidores DNS.</li>
        
        
        
      </ul>
  </div>
</div>
<h3 id="dig-domain-information-groper">dig (Domain Information Groper)</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Consulta básica</span>
</span></span><span style="display:flex;"><span>dig @localhost ejemplo.local
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Consulta reversa</span>
</span></span><span style="display:flex;"><span>dig -x 192.168.33.10
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Consulta de registro específico</span>
</span></span><span style="display:flex;"><span>dig @localhost ejemplo.local MX</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="nslookup">nslookup</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nslookup www.ejemplo.local localhost
</span></span><span style="display:flex;"><span>nslookup -type<span style="color:#f92672">=</span>mx ejemplo.local</span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="problemas-comunes-y-soluciones">Problemas Comunes y Soluciones</h2>
<h3 id="1-servidor-dns-no-responde">1. Servidor DNS No Responde</h3>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Verificación</h4>

    <ol>
<li>Comprobar estado del servicio:
<code>systemctl status named</code></li>
<li>Verificar logs:
<code>journalctl -u named</code></li>
<li>Comprobar puerto 53:
<code>netstat -tulpn | grep named</code></li>
</ol>


</div>

<h3 id="2-errores-en-archivos-de-zona">2. Errores en Archivos de Zona</h3>
<details>
    <summary>Comandos de Verificación</summary>
    <div class="solution-content">
        
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Verificar sintaxis de configuración</span>
</span></span><span style="display:flex;"><span>named-checkconf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Verificar archivo de zona</span>
</span></span><span style="display:flex;"><span>named-checkzone ejemplo.local /etc/bind/zones/db.ejemplo.local</span></span></code></pre></div>


</details>

<style>
    .solution-content {
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-top: 5px;
        background-color: #f9f9f9;
    }
    summary {
        cursor: pointer;
        font-weight: bold;
        color: #0073e6;
    }
</style>

<h3 id="3-problemas-de-resolución">3. Problemas de Resolución</h3>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Pasos de Verificación</h4>

    <ol>
<li>Verificar archivo /etc/resolv.conf</li>
<li>Comprobar conectividad al servidor DNS</li>
<li>Revisar reglas de firewall</li>
<li>Verificar permisos de archivos</li>
</ol>


</div>

<h2 id="logs-y-depuración">Logs y Depuración</h2>
<h3 id="configuración-de-logging">Configuración de Logging</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>logging {
</span></span><span style="display:flex;"><span>    channel default_debug {
</span></span><span style="display:flex;"><span>        file &#34;data/named.run&#34;;
</span></span><span style="display:flex;"><span>        severity dynamic;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="aumentar-nivel-de-debug">Aumentar Nivel de Debug</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>rndc trace 3
</span></span><span style="display:flex;"><span>rndc notrace  # Para desactivar</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>




<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><ul>
<li><a href="https://kb.isc.org/docs/aa-01123">BIND 9 Troubleshooting Guide</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://www.zytrax.com/books/dns/ch7/">DNS and BIND Troubleshooting</a></li>
</ul>
</li>
            
            
            
        </ul>
    </div>
</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e70f69453789dd4e29465068f3ecc3bd">4.3 - Comandos para dns</h1>
    
	




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Qué veremos aquí</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>- Conocer comandos para DNS.</li>
            
            <li>- Conceptos de pruebas y diagnósticos.</li>
            
            <li>  </li>
            
            
        </ul>
    </div>
    


</div>

<h2 id="herramientas-de-diagnóstico-dns">Herramientas de Diagnóstico DNS</h2>
<h3 id="herramientas-de-consulta-dns"><strong>Herramientas de consulta DNS</strong></h3>
<ul>
<li><strong><code>dig</code></strong> - Consultas DNS detalladas:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dig @192.168.33.10 web.inf.com
</span></span><span style="display:flex;"><span>dig +short web.inf.com
</span></span><span style="display:flex;"><span>dig -x 192.168.33.20  <span style="color:#75715e"># Consulta inversa</span>
</span></span></code></pre></div></li>
<li><strong><code>nslookup</code></strong> - Consultas básicas:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nslookup web.inf.com 192.168.33.10
</span></span><span style="display:flex;"><span>nslookup -type<span style="color:#f92672">=</span>MX inf.com
</span></span></code></pre></div></li>
<li><strong><code>host</code></strong> - Alternativa a <code>nslookup</code>:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>host web.inf.com 192.168.33.10
</span></span><span style="display:flex;"><span>host -t MX inf.com
</span></span></code></pre></div></li>
</ul>
<h3 id="depuración-del-servidor-dns"><strong>Depuración del Servidor DNS</strong></h3>
<ul>
<li><strong>Verificación de configuración:</strong>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>named-checkconf
</span></span><span style="display:flex;"><span>named-checkzone inf.com /etc/bind/zones/db.inf.com
</span></span></code></pre></div></li>
<li><strong>Estado del servicio:</strong>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>systemctl status bind9
</span></span><span style="display:flex;"><span>journalctl -u bind9 --no-pager | tail -n <span style="color:#ae81ff">20</span>
</span></span></code></pre></div></li>
</ul>
<h3 id="análisis-de-tráfico-dns"><strong>Análisis de tráfico DNS</strong></h3>
<ul>
<li><strong><code>tcpdump</code></strong> - Captura de paquetes DNS:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo tcpdump -i eth0 port <span style="color:#ae81ff">53</span>
</span></span></code></pre></div></li>
<li><strong><code>wireshark</code></strong> - Análisis visual del tráfico DNS.</li>
<li><strong><code>dnstracer</code></strong> - Rastreo de resolución DNS:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dnstracer web.inf.com
</span></span></code></pre></div></li>
<li><strong><code>dnsperf</code></strong> - Pruebas de rendimiento del DNS:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dnsperf -s 192.168.33.10 -d dns_queries.txt
</span></span></code></pre></div></li>
</ul>




<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias DNS</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Documentación Oficial y Recursos</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><ul>
<li><a href="https://www.isc.org/bind/">Documentación oficial de BIND9</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc1034">RFC 1034 - Domain Names - Concepts and Facilities</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc1035">RFC 1035 - Domain Names - Implementation and Specification</a></li>
</ul>
</li>
            
            <li></li>
            
            
        </ul>
    </div>
</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2f924b91564d17d9e0d461d693c6b856">4.4 - Práctica</h1>
    <div class="lead">Instalación y configuración de un servidor DNS utilizando BIND9 para la resolución de nombres en una red local con contenedores Docker.</div>
	




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Qué veremos aquí</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>- Comprender el concepto de DNS.</li>
            
            <li>- Instalar el servicio BIND9.</li>
            
            <li>- Configurar un servidor DNS para resolver nombres de dominio personalizados.</li>
            
            <li>- Implementar contenedores Docker con IPs fijas y gestionar su resolución DNS.</li>
            
            <li>  </li>
            
            
        </ul>
    </div>
    


</div>

<h1 id="enunciado-de-la-práctica">Enunciado de la Práctica</h1>
<p>En esta práctica, vamos a configurar un servidor DNS que permita la resolución de tres dominios personalizados en una red local:</p>
<ul>
<li><strong>web.inf.com</strong> → Contenedor Docker con IP fija.</li>
<li><strong>ftp.inf.com</strong> → Contenedor Docker con IP fija.</li>
<li><strong>db.inf.com</strong> → Contenedor Docker con IP fija.</li>
</ul>
<p>Cada uno de estos dominios estará asociado a un contenedor Docker que ejecuta un servicio web, FTP o base de datos. Nuestro objetivo es configurar un servidor DNS con BIND9 en un entorno de pruebas basado en Vagrant, asegurando que los nombres de dominio se resuelvan correctamente a las IPs fijas de los contenedores.</p>
<h1 id="instalación-y-configuración">Instalación y Configuración</h1>
<h2 id="entorno-de-práctica">Entorno de Práctica</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#3c3d38"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-ruby" data-lang="ruby"><span style="display:flex; background-color:#3c3d38"><span><span style="color:#66d9ef">Vagrant</span><span style="color:#f92672">.</span>configure(<span style="color:#e6db74">&#34;2&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>config<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>box <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ubuntu/focal64&#34;</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>hostname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dns-server&#34;</span>
</span></span><span style="display:flex;"><span>config<span style="color:#f92672">.</span>vm<span style="color:#f92672">.</span>network <span style="color:#e6db74">&#34;private_network&#34;</span>, <span style="color:#e6db74">ip</span>: <span style="color:#e6db74">&#34;192.168.33.10&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span></span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="instalación-de-bind9">Instalación de BIND9</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install bind9 bind9utils bind9-doc</span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="configuración-básica">Configuración Básica</h2>
<p>Los archivos principales de configuración se encuentran en 

<strong>
<span class="font-weight-bold text-primary fs-1.5">

    /etc/bind/


</span>
</strong>
:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>/etc/bind/
</span></span><span style="display:flex;"><span>├── named.conf          # Configuración principal
</span></span><span style="display:flex;"><span>├── named.conf.local    # Zonas locales
</span></span><span style="display:flex;"><span>├── named.conf.options  # Opciones globales
</span></span><span style="display:flex;"><span>└── zones/             # Directorio para archivos de zona</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="configuración-de-opciones-globales">Configuración de Opciones Globales</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>options {
</span></span><span style="display:flex;"><span>    directory &#34;/var/cache/bind&#34;;
</span></span><span style="display:flex;"><span>    recursion yes;
</span></span><span style="display:flex;"><span>    allow-recursion { localhost; 192.168.33.0/24; };
</span></span><span style="display:flex;"><span>    listen-on { 192.168.33.10; };
</span></span><span style="display:flex;"><span>    allow-transfer { none; };
</span></span><span style="display:flex;"><span>    dnssec-validation auto;
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="configuración-de-zona-local">Configuración de Zona Local</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>zone &#34;inf.com&#34; {
</span></span><span style="display:flex;"><span>type master;
</span></span><span style="display:flex;"><span>file &#34;/etc/bind/zones/db.inf.com&#34;;
</span></span><span style="display:flex;"><span>allow-update { none; };
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zone &#34;33.168.192.in-addr.arpa&#34; {
</span></span><span style="display:flex;"><span>type master;
</span></span><span style="display:flex;"><span>file &#34;/etc/bind/zones/db.192.168.33&#34;;
</span></span><span style="display:flex;"><span>allow-update { none; };
</span></span><span style="display:flex;"><span>};</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="archivo-de-zona-directa">Archivo de Zona Directa</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$TTL    604800
</span></span><span style="display:flex;"><span>@       IN      SOA     ns1.inf.com. admin.inf.com. (
</span></span><span style="display:flex;"><span>2024021901         ; Serial
</span></span><span style="display:flex;"><span>604800         ; Refresh
</span></span><span style="display:flex;"><span>86400         ; Retry
</span></span><span style="display:flex;"><span>2419200         ; Expire
</span></span><span style="display:flex;"><span>604800 )       ; Negative Cache TTL
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@       IN      NS      ns1.inf.com.
</span></span><span style="display:flex;"><span>@       IN      A       192.168.33.10
</span></span><span style="display:flex;"><span>ns1     IN      A       192.168.33.10
</span></span><span style="display:flex;"><span>web     IN      A       192.168.33.20
</span></span><span style="display:flex;"><span>ftp     IN      A       192.168.33.30
</span></span><span style="display:flex;"><span>db      IN      A       192.168.33.40</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h1 id="verificación-y-pruebas">Verificación y Pruebas</h1>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Comandos de Verificación</h4>

    <ul>
<li>Verificar sintaxis: <code>named-checkconf</code></li>
<li>Verificar zona: <code>named-checkzone inf.com /etc/bind/zones/db.inf.com</code></li>
<li>Consultar registros: <code>dig @192.168.33.10 web.inf.com</code></li>
</ul>


</div>

<details>
    <summary>Ejemplo de consulta DNS exitosa</summary>
    <div class="solution-content">
        
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; @192.168.33.10 web.inf.com
</span></span><span style="display:flex;"><span>; (1 server found)
</span></span><span style="display:flex;"><span>;; global options: +cmd
</span></span><span style="display:flex;"><span>;; Got answer:
</span></span><span style="display:flex;"><span>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 12345
</span></span><span style="display:flex;"><span>;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; ANSWER SECTION:
</span></span><span style="display:flex;"><span>web.inf.com.    604800  IN      A       192.168.33.20</span></span></code></pre></div>


</details>

<style>
    .solution-content {
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-top: 5px;
        background-color: #f9f9f9;
    }
    summary {
        cursor: pointer;
        font-weight: bold;
        color: #0073e6;
    }
</style>

<h1 id="consideraciones-de-seguridad">Consideraciones de Seguridad</h1>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Medidas de Seguridad Importantes</h4>

    <ol>
<li>Limitar la recursión solo a redes confiables.</li>
<li>Implementar DNSSEC para proteger la integridad de las respuestas.</li>
<li>Mantener BIND actualizado con los últimos parches de seguridad.</li>
<li>Configurar correctamente los permisos de archivos.</li>
</ol>


</div>





<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias DNS</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Documentación Oficial y Recursos</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><ul>
<li><a href="https://www.isc.org/bind/">Documentación oficial de BIND9</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc1034">RFC 1034 - Domain Names - Concepts and Facilities</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://tools.ietf.org/html/rfc1035">RFC 1035 - Domain Names - Implementation and Specification</a></li>
</ul>
</li>
            
            <li></li>
            
            
        </ul>
    </div>
</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  

    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="manuelromeromiguel@gmail.com" aria-label="manuelromeromiguel@gmail.com">
    <a target="_blank" rel="noopener" href="mailto:manuelromeromiguel@gmail.com" aria-label="manuelromeromiguel@gmail.com">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/MAlejandroR" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2025
    <span class="td-footer__authors">@MRomero</span></span><span class="td-footer__all_rights_reserved">Derechos reservados</span><span class="ms-2"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Política de privacidad</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/servicios/js/main.js"></script>
<script defer src="/servicios/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/servicios/js/tabpane-persist.js'></script>

  </body>
</html>
