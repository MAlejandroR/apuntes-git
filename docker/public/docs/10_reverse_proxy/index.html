<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="es" class="no-js">
  <head><script src="/despliegue/docker/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=despliegue/docker/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="alternate" type="application/rss&#43;xml" href="http://localhost:1313/despliegue/docker/docs/10_reverse_proxy/index.xml">
<link rel="alternate" type="text/html" href="http://localhost:1313/despliegue/docker/docs/10_reverse_proxy/_print/">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/despliegue/docker/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/despliegue/docker/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-192x192.png" sizes="192x192">

<title>Proxy inverso o Reverse prxy | Despliegue de aplicacones Web</title>
<meta name="description" content="Powerful, extensible, and feature-packed frontend toolkit. Build and customize with Sass, utilize prebuilt grid system and components, and bring projects to life with powerful JavaScript plugins.">

<meta property="og:url" content="http://localhost:1313/despliegue/docker/docs/10_reverse_proxy/">
  <meta property="og:site_name" content="Despliegue de aplicacones Web">
  <meta property="og:title" content="Proxy inverso o Reverse prxy">
  <meta property="og:description" content="Proxy y Proxy Inverso 1. Proxy Qué es un proxy Un proxy es un servidor intermedio que actúa como puente entre un cliente y un servidor . Cuando un cliente solicita acceder a un recurso en Internet, el proxy redirige esa solicitud al servidor, recibe la respuesta y se la devuelve al cliente.
Función principal:
Ocultar la identidad del cliente (anonimato). Filtrar contenido, controlar accesos o mejorar el rendimiento mediante caché. Imagen obtenida de https://www.redeszone.net/tutoriales/servidores/diferencias-proxy-vs-proxy-inverso/">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="Proxy inverso o Reverse prxy">
  <meta itemprop="description" content="Proxy y Proxy Inverso 1. Proxy Qué es un proxy Un proxy es un servidor intermedio que actúa como puente entre un cliente y un servidor . Cuando un cliente solicita acceder a un recurso en Internet, el proxy redirige esa solicitud al servidor, recibe la respuesta y se la devuelve al cliente.
Función principal:
Ocultar la identidad del cliente (anonimato). Filtrar contenido, controlar accesos o mejorar el rendimiento mediante caché. Imagen obtenida de https://www.redeszone.net/tutoriales/servidores/diferencias-proxy-vs-proxy-inverso/">
  <meta itemprop="wordCount" content="693">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Proxy inverso o Reverse prxy">
  <meta name="twitter:description" content="Proxy y Proxy Inverso 1. Proxy Qué es un proxy Un proxy es un servidor intermedio que actúa como puente entre un cliente y un servidor . Cuando un cliente solicita acceder a un recurso en Internet, el proxy redirige esa solicitud al servidor, recibe la respuesta y se la devuelve al cliente.
Función principal:
Ocultar la identidad del cliente (anonimato). Filtrar contenido, controlar accesos o mejorar el rendimiento mediante caché. Imagen obtenida de https://www.redeszone.net/tutoriales/servidores/diferencias-proxy-vs-proxy-inverso/">


<link href="/despliegue/docker/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll "  data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row ">
  <a class="navbar-brand" href="/despliegue/docker/"><span class="navbar-brand__logo navbar-logo">
    <img src="/despliegue/docker/images/logo.png" alt="Logo" width="150" height="auto" />
    </span><span class="navbar-brand__name">Despliegue de aplicacones Web</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Español</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/despliegue/docker/en/">English</a></li>
    <li><a class="dropdown-item" href="/despliegue/docker/fr/">Francés</a></li>
    </ul>
</div></li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="td-sidebar-nav collapse foldable-nav" id="td-section-nav">
    <div class="td-sidebar-nav__section nav-item dropdown d-block d-lg-none">
      <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Español</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/despliegue/docker/en/">English</a></li>
    <li><a class="dropdown-item" href="/despliegue/docker/fr/">Francés</a></li>
    </ul>
</div>
    </div>
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-desplieguedockerdocs-li">
  <a href="/despliegue/docker/docs/" title="Introducción" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-desplieguedockerdocs"><i class="fab fa-docker"></i><span class="">Docker</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-desplieguedockerdocs01_conceptos-li">
  <input type="checkbox" id="m-desplieguedockerdocs01_conceptos-check"/>
  <label for="m-desplieguedockerdocs01_conceptos-check"><a href="/despliegue/docker/docs/01_conceptos/" title="Conceptos sobre docker" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-desplieguedockerdocs01_conceptos"><i class="fa-regular fa-lightbulb"></i><span class="">Conceptos</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-desplieguedockerdocs02_contenedores-e-imc3a1genes-li">
  <input type="checkbox" id="m-desplieguedockerdocs02_contenedores-e-imc3a1genes-check"/>
  <label for="m-desplieguedockerdocs02_contenedores-e-imc3a1genes-check"><a href="/despliegue/docker/docs/02_contenedores-e-im%C3%A1genes/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-desplieguedockerdocs02_contenedores-e-imc3a1genes"><i class="fa  fa-box"></i><span class="">Contenedores e imágenes</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-desplieguedockerdocs03_instalacion-li">
  <input type="checkbox" id="m-desplieguedockerdocs03_instalacion-check"/>
  <label for="m-desplieguedockerdocs03_instalacion-check"><a href="/despliegue/docker/docs/03_instalacion/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-desplieguedockerdocs03_instalacion"><i class="fa fa-download"></i><span class="">Instalación</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-desplieguedockerdocs06_dockefile-li">
  <input type="checkbox" id="m-desplieguedockerdocs06_dockefile-check"/>
  <label for="m-desplieguedockerdocs06_dockefile-check"><a href="/despliegue/docker/docs/06_dockefile/" title="Fichero de ejecución para crear imágenes DockerFile" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-desplieguedockerdocs06_dockefile"><i class="fa-solid fa-terminal"></i><span class="">DockerFile</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-desplieguedockerdocs07_docker-compose-li">
  <input type="checkbox" id="m-desplieguedockerdocs07_docker-compose-check"/>
  <label for="m-desplieguedockerdocs07_docker-compose-check"><a href="/despliegue/docker/docs/07_docker-compose/" title="Docker compose" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-desplieguedockerdocs07_docker-compose"><i class="fas fa-file-code"></i><span class="">docker compose</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-desplieguedockerdocs10_reverse_proxy-li">
  <input type="checkbox" id="m-desplieguedockerdocs10_reverse_proxy-check" checked/>
  <label for="m-desplieguedockerdocs10_reverse_proxy-check"><a href="/despliegue/docker/docs/10_reverse_proxy/" title="Proxy inverso o Reverse prxy" class="align-left ps-0  active td-sidebar-link td-sidebar-link__section" id="m-desplieguedockerdocs10_reverse_proxy"><i class="fa-regular fa-file-code"></i><span class="td-sidebar-nav-active-item">Proxy inverso</span></a></label>
  
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">
<a id="print" href="/despliegue/docker/docs/10_reverse_proxy/_print/"><i class="fa-solid fa-print fa-fw"></i> Imprimir la sección entera</a>

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#proxy-y-proxy-inverso">Proxy y Proxy Inverso</a>
      <ul>
        <li><a href="#1-proxy">1. Proxy</a></li>
        <li><a href="#práctica-crear-un-proxy-reverse">Práctica: crear un proxy reverse</a></li>
        <li><a href="#configuración-de-proxy-inverso-con-docker">Configuración de Proxy Inverso con Docker</a></li>
        <li><a href="#levantar-los-contenedores">Levantar los contenedores:</a></li>
      </ul>
    </li>
    <li><a href="#hahahugoshortcode80s32hbhb">En la misma carpeta donde tenemos el fichero de configuración docker-compose.yaml:
HAHAHUGOSHORTCODE80s29HBHB
Y vemos el resultado:
HAHAHUGOSHORTCODE80s30HBHB
HAHAHUGOSHORTCODE80s31HBHB
HAHAHUGOSHORTCODE80s32HBHB</a></li>
  </ul>
</nav>
      </div>
    
            

          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/despliegue/docker/docs/">Docker</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    Proxy inverso</li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Proxy inverso o Reverse prxy</h1>
  
	<header class="article-meta">
		
</header>
	<h2 id="proxy-y-proxy-inverso">Proxy y Proxy Inverso</h2>
<h3 id="1-proxy">1. Proxy</h3>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-network-wired" aria-hidden="true"></i>
    
    <strong>Qué es un proxy</strong>
  </div>
  <div class="definicion-contenido">
    
Un 
<strong>
<span class="font-weight-bold text-primary">

    proxy


</span>
</strong>
 es un servidor intermedio que actúa como 
<strong>
<span class="font-weight-bold text-primary">

    puente


</span>
</strong>
 entre 
<strong>
<span class="font-weight-bold text-primary">

    un cliente y un servidor


</span>
</strong>
.

  </div>
</div>
<p>Cuando un cliente solicita acceder a un recurso en Internet, el proxy redirige esa solicitud al servidor, recibe la respuesta y se la devuelve al cliente.</p>
<p><strong>Función principal</strong>:</p>
<ul>
<li>Ocultar la identidad del cliente (anonimato).</li>
<li>Filtrar contenido, controlar accesos o mejorar el rendimiento mediante caché.</li>
</ul>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/1_proxy_hu342787633500672969.png" width="700" height="529">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


Imagen obtenida de https://www.redeszone.net/tutoriales/servidores/diferencias-proxy-vs-proxy-inverso/

</p>
</figcaption>
</figure>

<p>En la imagen podemos ver el ejemplo:</p>
<blockquote>
<ul>
<li>Un usuario quiere acceder a una página web.</li>
<li>Su solicitud pasa primero por un servidor proxy que redirige la conexión, de modo que el servidor web no ve directamente al cliente, sino al proxy.</li>
</ul>
</blockquote>
<hr>
<h4 id="2-proxy-inverso-reverse-proxy">2. Proxy Inverso (reverse proxy)</h4>
<p>Un 
<strong>
<span class="font-weight-bold text-primary">

    1_proxy inverso


</span>
</strong>
 (también llamado <strong>reverse proxy</strong>) es un servidor que se sitúa frente a uno o más servidores y gestiona las solicitudes de los clientes antes de enviarlas a los servidores finales.
De alguna forma la diferencia es que colocamos el servidor proxy después de internet, y no antes (<em>proxy directo</em>)</p>
<hr style="border-color: red; border-width: 3px;"/>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Proxy directo


</span>
</strong>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/proxy_directo_hu16039520143035292699.png" width="700" height="297">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


https://www.cloudflare.com/es-es/learning/cdn/glossary/reverse-proxy/

</p>
</figcaption>
</figure>


<strong>
<span class="font-weight-bold text-primary">

    Proxy reverse


</span>
</strong>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/3_proxy_reverse_hu4033920156410999965.webp" width="700" height="297">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


https://www.cloudflare.com/es-es/learning/cdn/glossary/reverse-proxy/

</p>
</figcaption>
</figure>
</p>
<hr style="border-color: red; border-width: 3px;"/>

<strong>
<span class="font-weight-bold text-primary">

    El serivido proxy


</span>
</strong>

<p><strong>Función principal</strong>:</p>
<ul>
<li>Actuar como intermediario entre los clientes y los servidores internos, con objetivos como:
<ul>
<li>Distribuir la carga entre varios servidores (balanceo de carga).</li>
<li>Mejorar la seguridad ocultando los servidores reales.</li>
<li>Servir contenido en caché para acelerar la entrega.</li>
<li>Gestionar múltiples subdominios o servicios desde un único punto de entrada.</li>
</ul>
</li>
</ul>
<p><strong>Ejemplo</strong>:<br>
Cuando accedes a <code>www.miweb.com</code>, el proxy inverso determina si tu solicitud debe ser atendida por un servidor web, un servidor de imágenes, o un servicio API, redirigiéndola al servidor correspondiente.</p>
<hr>
<p>
<strong>
<span class="font-weight-bold text-primary">

    ¿Por qué se llama &ldquo;proxy inverso&rdquo;?


</span>
</strong>

El término &ldquo;inverso&rdquo; refleja que el proxy inverso actúa del lado del servidor (recibiendo solicitudes de los clientes) en lugar del lado del cliente (como un proxy convencional). Mientras el proxy normal protege al cliente, el proxy inverso protege y organiza a los servidores.</p>
<hr>
<h3 id="práctica-crear-un-proxy-reverse">Práctica: crear un proxy reverse</h3>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Práctica</h4>

    Vamos a practicar con docker para crer un servidor inverso que nos permita atender varias solicitudes

</div>

<h3 id="configuración-de-proxy-inverso-con-docker">Configuración de Proxy Inverso con Docker</h3>
<h4 id="1-preparar-el-entorno">1. Preparar el entorno</h4>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Primer paso</h4>

    El primer paso es tener resueltas las ip de los dominios

</div>

<p>Editar el archivo <code>hosts</code> en tu máquina local:</p>
<p>Agrega las siguientes líneas para simular los dominios:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>127.0.0.1 dwes.com
</span></span><span style="display:flex; background-color:#d6d6c6"><span>127.0.0.1 alumno1.dwes.com
</span></span><span style="display:flex; background-color:#d6d6c6"><span>127.0.0.1 alumno2.dwes.com
</span></span><span style="display:flex;"><span>127.0.0.1 alumno3.dwes.com
</span></span><span style="display:flex;"><span>127.0.0.1 alumno4.dwes.com
</span></span><span style="display:flex;"><span>127.0.0.1 alumno5.dwes.com</span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>Esto permite que los subdominios apunten a tu máquina local.
En un caso real, necesitaríamos que a través del dns, estos dominios apunten a la máquina donde está nuestro proxy</p>
<p>La imagen siguiente trata de mostrar este primer  proceso
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1000px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/proxy_reverse_dns_1_hu6248074146806054114.webp" width="990" height="334">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">





</p>
</figcaption>
</figure>
</p>
<hr style="border-color: red; border-width: 3px;"/>
<h4 id="1-configurando-las-virtualizaciones">1. Configurando las virtualizaciones</h4>
<p>

<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Segundo paso</h4>

    <ul>
<li>Ahora vamos a crear el <strong>docker-compose</strong></li>
<li>Ahí irán todos <strong>los entornos</strong> de ejecución  virtualizados</li>
<li>Crearemos <strong>el proxy</strong>, y una virtualización por <strong>cada servicio web</strong> que queramos</li>
</ul>


</div>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 682px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/docker_proxy_reverse_1_hu12617835598105081774.webp" width="672" height="462">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>


<strong>
<span class="font-weight-bold text-primary">

    El servicio de proxy quedaría especificado así


</span>
</strong>

<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-docker" data-lang="docker"><span style="display:flex;"><span>services:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>  proxy_reverse:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    image: nginx<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    ports:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>      - 8200:80<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    volumes:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>      - ./ngynx-proxy/ngynx.conf:/etc/nginx/nginx.conf:ro<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    container_name: proxy_reverse<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>  </span></span></code></pre></td></tr></table>
</div>
</div></p>
<ul>
<li>Vemos cómdo tenemos mapeado o compartido un fichero de configuración(
<strong>
<span class="font-weight-bold text-primary">

    ngynx.conf


</span>
</strong>
) entre el hosts y el contenedor. Necesitamos especificar en el servidor web (nginx), 
<strong>
<span class="font-weight-bold text-primary">

    los host virtuales que queremos resolver


</span>
</strong>
.</li>
<li>Este es un concepto que estudiaremos en el próximo capítulo de servidores web: Apache y nginx.</li>
<li>Por otro lado, mapeamos el puerto 8200 del host al 80 del nginx del contenedor.</li>
<li>El contenido del fichero de configuración se puede entender viendo su especificación.
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>http {
</span></span><span style="display:flex;"><span>  server {
</span></span><span style="display:flex;"><span>    listen <span style="color:#b452cd">80</span>;
</span></span><span style="display:flex; background-color:#d6d6c6"><span>    server_name alumno1.dwes.com;
</span></span><span style="display:flex;"><span>    location / {
</span></span><span style="display:flex; background-color:#d6d6c6"><span>        proxy_pass http://alumno1:<span style="color:#b452cd">80</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  server { .. lo mismo para alumno2.dwes.com y alumno3.dwes.com .. }}</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Crear los contenedores para los alumnos


</span>
</strong>
</li>
</ul>
<p>Cada alumno tendrá un contenedor Docker con 
<strong>
<span class="font-weight-bold text-primary">

    Apache


</span>
</strong>
 y 
<strong>
<span class="font-weight-bold text-primary">

    PHP


</span>
</strong>
 instalados:</p>
<p>En una carpeta, crea un archivo 
<strong>
<span class="font-weight-bold text-primary">

    Dockerfile


</span>
</strong>
 con este contenido:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> php:8.3-apache</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">COPY</span> ./public_html/ /var/www/html/<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">EXPOSE</span><span style="color:#cd5555"> 80</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>Crea la carpeta <code>public_html/</code> con un archivo <code>index.php</code> simple para probar:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#8b008b;font-weight:bold">echo</span> <span style="color:#cd5555">&#34;Bienvenido al servidor de alumno1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">?&gt;</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<h3 id="levantar-los-contenedores">Levantar los contenedores:</h3>
<p>Ahora solo queda levantar el contenedor y ver el resultado</p>
<h2 id="hahahugoshortcode80s32hbhb">En la misma carpeta donde tenemos el fichero de configuración docker-compose.yaml:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>  docker compose up -d</span></span></code></pre></td></tr></table>
</div>
</div>
Y vemos el resultado:
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 496px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/1_web_hu17413330141412103830.png" width="486" height="279">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 496px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/2_web_hu4853073451851484701.png" width="486" height="279">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 496px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/3_web_hu3755075507758162796.png" width="486" height="279">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</h2>

  <div class="section-index">
    
    
    </div>
</div>

          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Correo del usuario" aria-label="Correo del usuario">
    <a target="_blank" rel="noopener" href="https://example.org/mail" aria-label="Correo del usuario">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/MAlejandroR" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2024
    <span class="td-footer__authors">@MRomero</span></span><span class="td-footer__all_rights_reserved">Derechos reservados</span><span class="ms-2"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Política de privacidad</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/despliegue/docker/js/main.js"></script>
<script defer src="/despliegue/docker/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/despliegue/docker/js/tabpane-persist.js'></script>

  </body>
</html>