<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="es" class="no-js">
  <head><script src="/despliegue/docker/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=despliegue/docker/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="http://localhost:1313/despliegue/docker/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="http://localhost:1313/despliegue/docker/docs/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/despliegue/docker/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/despliegue/docker/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/despliegue/docker/favicons/android-192x192.png" sizes="192x192">

<title>Introducción | Despliegue de aplicacones Web</title>
<meta name="description" content="Powerful, extensible, and feature-packed frontend toolkit. Build and customize with Sass, utilize prebuilt grid system and components, and bring projects to life with powerful JavaScript plugins.">

<meta property="og:url" content="http://localhost:1313/despliegue/docker/docs/">
  <meta property="og:site_name" content="Despliegue de aplicacones Web">
  <meta property="og:title" content="Introducción">
  <meta property="og:description" content="Docker Objetivos de este tema Entender qué es docker Crear contenedores Crear Imágenes Trabajar con entornos dockerizados para desarrollo Crear imágenes con DockerFile Crear servicios con docker compose Referencias Fuentes de Información La mejor la oficial: https://docs.docker.com/engine/">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="Introducción">
  <meta itemprop="description" content="Docker Objetivos de este tema Entender qué es docker Crear contenedores Crear Imágenes Trabajar con entornos dockerizados para desarrollo Crear imágenes con DockerFile Crear servicios con docker compose Referencias Fuentes de Información La mejor la oficial: https://docs.docker.com/engine/">
  <meta itemprop="wordCount" content="890">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Introducción">
  <meta name="twitter:description" content="Docker Objetivos de este tema Entender qué es docker Crear contenedores Crear Imágenes Trabajar con entornos dockerizados para desarrollo Crear imágenes con DockerFile Crear servicios con docker compose Referencias Fuentes de Información La mejor la oficial: https://docs.docker.com/engine/">


<link href="/despliegue/docker/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll "  data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row ">
  <a class="navbar-brand" href="/despliegue/docker/"><span class="navbar-brand__logo navbar-logo">
    <img src="/despliegue/docker/images/logo.png" alt="Logo" width="150" height="auto" />
    </span><span class="navbar-brand__name">Despliegue de aplicacones Web</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Español</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/despliegue/docker/en/">English</a></li>
    <li><a class="dropdown-item" href="/despliegue/docker/fr/">Francés</a></li>
    </ul>
</div></li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
Versión imprimible multipagina.
<a href="#" onclick="print();return false;">Haga click aquí para imprimir</a>.
</p><p>
<a href="/despliegue/docker/docs/">Volver a la vista normal de esta página</a>.
</p>
</div>



<h1 class="title">Introducción</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-31315b7cb4f93cac4e144a838a35f8df">Conceptos sobre docker</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-65d5cba354484d7f0190e833730fea79">Contenedores e imágenes</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-015e39fb970d2fc0fa343d9eb6f8b7ee">Instalación</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-be7312263a67ea65e5e20d152b9a270c">Fichero de ejecución para crear imágenes DockerFile</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-119983b132b25e85c20958c2f3b25dcd">Docker compose</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-db70193927a58cc58192654a75aef445">Proxy inverso o Reverse prxy</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>


<div class="content">
      




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Docker</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Objetivos de este tema</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Entender qué es docker</li>
            
            <li>Crear contenedores</li>
            
            <li>Crear Imágenes</li>
            
            <li>Trabajar con entornos dockerizados para desarrollo</li>
            
            <li>Crear imágenes con DockerFile</li>
            
            <li>Crear servicios con docker compose</li>
            
            
            
        </ul>
    </div>
    


</div>





<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><ul>
<li>La mejor la oficial:</li>
</ul>
</li>
            
            <li><blockquote>
<p><a href="https://docs.docker.com/engine/">https://docs.docker.com/engine/</a></p>
</blockquote></li>
            
            <li><ul>
<li>Artículo interesante de Mauricio Collados, donde he sacado ideas para este tema</li>
</ul>
</li>
            
            <li><blockquote>
<p><a href="https://medium.com/ingenier%C3%ADa-en-tranqui-finanzas/una-gu%C3%ADa-no-tan-r%C3%A1pida-de-docker-y-kubernetes-933f5b6709df">https://medium.com/ingenier%C3%ADa-en-tranqui-finanzas/una-gu%C3%ADa-no-tan-r%C3%A1pida-de-docker-y-kubernetes-933f5b6709df</a></p>
</blockquote></li>
            
            <li><ul>
<li>Curso gratuito de docker</li>
</ul>
</li>
            
            <li><blockquote>
<p><a href="https://jgaitpro.com/p/introduccion-a-containers-en-docker">https://jgaitpro.com/p/introduccion-a-containers-en-docker</a></p>
</blockquote></li>
            
            <li><ul>
<li>Instalar contenedor en windows (ver minutos 6:10 - 9:21</li>
</ul>
</li>
            
            <li><blockquote>
<p><a href="https://www.youtube.com/watch?v=9FoWrDx6n2k">https://www.youtube.com/watch?v=9FoWrDx6n2k</a></p>
</blockquote></li>
            
            
            
            
        </ul>
    </div>
</div>

<p>

<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Lectura recomendada</h4>

    <blockquote>
<ul>
<li>Esta página por su puesto no es para estudiar.</li>
<li>Trata de contextualizar docker con un poco de historia y su evolución</li>
<li>Trata de sus orígenes,</li>
<li><em><strong>Como técnicos/as en tecnologías, es bueno que conozcamos algo de historia de la tecnología con la que trabajamos</strong></em></li>
</ul>
</blockquote>


</div>



<div class="pageinfo pageinfo-primary">

<strong>Resumen de un poco de historia</strong>



<hr style="border-color: red; border-width: 3px;"/>

El desarrollo de 
<strong>
<span class="font-weight-bold text-primary">

    Docker comenzó en 2010


</span>
</strong>
, impulsado por 
<strong>
<span class="font-weight-bold text-primary">

    Solomon Hykes


</span>
</strong>
, quien trabajaba como ingeniero en una empresa que más tarde se renombraría como 
<strong>
<span class="font-weight-bold text-primary">

    Docker Inc


</span>
</strong>
.
<br />
Ahí se creó inicialmente 
<strong>
<span class="font-weight-bold text-primary">

    Docker como una plataforma de contenedores


</span>
</strong>
, y con el tiempo se convirtió en una tecnología y una marca ampliamente reconocida para la 
<strong>
<span class="font-weight-bold text-primary">

    virtualización basada en contenedores


</span>
</strong>
, algo que después de 2013 cuando Solomon lo presentó en una conferencia al munso, cambió totalmente el enfoque del desarrollo.
<br />
Solomon Hykes dejó Docker Inc. en 2018 para centrarse en nuevos proyectos.
<br />
En 2017, Docker Inc. lanzó el 
<strong>
<span class="font-weight-bold text-primary">

    Moby Project


</span>
</strong>
, un proyecto de código abierto que descompone Docker en varios componentes modulares y reutilizables.
<br />
El objetivo de Moby es permitir a los desarrolladores utilizar estos componentes de manera independiente para crear sus propias soluciones de contenedores personalizadas. En este proyecto, se desglosó Docker en componentes más pequeños y reutilizables
<br />

Actualmente, Docker sigue existiendo como un producto comercial y una plataforma completa que integra estos componentes en un paquete fácil de usar para crear y gestionar contenedores.
<br />
En otras palabras, Docker es la plataforma que los usuarios finales utilizan para trabajar con contenedores, mientras que Moby funciona como un 
<strong>
<span class="font-weight-bold text-primary">

    conjunto de herramientas


</span>
</strong>
 de código abierto que sirve como base de Docker y permite a los desarrolladores crear soluciones a medida.

</div>
</p>




<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Referencias</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li>&ldquo;What is Docker? The spark for the container revolution&rdquo; (3 de marzo de 2021): Este artículo ofrece una visión detallada sobre los inicios de Docker y su impacto en la industria de contenedores. <a href="https://www.infoworld.com/article/2269272/how-docker-broke-in-half.html">https://www.infoworld.com/article/2269272/how-docker-broke-in-half.html</a></li>
            
            <li>&ldquo;Solomon Hykes leaves Docker, the company he founded&rdquo; (28 de marzo de 2018): Este artículo aborda la salida de Solomon Hykes de Docker y ofrece una visión de su impacto en la empresa. <a href="https://techcrunch.com/2018/03/28/solomon-hykes-leaves-docker-the-company-he-founded/">https://techcrunch.com/2018/03/28/solomon-hykes-leaves-docker-the-company-he-founded/</a></li>
            
            
            
        </ul>
    </div>
</div>

<h1 id="historia-de-docker-innovación-y-comunidad-en-la-contenerización">Historia de Docker: Innovación y Comunidad en la Contenerización</h1>
<p>La historia de Docker es un proceso  de innovación y colaboración que ha incidido de forma muy clara y contundente en el mundo del desarrollo de software, popularizando el uso de contenedores.
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 870px">
<img class="card-img-top" src="/despliegue/docker/docs/salomon_trabajando_hu5347605164123752284.webp" width="860" height="491">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</p>
<h2 id="orígenes-y-dotcloud-2008">Orígenes y dotCloud (2008)</h2>
<p>Docker tuvo sus orígenes en 2008 como un proyecto interno dentro de 
<strong>
<span class="font-weight-bold text-primary">

    dotCloud


</span>
</strong>
, una empresa de plataforma como servicio fundada por 
<strong>
<span class="font-weight-bold text-primary">

    Solomon Hykes


</span>
</strong>
.</p>
<p>Su objetivo era mejorar la eficiencia y portabilidad de las aplicaciones 
<strong>
<span class="font-weight-bold text-primary">

    al empaquetarlas en contenedores


</span>
</strong>
 que pudieran <strong>ejecutarse de forma consistente en diferentes entornos</strong>.
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 310px">
<img class="card-img-top" src="/despliegue/docker/docs/empaquetamiento_hu1462948396119611165.webp" width="300" height="300">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>
</p>
<h2 id="lanzamiento-público-de-docker-2013">Lanzamiento Público de Docker (2013)</h2>
<p>En 2013, Docker fue presentado al público y se lanzó como 
<strong>
<span class="font-weight-bold text-primary">

    software de código abierto


</span>
</strong>
 bajo la licencia Apache 2.0.</p>
<p>Esta decisión fue clave, ya que permitió el crecimiento de una comunidad global en torno a Docker, impulsando su desarrollo y su adopción.</p>
<p>La facilidad con la que 
<strong>
<span class="font-weight-bold text-primary">

    los contenedores Docker podían crearse y desplegarse


</span>
</strong>
 ayudó a que se convirtiera en una herramienta popular entre desarrolladores y empresas.
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1289px">
<img class="card-img-top" src="/despliegue/docker/docs/salomon_2013_hu11764695974802313557.png" width="1279" height="746">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


El día de la presentación de Salomon Hykes
<a href="https://www.google.com/search?q=presentaci%C3%B3n+docker+por+solomon+2013&oq=presentaci%C3%B3n+docker+por+solomon+2013&gs_lcrp=EgZjaHJvbWUyBggAEEUYOdIBCDg3MjBqMGo3qAIIsAIB&sourceid=chrome&ie=UTF-8#fpstate=ive&vld=cid:78729fe6,vid:zgR8otZkwHc,st:0>">Una reacción a la Presentación</a>


</p>
</figcaption>
</figure>
</p>
<h2 id="proyecto-moby-2017-modularización-y-flexibilidad">Proyecto Moby (2017): Modularización y Flexibilidad</h2>
<p>Para modularizar y estandarizar la construcción de sistemas de contenedores, en 2017 Docker, Inc. lanzó el 
<strong>
<span class="font-weight-bold text-primary">

    Proyecto Moby


</span>
</strong>
.</p>
<p>Moby Project es una plataforma abierta que proporciona componentes básicos para crear soluciones personalizadas de contenerización.</p>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Docker


</span>
</strong>
 sigue siendo la implementación más popular basada en Moby, pero Moby en sí mismo permite que otros desarrolladores construyan sus propias versiones y herramientas adaptadas a necesidades específicas.</p>
<h2 id="docker-como-producto-comercial">Docker como Producto Comercial</h2>
<p>Docker, Inc. ha desarrollado Docker como un 
<strong>
<span class="font-weight-bold text-primary">

    producto comercial


</span>
</strong>
 que incluye herramientas avanzadas y soporte técnico, facilitando la adopción y administración de contenedores en entornos empresariales.</p>
<p>Esta versión comercial se complementa con una comunidad de código abierto, lo que permite que Docker sea accesible tanto para individuos como para grandes empresas.</p>
<h2 id="impacto-de-la-comunidad-y-ecosistema-de-código-abierto">Impacto de la Comunidad y Ecosistema de Código Abierto</h2>
<p>La comunidad de desarrolladores ha sido fundamental en la evolución de Docker. Contribuciones de código, mejoras de rendimiento y soluciones innovadoras aportadas por la comunidad global han consolidado a Docker como la tecnología de contenedorización líder en la actualidad.</p>
<p>La adopción de Docker ha sido tal que se ha convertido en un 
<strong>
<span class="font-weight-bold text-primary">

    estándar para el empaquetado y despliegue de aplicaciones


</span>
</strong>
.</p>
<h2 id="popularización-de-contenedores-e-integración-con-kubernetes">Popularización de Contenedores e Integración con Kubernetes</h2>
<p>Docker popularizó la idea de los contenedores, transformándolos en una forma eficiente de empaquetar y distribuir aplicaciones.</p>
<p>Su integración con otras tecnologías, especialmente 
<strong>
<span class="font-weight-bold text-primary">

    Kubernetes


</span>
</strong>
, ha permitido crear ecosistemas de contenedores más complejos y escalables, adecuados para entornos de microservicios y despliegues en la nube.</p>
<h2 id="el-futuro-de-docker">El Futuro de Docker</h2>
<p>Docker continúa evolucionando y adaptándose a las tendencias emergentes, como la 
<strong>
<span class="font-weight-bold text-primary">

    computación en la nube


</span>
</strong>
 y el 
<strong>
<span class="font-weight-bold text-primary">

    edge computing


</span>
</strong>
.</p>
<p>A medida que el desarrollo de software se orienta cada vez más hacia infraestructuras dinámicas y escalables, Docker se posiciona como una tecnología clave en la implementación de aplicaciones modernas.</p>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-31315b7cb4f93cac4e144a838a35f8df">1 - Conceptos sobre docker</h1>
    
	<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fab fa-docker" aria-hidden="true"></i>
    
    <strong>docker</strong>
  </div>
  <div class="definicion-contenido">
    
Docker es una plataforma de virtualización basada en contenedores.

  </div>
</div>
<ul>
<li>
<p>
<strong>
<span class="font-weight-bold text-primary">

    PUNTOS FUNDAMENTALES


</span>
</strong>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Importante</h4>

    Asegúrate de leer y entender bien los siguientes párrafos

</div>
</p>
</li>
<li>
<p>La idea es tener 
<strong>
<span class="font-weight-bold text-primary">

    un contenedor (un archivo ejecutable)


</span>
</strong>
 que contiene todo lo necesario para ejecutar una aplicación, incluyendo el código, las dependencias y las configuraciones, de forma totalmente aislada del sistema en el cual se está ejecutando. Esto permite que la aplicación se ejecute de manera consistente en cualquier entorno.</p>
</li>
<li>
<p>Este archivo contenedor 
<strong>
<span class="font-weight-bold text-primary">

    no incluye un sistema operativo completo propio


</span>
</strong>
, pero funciona como si lo tuviera, 
<strong>
<span class="font-weight-bold text-primary">

    ejecutándose de forma aislada e independiente del sistema anfitrión


</span>
</strong>
.</p>
<blockquote>
<p>Utiliza el kernel del anfitrión y configura los componentes necesarios para simular el entorno del sistema operativo deseado o requerido, aunque siempre dentro del tipo de sistema operativo del anfitrión.</p>
</blockquote>
</li>
<li>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Compatibilidad de sistema operativo


</span>
</strong>
: Los contenedores dependen del sistema anfitrión, por lo que los contenedores Linux solo se ejecutan en anfitriones Linux.</p>
<blockquote>
<p>Sin embargo, gracias a tecnologías comoc  
<strong>
<span class="font-weight-bold text-primary">

    WSL y Hyper-V


</span>
</strong>
, es posible ejecutar contenedores Linux en Windows.</p>
</blockquote>
<blockquote>
<p>También existen soluciones emergentes para ejecutar contenedores de Windows en Linux, aunque con limitaciones.</p>
</blockquote>
</li>
</ul>
<h3 id="el-proceso-de-empaquetado">El proceso de empaquetado</h3>
<p>En Docker, el proceso de empaquetado agrupa el código fuente y todas las dependencias necesarias para que el software funcione, creando una entidad unificada en forma de archivo de contenedor.</p>
<p>Para crear un contenedor necesitamos partir de una plantilla base que contenga lo necesario  para este entorno de ejecución aislada. Esta plantilla la conocemos como 
<strong>
<span class="font-weight-bold text-primary">

    imagen


</span>
</strong>
</p>
<p>Un <strong>contenedor</strong> es, en esencia, una instancia ejecutable que virtualiza el software dentro de un entorno específico.</p>
<p>A partir de un contenedor, se pueden crear imágenes en cualquier momento, permitiendo así capturar el estado del entorno y los cambios realizados.</p>
<h3 id="creación-y-actualización-de-contenedores">Creación y actualización de contenedores</h3>
<p>A partir de una imagen específica, es posible iniciar un contenedor de forma muy rápida, en cuestión de segundos o menos.</p>
<p>Si realizamos cambios en el contenedor, estos se guardan en capas incrementales, lo que permite visualizar los cambios y restaurar versiones anteriores del entorno, si es necesario.</p>
<h3 id="docker-vs-máquinas-virtuales">Docker Vs Máquinas virtuales</h3>
<iframe src="https://docs.google.com/presentation/d/e/2PACX-1vS6zxmUEE9zmd10c_6vLNf2bTaI_BoVCkVukwHcnBO0S3lm_NVU_YU9sJcUpCItLKyKCACkXrjESfbB/embed?start=false&loop=false&delayms=3000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-65d5cba354484d7f0190e833730fea79">2 - Contenedores e imágenes</h1>
    
	<h2 id="contenedores-e-imágnes">Contenedores e imágnes</h2>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 610px">
<img class="card-img-top" src="/despliegue/docker/docs/02_contenedores-e-im%C3%A1genes/Contenedor_vs_img_hu14260772193613322638.png" width="600" height="350">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


Imagen y contenedor en docker

</p>
</figcaption>
</figure>

<h3 id="la-imagen">La imagen</h3>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-info-circle" aria-hidden="true"></i>
    
    <strong>la imagen</strong>
  </div>
  <div class="definicion-contenido">
    

<span class="font-weight-bold text-primary">


    La imagen

</span>
 es un archivo que contiene todas las librerías, dependencias y configuraciones necesarias para ejecutar un entorno aislado con sus propios servicios y procesos. Sirve como base para crear uno o varios contenedores, los cuales obtendrán configuraciones de red y direcciones IP independientes al momento de su creación.


  </div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 621px">
<img class="card-img-top" src="/despliegue/docker/docs/02_contenedores-e-im%C3%A1genes/Imagen_hu16434163412315167937.png" width="611" height="812">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Notas</h4>

    No se emula hardware, sino únicamente servicios y software (como el sistema de archivos, el sistema operativo y los servicios). Por lo tanto, un contenedor no es una máquina virtual, aunque tenga su propia IP. Sin embargo, puede considerarse como un dispositivo o nodo independiente dentro de la red.

</div>

<h3 id="el-contenedor">El contenedor</h3>
<blockquote>
<p>El contenedor es una capa de lectura y escritura que se añade a una imagen, permitiendo interactuar con ella y ponerla en ejecución.
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 810px">
<img class="card-img-top" src="/despliegue/docker/docs/02_contenedores-e-im%C3%A1genes/container_hu5364377010260540432.jpg" width="800" height="600">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


Imagen obtenida de https://iesgn.github.io/curso_docker_2021/sesion2/organizacion.html

</p>
</figcaption>
</figure>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Notas</h4>

    El contenedor se crea a partir de una imagen y siempre dependerá de ella. Esto significa que no podremos eliminar la imagen mientras exista un contenedor asociado a ella.

</div>
</p>
</blockquote>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Notas</h4>

    El contenedor almacena los cambios realizados sobre la imagen, funcionando como pequeños incrementos sobre un archivo base. Este enfoque lo convierte en un sistema muy robusto, ágil y ligero.

</div>

<h3 id="contenedor-e-imagen">Contenedor e imagen</h3>


<div class="pageinfo pageinfo-primary">
<h4 id="heading"></h4>
<p><strong>La unión hace la fuerza</strong></p>
<p>El funcionamiento de Docker se basa en crear un contenedor a partir de una imagen, por lo que los conceptos de imagen y contenedor están intrínsecamente relacionados (no se pueden usar de manera individual).</p>
<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Nota</h4>
<pre><code>Todo contenedor siempre dependerá de una única imagen.
</code></pre>
</div>
<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Nota</h4>
<pre><code>Una imagen puede ser la base de uno o muchos contenedores.
</code></pre>
<p>Cada contenedor es un sistema independiente de los demás, con su propia IP y un entorno completamente aislado.</p>
</div>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 810px">
<img class="card-img-top" src="/despliegue/docker/docs/02_contenedores-e-im%C3%A1genes/join_img_container_hu17901011678537150505.png" width="800" height="200">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">
</p>
</figcaption>
</figure>

</div>

<h3 id="compentes-de-la-arqutectura-docker">Compentes de la arqutectura docker</h3>
<p><figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 1369px">
<img class="card-img-top" src="/despliegue/docker/docs/02_contenedores-e-im%C3%A1genes/arquitectura_docker_hu10097844928879679189.png" width="1359" height="901">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

Descripcion de la imagen</p>
<h3>
<strong>
<span class="font-weight-bold text-primary">

    Cliente de Docker:


</span>
</strong>
</h3>
<blockquote>
<ul>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Docker CLI


</span>
</strong>
 permite ejecutar comandos para interactuar con Docker,</li>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Docker Compose


</span>
</strong>
** se utiliza para definir y manejar aplicaciones de múltiples contenedores.</li>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Docker Engine


</span>
</strong>
 Envía comandos  al motor de Docker para su ejecución.</li>
</ul>
</blockquote>
<h3>
<strong>
<span class="font-weight-bold text-primary">

    Docker Engine:


</span>
</strong>
</h3>
<blockquote>
<p>Compuesta por 
<strong>
<span class="font-weight-bold text-primary">

    Docker Engine API


</span>
</strong>
 y
<strong>
<span class="font-weight-bold text-primary">

    Docker daemon


</span>
</strong>
,los cuales  son componentes fundamentales del motor de Docker.
*
<strong>
<span class="font-weight-bold text-primary">

    Docker Engine API


</span>
</strong>
 es la interfaz de comunicación entre el cliente y el motor.
*
<strong>
<span class="font-weight-bold text-primary">

    Docker daemon


</span>
</strong>
gestiona los contenedores y las imágenes.</p>
<blockquote>
<p>Podemos ver en la imagen,  áreas para 
<strong>
<span class="font-weight-bold text-primary">

    imágenes


</span>
</strong>
 y 
<strong>
<span class="font-weight-bold text-primary">

    contenedores


</span>
</strong>
, donde queda explícito que   Docker Engine se encarga de manejar tanto las imágenes como la ejecución de los contenedores.</p>
<ul>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Container Runtime


</span>
</strong>
 es el entorno en el que los contenedores se ejecutan.</li>
</ul>
</blockquote>
</blockquote>
<h3> 
<strong>
<span class="font-weight-bold text-primary">

    Docker Registry:


</span>
</strong>
</h3>
<blockquote>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Docker Register API


</span>
</strong>
** y 
<strong>
<span class="font-weight-bold text-primary">

    Repositorio de imágenes


</span>
</strong>
, que podemos considerar componentes esperados en esta sección.</p>
<ul>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Docker Registry


</span>
</strong>
** es el servicio para almacenar y distribuir imágenes de contenedores, siendo 
<strong>
<span class="font-weight-bold text-primary">

    Docker Hub


</span>
</strong>
 es un ejemplo de un registro público.</li>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Repositorio de imágenes


</span>
</strong>
 muestra en su relación con 
<strong>
<span class="font-weight-bold text-primary">

    Docker Engine


</span>
</strong>
 quien puede extraer y subir imágenes  este repositorio</li>
</ul>
</blockquote>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-015e39fb970d2fc0fa343d9eb6f8b7ee">3 - Instalación</h1>
    
	




<div style="border: 1px solid darkgreen; border-radius: 5px; overflow: hidden;">
    <div style="background-color:darkgreen; color:white;
    font-weight:bold; padding:10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-check-circle"></i> 
            
        </span>
        
        <span>Objetivos</span>
    </div>

    <h3 style="padding: 5px; font-weight:bold">Qué veremos aquí</h3>

    <hr style="border-color:seagreen; border-width:3px"/>
    
    <div style="background-color:#d0f0d0; color:darkgreen; padding: 10px;">
        <ul>
            
            <li>Instalar docker en ubuntu</li>
            
            <li>Instalar docker en windows</li>
            
            <li>Instalar docker con vagrant</li>
            
            
            
        </ul>
    </div>
    


</div>

<h3 id="referencias-para-instalar-ubuntu">Referencias para instalar ubuntu</h3>




<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Instalar Docker</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Páginas oficiales</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li>Instalar docker: Se ha de ir a la referencia de <strong>la página oficial de docker</strong> (<a href="https://docs.docker.com/install">https://docs.docker.com/install</a>)</li>
            
            <li>Instalar docker en <strong>ubuntu</strong>   (<a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">https://docs.docker.com/install/linux/docker-ce/ubuntu/</a>)</li>
            
            <li>Instalar docker en <strong>windows</strong> (<a href="https://docs.docker.com/docker-for-windows/install/">https://docs.docker.com/docker-for-windows/install/</a>)</li>
            
            <li>Instalar docker en <strong>mac</strong> (<a href="https://docs.docker.com/desktop/install/mac-install">https://docs.docker.com/desktop/install/mac-install</a>)</li>
            
            
            
        </ul>
    </div>
</div>

<h3 id="proceso-de-instalación-en-ubuntu">Proceso de instalación en Ubuntu</h3>
<ol>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Paquetes necesarios durante la instalación


</span>
</strong>
: usaremos certificados 
<strong>
<span class="font-weight-bold text-primary">

    (ca-certificates)


</span>
</strong>
. Descargamos con 
<strong>
<span class="font-weight-bold text-primary">

    curl


</span>
</strong>
, usaremos claves públicas y privadas 
<strong>
<span class="font-weight-bold text-primary">

    (gnupg-agent)


</span>
</strong>
 y conoceremos la versión de nuestro sistema 
<strong>
<span class="font-weight-bold text-primary">

    (lsb-release)


</span>
</strong>
, lo que nos permitirá hacer una instalación genérica.</li>
</ol>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>sudo apt-get install ca-certificates curl gnupg-agent lsb-release</span></span></code></pre></td></tr></table>
</div>
</div>
<ol start="2">
<li>
<strong>
<span class="font-weight-bold text-primary">

    Añadimos la clave GPG oficial de Docker


</span>
</strong>
</li>
</ol>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | <span style="color:#cd5555">\
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#cd5555"></span>sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span></span></code></pre></td></tr></table>
</div>
</div>
<ol start="3">
<li>
<p>Añadimos el repositorio 
<strong>
<span class="font-weight-bold text-primary">

    stable


</span>
</strong>
 (Proporciona últimas versiones). Otras opciones (modificar stable por la opción deseada):</p>
<ul>
<li>
<strong>
<span class="font-weight-bold text-primary">

    test


</span>
</strong>
: Versiones listas para probar.</li>
<li>
<strong>
<span class="font-weight-bold text-primary">

    nightly


</span>
</strong>
: Actualizaciones de la próxima versión.</li>
</ul>
</li>
</ol>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#658b00">echo</span> <span style="color:#cd5555">\
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#cd5555"></span><span style="color:#cd5555">&#34;deb [arch=</span><span style="color:#8b008b;font-weight:bold">$(</span>dpkg --print-architecture<span style="color:#8b008b;font-weight:bold">)</span><span style="color:#cd5555"> \
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#cd5555">signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] \
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#cd5555">https://download.docker.com/linux/ubuntu \
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#cd5555"></span><span style="color:#8b008b;font-weight:bold">$(</span>lsb_release -cs<span style="color:#8b008b;font-weight:bold">)</span><span style="color:#cd5555"> stable&#34;</span> | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</span></span></code></pre></td></tr></table>
</div>
</div>
<ol start="4">
<li>
<strong>
<span class="font-weight-bold text-primary">

    Actualizamos el índice de los paquetes apt e instalamos Docker


</span>
</strong>
: el cliente de Docker <em><strong>docker-ce-cli</strong></em>, el demonio de Docker <em><strong>docker-ce</strong></em> y el runtime de contenedores que gestiona su ejecución <em><strong>containerd.io</strong></em>. La construcción y administración de contenedores e imágenes la gestiona el demonio docker-ce.</li>
</ol>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt-get update
</span></span><span style="display:flex;"><span>sudo apt-get install docker-ce docker-ce-cli containerd.io</span></span></code></pre></td></tr></table>
</div>
</div>
<ol start="5">
<li>
<strong>
<span class="font-weight-bold text-primary">

    Agregamos el usuario actual al grupo de Docker


</span>
</strong>
 (para poder usar Docker sin sudo), de lo contrario, no podremos hacerlo:</li>
</ol>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>sudo usermod -aG docker <span style="color:#00688b">$USER</span></span></span></code></pre></td></tr></table>
</div>
</div>
<ol start="6">
<li>
<strong>
<span class="font-weight-bold text-primary">

    Cambiamos al grupo


</span>
</strong>
 de Docker en la sesión actual. Nota: para que el cambio aplique a otras sesiones, será necesario cerrar sesión o reiniciar.</li>
</ol>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>newgrp docker</span></span></code></pre></td></tr></table>
</div>
</div>
<ol start="7">
<li>
<strong>
<span class="font-weight-bold text-primary">

    Probamos la instalación


</span>
</strong>
 listando los comandos disponibles de Docker:</li>
</ol>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>docker help</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="instalación-de-docker-en-windows">Instalación de Docker en Windows</h3>
<ol>
<li>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Descargar Docker Desktop Installer


</span>
</strong>
: Para instalar Docker en Windows, descarga el fichero <strong>Docker Desktop Installer.exe</strong> y ejecútalo. También puedes usar el siguiente comando en la línea de comandos:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>Start-Process <span style="color:#cd5555">&#39;.\Docker Desktop Installer.exe&#39;</span> install</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Docker no se instala directamente sobre Windows. Necesita una capa de virtualización ya que Docker corre sobre Linux.</p>
</li>
<li>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Opciones de virtualización


</span>
</strong>
: Durante la instalación, elige entre <strong>Hyper-V</strong> o <strong>WSL</strong>.</p>
<ul>
<li>Si dockerizarás sistemas Windows, usa <strong>Hyper-V</strong>.</li>
<li>Para otros casos, se recomienda <strong>WSL</strong> por eficiencia. Ésta debe de ser la opción seleccionada en nuestro caso.</li>
</ul>
<p><a href="https://docs.docker.com/docker-for-windows/install/">Más información en la documentación oficial de Docker</a>.</p>
</li>
</ol>
<hr>
<h4 id="arrancar-el-servicio">Arrancar el Servicio</h4>
<ol>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Activar Docker Desktop


</span>
</strong>
: Tras la instalación, Windows no activa Docker automáticamente. Debes hacerlo manualmente:
<ul>
<li>Busca la aplicación Docker Desktop y ejecútala.</li>
<li>La primera vez, Docker te informará sobre el uso gratuito para pequeñas empresas.</li>
<li>Una vez abierta puedes configurarla para que se arranque automáticamente cada vez que arranque el sistema</li>
</ul>
</li>
</ol>
<hr>
<h3 id="crear-contenedores-de-windows">Crear contenedores de Windows</h3>
<ol>
<li>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Configuración para contenedores de Windows


</span>
</strong>
: Para crear contenedores de Windows, necesitas activarlos en el demonio.</p>
<ul>
<li>Ve al servicio Docker y abre el menú contextual.</li>
<li>Selecciona la opción <strong>switch to Windows containers…</strong>.</li>
</ul>
<blockquote>
<p>En este curso, no configuraremos contenedores de Windows.</p>
</blockquote>
</li>
</ol>
<hr>
<h3 id="interfaz-gráfica-en-windows">Interfaz Gráfica en Windows</h3>
<ol>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Uso de la interfaz gráfica


</span>
</strong>
: Docker Desktop en Windows proporciona una interfaz gráfica para gestionar contenedores, imágenes y configuraciones de manera visual.</li>
<li>En cualquier caso, recomendamos que abras un power shell en windows y realices las acciones en el terminal.</li>
</ol>
<hr>
<h3 id="configuración-de-docker-desktop">Configuración de Docker Desktop</h3>
<ol>
<li>
<strong>
<span class="font-weight-bold text-primary">

    Personalización de Docker Desktop


</span>
</strong>
: Docker Desktop permite ajustar configuraciones avanzadas para personalizar el rendimiento y los recursos asignados.</li>
</ol>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-be7312263a67ea65e5e20d152b9a270c">4 - Fichero de ejecución para crear imágenes DockerFile</h1>
    
	<p><div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-file-alt" aria-hidden="true"></i>
    
    <strong>Dockerfile</strong>
  </div>
  <div class="definicion-contenido">
    
Un 
<strong>
<span class="font-weight-bold text-primary">

    Dockerfile


</span>
</strong>
 es un fichero de texto que contiene una serie de instrucciones para crear una 
<strong>
<span class="font-weight-bold text-primary">

    imagen


</span>
</strong>
. 
<br />
Este fichero tiene un formato concreto y necesita al menos la instrucción 
<strong>
<span class="font-weight-bold text-primary">

    FROM


</span>
</strong>
 para especificar la imagen base a partir de la cual construiremos nuestra imagen personalizada.

  </div>
</div>


<div class="alert alert-success" role="alert">
<h4 class="alert-heading">Para qué</h4>

    <blockquote>
<ul>
<li>
<p>La idea es que partiendo de una imagen  personalicemos la imagen quequeremos crear,</p>
</li>
<li>
<p>Después, a partir de esta imagen, levantaremos el contenedor)</p>
</li>
</ul>
</blockquote>


</div>
</p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="construcción-del-dockerfile">Construcción del Dockerfile</h2>
<p><img src="/despliegue/docker/docs/06_dockefile/img_1.png" alt="img_1.png">
Para ejecutar las instrucciones del Dockerfile, utilizamos el comando 
<strong>
<span class="font-weight-bold text-primary">

    docker build


</span>
</strong>
:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker build [OPTIONS] PATH | URL | -</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Podemos usar la opción 
<strong>
<span class="font-weight-bold text-primary">

    PATH


</span>
</strong>
 para especificar la ubicación del Dockerfile.</p>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Si el fichero tiene otro nombre


</span>
</strong>
, lo indicamos con la opción 
<strong>
<span class="font-weight-bold text-primary">

    -f


</span>
</strong>
.</p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="instrucciones-principales">Instrucciones principales</h2>
<ul>
<li><strong>FROM</strong>: Establece la imagen base.</li>
<li><strong>RUN</strong>: Ejecuta comandos durante la construcción de la imagen.</li>
<li><strong>CMD</strong>: Especifica el comando predeterminado para el contenedor.</li>
<li><strong>LABEL</strong>: Añade metadatos a la imagen.</li>
<li><strong>EXPOSE</strong>: Define los puertos que se abrirán.</li>
<li><strong>ENV</strong>: Establece variables de entorno.</li>
<li><strong>COPY</strong> y <strong>ADD</strong>: Copian archivos al contenedor.</li>
<li><strong>WORKDIR</strong>: Define el directorio de trabajo.</li>
<li><strong>VOLUME</strong>: Crea un punto de montaje persistente.</li>
<li><strong>ENTRYPOINT</strong>: Establece el comando principal del contenedor.</li>
<li><strong>ARG</strong>: Declara argumentos para la construcción.</li>
</ul>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="ejemplo-imagen-base-from">Ejemplo: Imagen base (<code>FROM</code>)</h2>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p>Esta instrucción es obligatoria y debe ser la primera, salvo comentarios o 
<strong>
<span class="font-weight-bold text-primary">

    ARG


</span>
</strong>
.</p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="ejemplo-ejecución-de-comandos-run">Ejemplo: Ejecución de comandos (<code>RUN</code>)</h2>
<h3 id="instalación-de-paquetes">Instalación de paquetes</h3>
<h3 id="instalación-de-paquetes-1">Instalación de paquetes</h3>
<blockquote>
<p><em>Lo primero que debemos hacer es ejecutar 
<strong>
<span class="font-weight-bold text-primary">

    apt-get update


</span>
</strong>
, lo que actualiza las cabeceras de los repositorios para garantizar que los paquetes disponibles estén actualizados.</em><br>
<em>Observa que se utiliza la opción 
<strong>
<span class="font-weight-bold text-primary">

    -y


</span>
</strong>
 para confirmar automáticamente las instalaciones, evitando la necesidad de interacción manual, 
<strong>
<span class="font-weight-bold text-primary">

    algo que no está permitido durante la construcción del contenedor


</span>
</strong>
.</em></p>
</blockquote>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">RUN</span> apt-get update &amp;&amp; apt-get install -y apache2<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> apt-get install -y php git zip</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="ejecución-de-scripts">Ejecución de scripts</h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">RUN</span> bash script.sh</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Cada instrucción 
<strong>
<span class="font-weight-bold text-primary">

    RUN


</span>
</strong>
 genera una capa.</p>
<p>Modificar una capa afecta a las siguientes, por lo que conviene agrupar comandos para optimizar.</p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="declaración-de-variables-env-y-arg">Declaración de variables: <code>ENV</code> y <code>ARG</code></h2>
<h3 id="env">ENV</h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">ENV</span> <span style="color:#00688b">USER</span>=developer
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">RUN</span> <span style="color:#658b00">echo</span> <span style="color:#cd5555">&#34;Usuario actual: </span><span style="color:#00688b">$USER</span><span style="color:#cd5555">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="arg">ARG</h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">ARG</span> <span style="color:#00688b">VERSION</span>=latest
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:$VERSION</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> <span style="color:#658b00">echo</span> <span style="color:#cd5555">&#34;Versión base: </span><span style="color:#00688b">$VERSION</span><span style="color:#cd5555">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p>Construcción con argumentos personalizados:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker build --build-arg <span style="color:#00688b">VERSION</span>=20.04 -t mi_imagen .</span></span></code></pre></td></tr></table>
</div>
</div>
<h2 id="ejemplo-personalización-con-run">Ejemplo: Personalización con <code>RUN</code></h2>
<p>Podemos ejecutar comandos de administración, instalación y scripts predefinidos:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">RUN</span> mkdir -p /var/www/app &amp;&amp; chown -R www-data:www-data /var/www/app<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> apt-get update &amp;&amp; apt-get install -y composer<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> composer install --no-scripts --no-autoloader</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="práctica-sugerida-crear-un-dockerfile">Práctica sugerida: Crear un Dockerfile</h2>
<ol>
<li>Partir de la imagen base <code>ubuntu:latest</code>.</li>
<li>Instalar los paquetes necesarios:
<ul>
<li><code>apache2</code></li>
<li><code>vim</code></li>
<li><code>git</code></li>
<li><code>zip</code></li>
</ul>
</li>
</ol>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> apt-get update &amp;&amp; apt-get install -y apache2 vim git zip</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="declaración-de-variables-env-vs-arg">Declaración de variables: <code>ENV</code> vs <code>ARG</code></h2>
<p><img src="/despliegue/docker/docs/06_dockefile/img_2.png" alt="img_2.png">
Diferencias clave:</p>
<ul>
<li><strong><code>ENV</code></strong>: Define variables accesibles dentro del contenedor en tiempo de ejecución.</li>
<li><strong><code>ARG</code></strong>: Define argumentos disponibles solo durante la construcción de la imagen.</li>
</ul>
<h3 id="ejemplo-de-uso-arg">Ejemplo de uso: <code>ARG</code></h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">ARG</span> <span style="color:#00688b">VERSION</span>=latest
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:$VERSION</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> <span style="color:#658b00">echo</span> <span style="color:#00688b">$VERSION</span> &gt; version.txt</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Construcción personalizada:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker build --build-arg <span style="color:#00688b">VERSION</span>=18.10 -t web:v1 .</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="ejemplo-de-uso-env">Ejemplo de uso: <code>ENV</code></h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">ENV</span> <span style="color:#00688b">USER</span>=manuel
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">RUN</span> <span style="color:#658b00">echo</span> <span style="color:#cd5555">&#34;Usuario configurado: </span><span style="color:#00688b">$USER</span><span style="color:#cd5555">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="solución-de-problemas-instalación-de-php">Solución de problemas: Instalación de PHP</h2>
<h3 id="problema">Problema</h3>
<p>Al instalar PHP, puede requerirse configurar la zona horaria (<code>tzone</code>), lo que interrumpe la construcción al no poder interactuar con el contenedor.
<img src="/despliegue/docker/docs/06_dockefile/img_3.png" alt="img_3.png"></p>
<h3 id="solución">Solución</h3>
<p>Configurar el entorno en modo no interactivo:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">ARG</span> <span style="color:#00688b">DEBIAN_FRONTEND</span>=noninteractive
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">RUN</span> apt-get update &amp;&amp; apt-get install -y php libapache2-mod-php</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Configurar la zona horaria:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">RUN</span> ln -snf /usr/share/zoneinfo/Europe/Madrid /etc/localtime &amp;&amp; <span style="color:#cd5555">\
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"></span><span style="color:#658b00">echo</span> <span style="color:#cd5555">&#34;Europe/Madrid&#34;</span> &gt; /etc/timezone</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="etiquetas-label">Etiquetas (<code>LABEL</code>)</h2>
<p>Podemos agregar metadatos útiles a la imagen:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">LABEL</span> <span style="color:#00688b">maintainer</span>=<span style="color:#cd5555">&#34;example@example.com&#34;</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">LABEL</span> <span style="color:#00688b">version</span>=<span style="color:#cd5555">&#34;1.0&#34;</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">LABEL</span> <span style="color:#00688b">description</span>=<span style="color:#cd5555">&#34;Imagen personalizada para aplicaciones web&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p>Ver etiquetas en el contenedor:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker inspect --format <span style="color:#cd5555">&#39;{{.Config.Labels}}&#39;</span> container_name</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="gestión-de-archivos-copy-y-add">Gestión de archivos: <code>COPY</code> y <code>ADD</code></h2>
<h3 id="ejemplo-crear-usuarios-desde-un-script">Ejemplo: Crear usuarios desde un script</h3>
<p>Archivos necesarios:</p>
<ol>
<li>
<p><code>usuarios.txt</code>:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>maria
</span></span><span style="display:flex;"><span>nives
</span></span><span style="display:flex;"><span>luis
</span></span><span style="display:flex;"><span>lourdes
</span></span><span style="display:flex;"><span>manuel</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p><code>crea_usuarios.sh</code>:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">while</span> <span style="color:#00688b">IFS</span>= <span style="color:#658b00">read</span> -r line
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>useradd -m <span style="color:#00688b">$line</span> -p <span style="color:#00688b">$line</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">done</span> &lt; usuarios.txt</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
</ol>
<p>Dockerfile:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">COPY</span> crea_usuarios.sh /<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">ADD</span> usuarios.txt /<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> bash crea_usuarios.sh</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="comandos-cmd-y-entrypoint">Comandos: <code>CMD</code> y <code>ENTRYPOINT</code></h2>
<h3 id="cmd"><code>CMD</code></h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">CMD</span> [<span style="color:#cd5555">&#34;echo&#34;</span>, <span style="color:#cd5555">&#34;Hola desde Docker&#34;</span>]</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="entrypoint"><code>ENTRYPOINT</code></h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">ENTRYPOINT</span> [<span style="color:#cd5555">&#34;apachectl&#34;</span>, <span style="color:#cd5555">&#34;-D&#34;</span>, <span style="color:#cd5555">&#34;FOREGROUND&#34;</span>]</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Ambos comandos definen lo que ejecutará el contenedor al iniciarse.</p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="volúmenes-volume">Volúmenes (<code>VOLUME</code>)</h2>
<p>Definir un volumen para persistencia de datos:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">VOLUME</span> [<span style="color:#cd5555">&#34;/data&#34;</span>]</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Uso con variables de entorno:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">ENV</span> <span style="color:#00688b">WEB_DIR</span>=/var/www/html<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">VOLUME</span><span style="color:#cd5555"> $WEB_DIR</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="directorio-de-trabajo-workdir">Directorio de trabajo (<code>WORKDIR</code>)</h2>
<p>Definir el directorio predeterminado:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">WORKDIR</span><span style="color:#cd5555"> /var/www/html</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">COPY</span> script.sh /<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">ENTRYPOINT</span> bash script.sh</span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="exponer-puertos-expose">Exponer puertos (<code>EXPOSE</code>)</h2>
<p>Definir puertos expuestos por el contenedor:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> ubuntu:latest</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">ENV</span> <span style="color:#00688b">WEB_PORT</span>=<span style="color:#b452cd">80</span> <span style="color:#00688b">MYSQL_PORT</span>=<span style="color:#b452cd">3306</span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">EXPOSE</span><span style="color:#cd5555"> $WEB_PORT $MYSQL_PORT</span></span></span></code></pre></td></tr></table>
</div>
</div>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="conclusión">Conclusión</h2>


<div class="alert alert-green" role="alert">
<h4 class="alert-heading">Resumen</h4>

    <ul>
<li>Sabemos crear imágenes personalizadas con Dockerfile.</li>
<li>Sabemos usar instrucciones clave como <code>RUN</code>, <code>CMD</code>, <code>ENTRYPOINT</code> y más.</li>
<li>Aprendimos a gestionar volúmenes y persistencia de datos.</li>
<li>Configuramos variables de entorno y puertos expuestos.</li>
<li>Sabemos subir y gestionar imágenes en Docker Hub.</li>
</ul>


</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-119983b132b25e85c20958c2f3b25dcd">5 - Docker compose</h1>
    
	<p>Si quiero desarrollar una aplicación web,  puedo necesitar tener en el sistema:</p>
<blockquote>
<ul>
<li>Un servidor web: p.e  apache</li>
<li>Un intérprete de código: p.e  php</li>
<li>Un servidor de bases de datos: p.e mysql
<ul>
<li>Una herramienta para gestionar: p.e phpmyadmin</li>
</ul>
</li>
</ul>
</blockquote>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 410px">
<img class="card-img-top" src="/despliegue/docker/docs/07_docker-compose/ejemplo1_hu3089509083010952372.png" width="400" height="450">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

<p>Ante esta situación qué hacemos</p>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 410px">
<img class="card-img-top" src="/despliegue/docker/docs/07_docker-compose/pensando_hu899626355106468084.png" width="400" height="450">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


* Podría tener un contenedor con todos los servicios.
 <br />
* Pero vaya lío tener todo en un contenedor
 <br />
* ¿Podría tener un contenedor con cada servicio?

</p>
</figcaption>
</figure>


<strong>
<span class="font-weight-bold text-primary">

    Qué me va a permtir docker compose


</span>
</strong>

<blockquote>
<ul>
<li>Docker compose me va a permitir especificar en un fichero los servicios que necesito</li>
<li>Va a crear un contenedor por cada servicio</li>
<li>Va a crear una red interna para que dichos servicios se vean entre sí</li>
<li>Me va a permitir, mediante comandos poder gestionar todos los servicios de manera individual</li>
<li>Todo centralizado en un comando de docker : compose.</li>
<li>Evitamos tener que tener varios ficheros Dockerfile y gestionarlos uno por uno para que se ejecuten .</li>
<li>La ejecución de docker-compose va a generar contenedores con servicios.</li>
</ul>
</blockquote>
<h3 id="fichero-de-configuración">Fichero de configuración</h3>
<ul>
<li>
<p>Es un fichero llamado 
<strong>
<span class="font-weight-bold text-primary">

    docker-compose.yaml  o (docker-compose.yml)


</span>
</strong>
</p>
<ul>
<li>
<strong>
<span class="font-weight-bold text-primary">

    yaml


</span>
</strong>
 o 
<strong>
<span class="font-weight-bold text-primary">

    yml


</span>
</strong>
 es un tipo de 
<strong>
<span class="font-weight-bold text-primary">

    fichero de declarativo


</span>
</strong>
, cuya  configuracioń y sintaxis es muy sencilla.
yaml viene de YAML Ain’t Markdown Language (Yaml no es un lenguaje de marcado) especificando que no es como XML o HTML:</li>
</ul>
<blockquote>
<p>*
<strong>
<span class="font-weight-bold text-primary">

    Tiene en cuenta la indentación creando bloques


</span>
</strong>
.
*Asigno valores a variables utilizando : (dos puntos), debiendo de haber una separación entre los dos puntos y el valor</p>
<ul>
<li>Para crear listas usa los guiones</li>
</ul>
</blockquote>
<p>Es un fichero muy fácil de entender</p>
</li>
</ul>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Creando el fichero


</span>
</strong>

1.- Vamos a ver la construcción del fichero 
<strong>
<span class="font-weight-bold text-primary">

    docker-compose.yaml


</span>
</strong>
. <br>
2.- Posteriormente veremos cómo 
<strong>
<span class="font-weight-bold text-primary">

    ejecutar el fichero


</span>
</strong>
 y construir nuestro 
<strong>
<span class="font-weight-bold text-primary">

    entorno de desarrollo


</span>
</strong>
.</p>
<h3 id="sintaxis-del-fichero">Sintaxis del fichero</h3>
<p>El fichero docker-compose va a tener opciones de configuración que podemos jerarquizar</p>
<p>Es un fichero de configuración con formato yaml
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 410px">
<img class="card-img-top" src="/despliegue/docker/docs/07_docker-compose/config1_hu4873949124926257436.png" width="400" height="450">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 410px">
<img class="card-img-top" src="/despliegue/docker/docs/07_docker-compose/config2_hu18173720500454314908.png" width="400" height="450">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">




</p>
</figcaption>
</figure>

Sintaxis YAML (<a href="https://es.wikipedia.org/wiki/YAML%29">https://es.wikipedia.org/wiki/YAML)</a>:
La indentación establece la agrupación.
Si queremos establecer una lista, usamos guiones
Hay que dejar un espacio entre los dos puntos y el valor.</p>
<h1 id="tema-3-docker-compose">Tema 3: Docker Compose</h1>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Docker Compose


</span>
</strong>
 es una herramienta que permite definir y ejecutar aplicaciones multicontenedor con un archivo de configuración llamado <code>docker-compose.yml</code>.</p>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="introducción-a-docker-compose">Introducción a Docker Compose</h2>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="docker" aria-hidden="true"></i>
    
    <strong>Docker Compose</strong>
  </div>
  <div class="definicion-contenido">
    
Docker Compose es una herramienta que nos permite gestionar sistemas dockerizados, facilitando la configuración y ejecución de aplicaciones multicontenedor de forma sencilla y ordenada, utilizando un único archivo YAML.

  </div>
</div>
<hr>
<h2 id="beneficios-de-docker-compose">Beneficios de Docker Compose</h2>


<div class="alert alert-green" role="alert">
<h4 class="alert-heading">Ventajas de Docker Compose</h4>

    <ul>
<li>Facilita la creación y gestión de entornos complejos.</li>
<li>Centraliza la configuración de varios contenedores en un único archivo.</li>
<li>Automatiza la creación de redes internas para la comunicación entre servicios.</li>
<li>Simplifica la administración de contenedores relacionados.</li>
</ul>


</div>

<hr style="border-color: red; border-width: 3px;"/>
<h2 id="cómo-funciona-docker-compose">¿Cómo funciona Docker Compose?</h2>
<p>Docker Compose utiliza un archivo <code>docker-compose.yml</code> para definir servicios, redes y volúmenes necesarios para una aplicación.</p>

<strong>
<span class="font-weight-bold text-primary">

    Estructura básica de un archivo docker-compose.yml


</span>
</strong>

<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span>services:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    web:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        image: nginx:latest<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        ports:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>            - <span style="color:#cd5555">&#34;8080:80&#34;</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    db:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        image: mysql:5.7<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        environment:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>            - MYSQL_ROOT_PASSWORD: example<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>            - MYSQL_DATABASE: test<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></div><hr>
<h2 id="sintaxis-del-archivo-yaml">Sintaxis del archivo YAML</h2>
<p>El archivo <code>docker-compose.yml</code> utiliza la sintaxis YAML, la cual es declarativa y fácil de entender.</p>


<div class="alert alert-blue" role="alert">
<h4 class="alert-heading">Características de YAML</h4>

    <ul>
<li>La indentación establece la agrupación.</li>
<li>Se usan dos puntos <code>:</code> para asignar valores a variables.</li>
<li>Para crear listas, se emplean guiones <code>-</code>.</li>
</ul>


</div>

<p>Ejemplo de sintaxis básica en YAML:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#d6d6c6"><span>services:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    web:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        image: nginx:latest<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        ports:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>            - <span style="color:#cd5555">&#34;8080:80&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr>
<h2 id="opciones-principales-del-archivo-docker-composeyml">Opciones principales del archivo docker-compose.yml</h2>
<ol>
<li><strong>services</strong>: Define los contenedores que forman parte de la aplicación.</li>
<li><strong>volumes</strong>: Especifica volúmenes para persistir datos.</li>
<li><strong>networks</strong>: Configura redes internas para los servicios.</li>
</ol>
<hr style="border-color: red; border-width: 3px;"/>
<h2 id="ejemplo-práctico-servidor-web-y-base-de-datos">Ejemplo práctico: Servidor web y base de datos</h2>
<p>Creamos una configuración para un servidor web con Nginx y una base de datos MySQL.</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span>services:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>web:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    image: php:8.3-apache<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    ports:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        - <span style="color:#cd5555">&#34;8080:80&#34;</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    <span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span>    db:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        image: mysql<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>        environment:<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>            - MYSQL_ROOT_PASSWORD: root<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>            - MYSQL_DATABASE: ejemplo<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>            - MYSQL_USER: usuario<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span>            - MYSQL_PASSWORD: contraseña</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Ejecución:</p>
<ol>
<li>
<p>Levantar los servicios:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span>docker compose up -d</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p>Verificar contenedores activos:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span>docker compose ps</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
<li>
<p>Detener los servicios:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span>docker compose down</span></span></code></pre></td></tr></table>
</div>
</div></p>
</li>
</ol>
<hr>
<h2 id="referencias">Referencias</h2>




<div style="border: 1px solid navy; border-radius: 5px; overflow: hidden;">
    <div style="background-color: navy; color: white;
    font-weight: bold; padding: 10px; display: flex; align-items: center;">
        
        <span style="margin-right: 8px;">
            
                <i class="fas fa-book"></i> 
            
        </span>
        
        <span>Documentación oficial</span>
    </div>

    <h3 style="padding: 5px; font-weight: bold; color: navy;">Fuentes de Información</h3>

    <hr style="border-color: lightblue; border-width: 3px"/>
    
    <div style="background-color: #e0f7fa; color: navy; padding: 10px;">
        <ul>
            
            <li><ul>
<li><a href="https://docs.docker.com/compose/">Docker Compose Overview</a></li>
</ul>
</li>
            
            <li><ul>
<li><a href="https://docs.docker.com/compose/compose-file/">Compose File Reference</a></li>
</ul>
</li>
            
            <li></li>
            
            
        </ul>
    </div>
</div>


</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-db70193927a58cc58192654a75aef445">6 - Proxy inverso o Reverse prxy</h1>
    
	<h2 id="proxy-y-proxy-inverso">Proxy y Proxy Inverso</h2>
<h3 id="1-proxy">1. Proxy</h3>
<div class="definicion-concepto">
  <div class="definicion-titulo">
    
    <i class="fas fa-network-wired" aria-hidden="true"></i>
    
    <strong>Qué es un proxy</strong>
  </div>
  <div class="definicion-contenido">
    
Un 
<strong>
<span class="font-weight-bold text-primary">

    proxy


</span>
</strong>
 es un servidor intermedio que actúa como 
<strong>
<span class="font-weight-bold text-primary">

    puente


</span>
</strong>
 entre 
<strong>
<span class="font-weight-bold text-primary">

    un cliente y un servidor


</span>
</strong>
.

  </div>
</div>
<p>Cuando un cliente solicita acceder a un recurso en Internet, el proxy redirige esa solicitud al servidor, recibe la respuesta y se la devuelve al cliente.</p>
<p><strong>Función principal</strong>:</p>
<ul>
<li>Ocultar la identidad del cliente (anonimato).</li>
<li>Filtrar contenido, controlar accesos o mejorar el rendimiento mediante caché.</li>
</ul>
<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/proxy_hu342787633500672969.png" width="700" height="529">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


Imagen obtenida de https://www.redeszone.net/tutoriales/servidores/diferencias-proxy-vs-proxy-inverso/

</p>
</figcaption>
</figure>

<p>En la imagen podemos ver el ejemplo:</p>
<blockquote>
<ul>
<li>Un usuario quiere acceder a una página web.</li>
<li>Su solicitud pasa primero por un servidor proxy que redirige la conexión, de modo que el servidor web no ve directamente al cliente, sino al proxy.</li>
</ul>
</blockquote>
<hr>
<h4 id="2-proxy-inverso-reverse-proxy">2. Proxy Inverso (reverse proxy)</h4>
<p>Un 
<strong>
<span class="font-weight-bold text-primary">

    proxy inverso


</span>
</strong>
 (también llamado <strong>reverse proxy</strong>) es un servidor que se sitúa frente a uno o más servidores y gestiona las solicitudes de los clientes antes de enviarlas a los servidores finales.
De alguna forma la diferencia es que colocamos el servidor proxy después de internet, y no antes (<em>proxy directo</em>)</p>
<hr style="border-color: red; border-width: 3px;"/>
<p>
<strong>
<span class="font-weight-bold text-primary">

    Proxy directo


</span>
</strong>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/proxy_directo_hu16039520143035292699.png" width="700" height="297">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


https://www.cloudflare.com/es-es/learning/cdn/glossary/reverse-proxy/

</p>
</figcaption>
</figure>


<strong>
<span class="font-weight-bold text-primary">

    Proxy reverse


</span>
</strong>

<figure class="card rounded p-2 td-post-card mb-4 mt-4" style="max-width: 710px">
<img class="card-img-top" src="/despliegue/docker/docs/10_reverse_proxy/proxy_reverse_hu4033920156410999965.webp" width="700" height="297">
<figcaption class="card-body px-0 pt-2 pb-0">
<p class="card-text">


https://www.cloudflare.com/es-es/learning/cdn/glossary/reverse-proxy/

</p>
</figcaption>
</figure>
</p>
<hr style="border-color: red; border-width: 3px;"/>
<p><strong>Función principal</strong>:</p>
<ul>
<li>Actuar como intermediario entre los clientes y los servidores internos, con objetivos como:
<ul>
<li>Distribuir la carga entre varios servidores (balanceo de carga).</li>
<li>Mejorar la seguridad ocultando los servidores reales.</li>
<li>Servir contenido en caché para acelerar la entrega.</li>
<li>Gestionar múltiples subdominios o servicios desde un único punto de entrada.</li>
</ul>
</li>
</ul>
<p><strong>Ejemplo</strong>:<br>
Cuando accedes a <code>www.miweb.com</code>, el proxy inverso determina si tu solicitud debe ser atendida por un servidor web, un servidor de imágenes, o un servicio API, redirigiéndola al servidor correspondiente.</p>
<hr>
<p>
<strong>
<span class="font-weight-bold text-primary">

    ¿Por qué se llama &ldquo;proxy inverso&rdquo;?


</span>
</strong>

El término &ldquo;inverso&rdquo; refleja que el proxy inverso actúa del lado del servidor (recibiendo solicitudes de los clientes) en lugar del lado del cliente (como un proxy convencional). Mientras el proxy normal protege al cliente, el proxy inverso protege y organiza a los servidores.</p>
<hr>
<h3 id="práctica-crear-un-proxy-reverse">Práctica: crear un proxy reverse</h3>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Práctica</h4>

    Vamos a practicar con docker para crer un servidor inverso que nos permita atender varias solicitudes

</div>

<h3 id="configuración-de-proxy-inverso-con-docker">Configuración de Proxy Inverso con Docker</h3>
<h4 id="1-preparar-el-entorno">1. Preparar el entorno</h4>
<p>Editar el archivo <code>hosts</code> en tu máquina local:</p>
<p>Agrega las siguientes líneas para simular los dominios:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>127.0.0.1 dwes.com
</span></span><span style="display:flex; background-color:#d6d6c6"><span>127.0.0.1 alumno1.dwes.com
</span></span><span style="display:flex; background-color:#d6d6c6"><span>127.0.0.1 alumno2.dwes.com
</span></span><span style="display:flex;"><span>127.0.0.1 alumno3.dwes.com
</span></span><span style="display:flex;"><span>127.0.0.1 alumno4.dwes.com
</span></span><span style="display:flex;"><span>127.0.0.1 alumno5.dwes.com</span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>Esto permite que los subdominios apunten a tu máquina local.
En un caso real, necesitaríamos que a través del dns, estos dominios apunten a la máquina donde está nuestro proxy</p>
<p>Ahora crearemos un docker-compose con los siguientes servicios</p>
<hr>
<h2 id="2-crear-los-contenedores-para-los-alumnos">2. Crear los contenedores para los alumnos</h2>
<p>Cada alumno tendrá un contenedor Docker con 
<strong>
<span class="font-weight-bold text-primary">

    Apache


</span>
</strong>
 y 
<strong>
<span class="font-weight-bold text-primary">

    PHP


</span>
</strong>
 instalados:</p>
<h3 id="crear-el-dockerfile-para-apache-y-php">Crear el Dockerfile para Apache y PHP:</h3>
<p>En una carpeta, crea un archivo <code>Dockerfile</code> con este contenido:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> php:8.3-apache</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">COPY</span> ./public_html/ /var/www/html/<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">EXPOSE</span><span style="color:#cd5555"> 80</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>Crea la carpeta <code>public_html/</code> con un archivo <code>index.php</code> simple para probar:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#8b008b;font-weight:bold">echo</span> <span style="color:#cd5555">&#34;Bienvenido al servidor de alumno1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#1e889b">?&gt;</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></td></tr></table>
</div>
</div></p>
<h3 id="construir-las-imágenes-para-cada-alumno">Construir las imágenes para cada alumno:</h3>
<p>Copia la carpeta del proyecto para cada alumno (<code>alumno1/</code>, <code>alumno2/</code>) y personaliza los contenidos.
En cada carpeta, ejecuta:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>docker build -t alumno1-apache .
</span></span><span style="display:flex;"><span>docker build -t alumno2-apache .</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h3 id="levantar-los-contenedores">Levantar los contenedores:</h3>
<p>Ejecuta:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>docker run -d --name alumno1 -p 8081:80 alumno1-apache
</span></span><span style="display:flex; background-color:#d6d6c6"><span>docker run -d --name alumno2 -p 8082:80 alumno2-apache</span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr>
<h2 id="3-configurar-el-proxy-inverso-con-nginx">3. Configurar el proxy inverso con Nginx</h2>
<h3 id="crear-un-archivo-de-configuración-para-nginx">Crear un archivo de configuración para Nginx:</h3>
<p>En una carpeta <code>nginx-proxy</code>, crea un archivo <code>nginx.conf</code>:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">events</span> {}
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">http</span> {
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">server</span> {
</span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#8b008b;font-weight:bold">listen</span> <span style="color:#b452cd">80</span>;
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">server_name</span> <span style="color:#cd5555">alumno1.dwes.com</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">location</span> <span style="color:#cd5555">/</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">proxy_pass</span> <span style="color:#cd5555">http://alumno1:80</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">proxy_set_header</span> <span style="color:#cd5555">Host</span> <span style="color:#00688b">$host</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">proxy_set_header</span> <span style="color:#cd5555">X-Real-IP</span> <span style="color:#00688b">$remote_addr</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex; background-color:#d6d6c6"><span>    <span style="color:#8b008b;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">listen</span> <span style="color:#b452cd">80</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">server_name</span> <span style="color:#cd5555">alumno2.dwes.com</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8b008b;font-weight:bold">location</span> <span style="color:#cd5555">/</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">proxy_pass</span> <span style="color:#cd5555">http://alumno2:80</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">proxy_set_header</span> <span style="color:#cd5555">Host</span> <span style="color:#00688b">$host</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#8b008b;font-weight:bold">proxy_set_header</span> <span style="color:#cd5555">X-Real-IP</span> <span style="color:#00688b">$remote_addr</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></td></tr></table>
</div>
</div></p>
<h3 id="levantar-el-contenedor-de-nginx-como-proxy-inverso">Levantar el contenedor de Nginx como proxy inverso:</h3>
<p>Usa el siguiente comando para ejecutar el proxy inverso:
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>docker run -d --name nginx-proxy <span style="color:#cd5555">\
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"></span>--network bridge <span style="color:#cd5555">\
</span></span></span><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#cd5555"></span>-v <span style="color:#8b008b;font-weight:bold">$(</span><span style="color:#658b00">pwd</span><span style="color:#8b008b;font-weight:bold">)</span>/nginx.conf:/etc/nginx/nginx.conf:ro <span style="color:#cd5555">\
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"></span>-p 80:80 nginx</span></span></code></pre></td></tr></table>
</div>
</div></p>
<hr>
<h2 id="4-configurar-una-red-común-en-docker">4. Configurar una red común en Docker</h2>
<h3 id="crear-una-red-personalizada-para-los-contenedores">Crear una red personalizada para los contenedores:</h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>docker network create dwes-network</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 id="conectar-los-contenedores-a-esta-red">Conectar los contenedores a esta red:</h3>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-bash" data-lang="bash"><span style="display:flex; background-color:#d6d6c6"><span>docker network connect dwes-network alumno1
</span></span><span style="display:flex;"><span>docker network connect dwes-network alumno2
</span></span><span style="display:flex; background-color:#d6d6c6"><span>docker network connect dwes-network nginx-proxy</span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h2 id="5-probar-la-configuración">5. Probar la configuración</h2>
<p>Abre en el navegador:</p>
<ul>
<li>
<strong>
<span class="font-weight-bold text-primary">

    <a href="http://alumno1.dwes.com">http://alumno1.dwes.com</a>


</span>
</strong>
</li>
<li>
<strong>
<span class="font-weight-bold text-primary">

    <a href="http://alumno2.dwes.com">http://alumno2.dwes.com</a>


</span>
</strong>
</li>
</ul>
<p>Deberías ver el contenido de cada contenedor.</p>
<hr>
<h2 id="6-aspecto-importantes">6. Aspecto importantes</h2>
<ul>
<li>Resalta las diferencias entre usar 
<strong>
<span class="font-weight-bold text-primary">

    Nginx


</span>
</strong>
 y 
<strong>
<span class="font-weight-bold text-primary">

    Apache


</span>
</strong>
 como proxy inverso.</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Correo del usuario" aria-label="Correo del usuario">
    <a target="_blank" rel="noopener" href="https://example.org/mail" aria-label="Correo del usuario">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/MAlejandroR" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2024
    <span class="td-footer__authors">@MRomero</span></span><span class="td-footer__all_rights_reserved">Derechos reservados</span><span class="ms-2"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Política de privacidad</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/despliegue/docker/js/main.js"></script>
<script defer src="/despliegue/docker/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/despliegue/docker/js/tabpane-persist.js'></script>

  </body>
</html>
